<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>DSP é¡¹ç›®1 - åŸºäºDCTçš„éŸ³é¢‘å‹ç¼©ä»£ç æ¨¡æ¿</title>
    <style>
        body { font-family: 'Segoe UI', Consolas, 'Microsoft YaHei', sans-serif; background: #f4f7f6; padding: 20px; color: #333; }
        .container { max-width: 1200px; margin: 0 auto; }
        
        .control-panel {
            position: sticky; top: 0; z-index: 100;
            background: white; padding: 15px; margin-bottom: 20px;
            border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            display: flex; justify-content: space-between; align-items: center;
        }
        .control-btn {
            background: #667eea; color: white; border: none; padding: 8px 16px;
            border-radius: 4px; cursor: pointer; font-weight: bold; margin-left: 10px;
        }
        .control-btn:hover { background: #5a67d8; }
        .control-btn.secondary { background: #6c757d; }

        .file-block { background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); margin-bottom: 20px; overflow: hidden; }
        
        .file-header { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; padding: 15px 20px; 
            display: flex; justify-content: space-between; align-items: center; 
            cursor: pointer; user-select: none;
        }
        .file-header:hover { opacity: 0.9; }
        
        .file-title { font-weight: bold; display: flex; align-items: center; }
        .arrow-icon { display: inline-block; margin-right: 10px; transition: transform 0.3s; }
        .file-block.collapsed .arrow-icon { transform: rotate(-90deg); }
        
        .file-content { display: block; }
        .file-block.collapsed .file-content { display: none; }

        .copy-btn { background: #48bb78; border: none; color: white; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 0.9em; }
        .copy-btn:hover { background: #38a169; }

        pre { margin: 0; padding: 20px; overflow-x: auto; line-height: 1.8; font-size: 13px; background: #f8f9fa; border-top: 1px solid #e9ecef; }
        
        /* ä»£ç é«˜äº®æ ·å¼ */
        .keyword { color: #0000ff; font-weight: bold; }
        .comment { color: #228b22; font-style: italic; }
        .string { color: #a020f0; }
        .number { color: #ff0000; }
        .todo { background: #fff3cd; color: #856404; padding: 2px 6px; border-radius: 3px; border: 1px solid #ffeeba; font-weight: bold; }
        
        /* Banneræ ·å¼ */
        .info-banner { background: linear-gradient(135deg, #e7f3ff 0%, #f0f7ff 100%); border-left: 4px solid #667eea; padding: 15px; margin-bottom: 20px; border-radius: 4px; }
        .warning-banner { background: linear-gradient(135deg, #fff3cd 0%, #fffdf7 100%); border-left: 4px solid #ed8936; padding: 15px; margin-bottom: 20px; border-radius: 4px; }
        .success-banner { background: linear-gradient(135deg, #f0fff4 0%, #f7fafc 100%); border-left: 4px solid #48bb78; padding: 15px; margin-bottom: 20px; border-radius: 4px; }

        code { background: #edf2f7; padding: 2px 6px; border-radius: 3px; color: #667eea; font-size: 0.95em; }
    </style>
</head>
<body>
    <div class="container">
        <div class="control-panel">
            <h2 style="margin:0; color:#667eea;">ğŸ“ DSP é¡¹ç›®1 - åŸºäºDCTçš„éŸ³é¢‘å‹ç¼©å®éªŒä»£ç æ¨¡æ¿</h2>
            <div>
                <button class="control-btn" onclick="expandAll()">å…¨éƒ¨å±•å¼€</button>
                <button class="control-btn secondary" onclick="collapseAll()">å…¨éƒ¨æŠ˜å </button>
            </div>
        </div>

        <div class="info-banner">
            <strong>ğŸ“Œ é¡¹ç›®è¯´æ˜ï¼š</strong>
            <ul style="margin:5px 0 0 20px; padding:0; line-height:1.8;">
                <li>æœ¬é¡¹ç›®å®ç°åŸºäºDCTï¼ˆç¦»æ•£ä½™å¼¦å˜æ¢ï¼‰çš„éŸ³é¢‘å‹ç¼©ç³»ç»Ÿ</li>
                <li>ä»£ç ä¸­ <code>?</code> æ ‡è®°å¤„éœ€è¦å¡«å†™åˆé€‚çš„ä»£ç </li>
                <li>å®Œæˆex1-ex7åï¼Œä½¿ç”¨ <code>test_project1.p</code> è¿›è¡Œè‡ªåŠ¨æ£€æŸ¥</li>
                <li>å…¨éƒ¨å®Œæˆåè¿è¡Œ <code>ex0_all.m</code> æŸ¥çœ‹å®Œæ•´æ•ˆæœï¼Œæ”¶å¬ /audio ç›®å½•ä¸‹ç”Ÿæˆçš„å‹ç¼©éŸ³é¢‘</li>
            </ul>
        </div>

        <div class="warning-banner">
            <strong>âš ï¸ æäº¤æ¸…å•ï¼š</strong>
            <ul style="margin:5px 0 0 20px; padding:0;">
                <li>ex1_read_audio_cut.mï¼ˆè¯»å–éŸ³é¢‘å¹¶åˆ†æ®µï¼‰</li>
                <li>ex2_dct_x_cut.mï¼ˆDCTå˜æ¢ï¼‰</li>
                <li>ex3_energy_cut.mï¼ˆèƒ½é‡é˜ˆå€¼å¤„ç†ï¼‰</li>
                <li>ex4_quantization.mï¼ˆé‡åŒ–ä¸è§£é‡åŒ–ï¼‰</li>
                <li>ex5_idct_quant.mï¼ˆIDCTé€†å˜æ¢ï¼‰</li>
                <li>ex6_recombine_I_X.mï¼ˆåˆå¹¶é‡å»ºï¼‰</li>
                <li>ex7_analyze.mï¼ˆæ€§èƒ½åˆ†æï¼‰</li>
            </ul>
        </div>

        <div class="success-banner">
            <strong>âœ… å®éªŒæµç¨‹ï¼š</strong>
            <ol style="margin:5px 0 0 20px; padding:0; line-height:1.8;">
                <li>é˜…è¯»å®éªŒæ‰‹å†Œã€ŠåŸºäºDCTåŸç†çš„éŸ³é¢‘å‹ç¼©å®éªŒã€‹ï¼ˆDSP-Proj1_handoutï¼‰</li>
                <li>æŒ‰é¡ºåºå®Œæˆex1-ex7ï¼Œå¡«å†™æ ‡è®°ä¸º <code>?</code> çš„ä»£ç </li>
                <li>è¿è¡Œ <code>test_project1.p</code> æ£€æŸ¥ä»£ç ï¼ˆè¾“å…¥1-7æ£€æŸ¥å¯¹åº”æ¨¡å—ï¼‰</li>
                <li>å®Œæˆåè¾“å…¥0ï¼Œæäº¤å­¦å·å§“åï¼Œç”ŸæˆåŠ å¯†æˆç»©</li>
                <li>å°†æ‰€æœ‰å®Œæˆåçš„Mæ–‡ä»¶å‹ç¼©åˆ°ã€å­¦å·_å§“å.zipã€‘æäº¤åˆ°å­¦ä¹ é€š</li>
            </ol>
        </div>

        <!-- ex0 ä¸»å‡½æ•° -->
        <div class="file-block">
            <div class="file-header" onclick="toggleBlock(this)">
                <span class="file-title">
                    <span class="arrow-icon">â–¼</span>
                    ğŸ“„ ex0_all.mï¼ˆä¸»å‡½æ•°ï¼Œæ— éœ€ä¿®æ”¹ï¼‰
                </span>
                <button class="copy-btn" onclick="copyCode(event, 'code0')">å¤åˆ¶ä»£ç </button>
            </div>
            <div class="file-content">
                <pre id="code0">clc;
clear;
close all;

% ex0æ–‡ä»¶ä½œä¸ºæ€»æ–‡ä»¶ï¼Œå¯åœ¨exå…¨éƒ¨å®Œæˆåè¿è¡Œæµ‹è¯•ï¼Œå¯å¯¹å‚æ•°éƒ¨åˆ†è¿›è¡Œä¿®æ”¹ä½“éªŒåŒºåˆ«
global path path_out fs;  % å®šä¹‰å…¨å±€å˜é‡æ–¹ä¾¿è°ƒç”¨ (å¢åŠ fs)

% å®šä¹‰éŸ³é¢‘æ–‡ä»¶è·¯å¾„
path = './audio/greatest_work.flac';    % è®¾å®špathä¸ºåŸå§‹éŸ³é¢‘è·¯å¾„ï¼Œæ ¼å¼flac
path_out = './audio/greatest_work_compressed.flac';   % è®¾å®špath_outä¸ºé‡å»ºéŸ³é¢‘è·¯å¾„ï¼Œæ ¼å¼flac

% çª—å‡½æ•°å¤§å°è®¾ç½®
window = 512;  % è®¾å®šçª—å‡½æ•°å¤§å°ä¸º512

% è°ƒç”¨ ex1_read_audio_cut å‡½æ•°è¯»å–éŸ³é¢‘å¹¶è¿›è¡Œåˆ†æ®µ
[x_cut, N, nb] = ex1_read_audio_cut(window, path);        

% è°ƒç”¨ ex2_dct_x_cut å¯¹åˆ†æ®µéŸ³é¢‘ä½œDCTå˜æ¢
[X_CUT, row, col] = ex2_dct_x_cut(x_cut);                       

% è®¾ç½®é˜ˆå€¼ç™¾åˆ†æ¯”
perc = 0.99;

% è°ƒç”¨ ex3_energy_cut å¯¹DCTç»“æœè¿›è¡Œé˜ˆå€¼å¤„ç†
[X_CUT_99, ind, i] = ex3_energy_cut(X_CUT, perc);             

% è°ƒç”¨ ex4_quantization å¯¹é˜ˆå€¼åŒ–ç»“æœä½œé‡åŒ–å’Œè§£é‡åŒ–
[q, tmp, quant] = ex4_quantization(X_CUT_99);                 

% è°ƒç”¨ ex5_idct_quant å¯¹è§£é‡åŒ–ç»“æœä½œIDCTå˜æ¢
I_X_quant = ex5_idct_quant(quant);                  

% è°ƒç”¨ ex6_recombine_I_X å¯¹IDCTç»“æœä½œåˆå¹¶é‡å»º
[dis, reconstruct] = ex6_recombine_I_X(I_X_quant);         

% è°ƒç”¨ ex7_analyze å¯¹æ¯”åŸå§‹ä¿¡å·å’Œé‡å»ºä¿¡å·ï¼Œé»˜è®¤æ˜¾ç¤ºå›¾å½¢
ratio = ex7_analyze(reconstruct, true);             

disp('éŸ³é¢‘æ–‡ä»¶å·²ä¿å­˜');</pre>
            </div>
        </div>

        <!-- ex1 è¯»å–éŸ³é¢‘å¹¶åˆ†æ®µ -->
        <div class="file-block">
            <div class="file-header" onclick="toggleBlock(this)">
                <span class="file-title">
                    <span class="arrow-icon">â–¼</span>
                    ğŸ“„ ex1_read_audio_cut.mï¼ˆè¯»å–éŸ³é¢‘å¹¶åˆ†æ®µï¼‰
                </span>
                <button class="copy-btn" onclick="copyCode(event, 'code1')">å¤åˆ¶ä»£ç </button>
            </div>
            <div class="file-content">
                <pre id="code1">function [x_cut, N, nb] = ex1_read_audio_cut(window, path)
%EX1_READ_AUDIO_CUT è¯»å–éŸ³é¢‘æ–‡ä»¶å¹¶å¯¹å…¶è¿›è¡Œåˆ†æ®µ

global fs; % å£°æ˜å…¨å±€å˜é‡fs
[x, fs_local] = audioread(path);  % ä½¿ç”¨ audioread å‡½æ•°è¯»å–éŸ³é¢‘æ–‡ä»¶ï¼Œå¾—åˆ°éŸ³é¢‘æ•°æ® x å’Œé‡‡æ ·é¢‘ç‡ fs
fs = fs_local; % å°†è¯»å–åˆ°çš„é‡‡æ ·ç‡å­˜å…¥å…¨å±€å˜é‡

% N è¡¨ç¤ºéŸ³é¢‘æ•°æ®çš„æ€»é•¿åº¦ï¼Œå³é‡‡æ ·ç‚¹çš„æ•°é‡ã€‚
N = <span class="todo">?</span>;  % ä½¿ç”¨ length å‡½æ•°

% nb è¡¨ç¤ºå¯ä»¥åˆ†æˆå¤šå°‘æ®µéŸ³é¢‘ï¼Œå³éŸ³é¢‘æ•°æ®é•¿åº¦ N é™¤ä»¥ window çš„å€¼ã€‚
nb = <span class="todo">?</span>;  % ä½¿ç”¨ floor å‡½æ•°

% x_cut æ˜¯ä¸€ä¸ªäºŒç»´çŸ©é˜µï¼Œæ¯åˆ—è¡¨ç¤ºä¸€æ®µéŸ³é¢‘ï¼Œæ¯æ®µçš„é•¿åº¦ä¸º window ä¸ªé‡‡æ ·ç‚¹ã€‚
x_cut = <span class="todo">?</span>;  % ä½¿ç”¨ zeros å‡½æ•°åˆå§‹åŒ–

% å¾ªç¯éå†æ¯ä¸€æ®µéŸ³é¢‘æ•°æ®ï¼Œå¹¶å°†å…¶å¡«å……åˆ° x_cut çš„æ¯ä¸€åˆ—ä¸­ã€‚
for n = 1:nb
    % åœ¨æ­¤å¤„å°†æ¯ä¸€æ®µéŸ³é¢‘æ•°æ®å¡«å……åˆ° x_cut çš„ç¬¬ n åˆ—ã€‚
    x_cut(:, n) = <span class="todo">?</span>;  % ä½¿ç”¨ n*window åŠå…¶å˜å½¢å®šä¹‰èµ·ç‚¹å’Œç»ˆç‚¹
end
end</pre>
            </div>
        </div>

        <!-- ex2 DCTå˜æ¢ -->
        <div class="file-block">
            <div class="file-header" onclick="toggleBlock(this)">
                <span class="file-title">
                    <span class="arrow-icon">â–¼</span>
                    ğŸ“„ ex2_dct_x_cut.mï¼ˆDCTå˜æ¢ï¼‰
                </span>
                <button class="copy-btn" onclick="copyCode(event, 'code2')">å¤åˆ¶ä»£ç </button>
            </div>
            <div class="file-content">
                <pre id="code2">function [X_CUT, row, col] = ex2_dct_x_cut(x_cut)
%EX2_DCT_X_CUT å°†åˆ†å‰²åçš„éŸ³é¢‘ä¿¡å·åˆ†åˆ«ä½œDCTè®¡ç®—

[row, col] = <span class="todo">?</span>;  % è·å–x_cutçš„è¡Œæ•°å’Œåˆ—æ•°
X_CUT = <span class="todo">?</span>;       % zerosåˆå§‹åŒ–dctè®¡ç®—ç»“æœï¼Œåº”å’Œæ—¶åŸŸä¿¡å·å¤§å°ä¸€è‡´

for c = 1:col                   % å¾ªç¯ï¼Œå¯¹x_cutçš„æ¯ä¸€åˆ—ä½œdctè®¡ç®—
    X_CUT(:,c) = <span class="todo">?</span>;  % ä½¿ç”¨dctå‡½æ•°
end
end</pre>
            </div>
        </div>

        <!-- ex3 èƒ½é‡é˜ˆå€¼å¤„ç† -->
        <div class="file-block">
            <div class="file-header" onclick="toggleBlock(this)">
                <span class="file-title">
                    <span class="arrow-icon">â–¼</span>
                    ğŸ“„ ex3_energy_cut.mï¼ˆèƒ½é‡é˜ˆå€¼å¤„ç†ï¼‰
                </span>
                <button class="copy-btn" onclick="copyCode(event, 'code3')">å¤åˆ¶ä»£ç </button>
            </div>
            <div class="file-content">
                <pre id="code3">function [X_CUT_99, ind, i] = ex3_energy_cut(X_CUT, perc)
%EX3_ENERGY_CUT å°†DCTè®¡ç®—ç»“æœè¿›è¡Œé˜ˆå€¼åŒ–å¤„ç†

[row, col] = size(X_CUT);         % å–å¾—DCTç³»æ•°çŸ©é˜µçš„è¡Œæ•°å’Œåˆ—æ•°
X_CUT_99 = X_CUT;                 % åˆå§‹åŒ–é˜ˆå€¼åŒ–åçš„ç»“æœçŸ©é˜µ
ind = cell(col, 1);               % åˆå§‹åŒ–ç´¢å¼•å•å…ƒæ•°ç»„
i = zeros(col, 1);                % åˆå§‹åŒ–ä¿ç•™ç³»æ•°æ•°é‡å‘é‡

for c = 1:col                     % å¯¹æ¯ä¸€åˆ—è¿›è¡Œæ“ä½œ
    % å¯¹æ¯ä¸€åˆ—ç³»æ•°çš„ç»å¯¹å€¼è¿›è¡Œé™åºæ’åˆ—ï¼Œå¹¶è·å–å¯¹åº”çš„ç´¢å¼•
    [sorted_coeffs, sorted_idx] = <span class="todo">?</span>;
    
    % è®¡ç®—æ¯åˆ—çš„æ€»èƒ½é‡
    total_energy = sum(sorted_coeffs.^2);
    cumulative_energy = <span class="todo">?</span>;     % åˆå§‹åŒ–ç´¯ç§¯èƒ½é‡
    count = 1;                    % åˆå§‹åŒ–é˜ˆå€¼ä½ç½®

    % å½“ç´¯ç§¯èƒ½é‡ä¸è¶³æ€»èƒ½é‡çš„ perc éƒ¨åˆ†æ—¶ï¼Œå¢åŠ  count çš„å€¼
    while <span class="todo">?</span>
        cumulative_energy = cumulative_energy + sorted_coeffs(count)^2;
        count = <span class="todo">?</span>;
    end
    
    % ä¿ç•™å‰ count-1 ä¸ªæœ€é‡è¦çš„ç³»æ•°
    i(c) = count - 1;
    ind{c} = sorted_idx(1:i(c));
    
    % è·å–å°äºè¿™äº›èƒ½é‡çš„ä½ç½®å¹¶ç½®é›¶
    zero_indices = sorted_idx(<span class="todo">?</span>); % ä»ç¬¬ count ä¸ªåˆ°æœ€åçš„ç´¢å¼•
    X_CUT_99(<span class="todo">?</span>) = 0;  % å°†è¿™äº›ä½ç½®çš„å€¼ç½®ä¸ºé›¶
end
end</pre>
            </div>
        </div>

        <!-- ex4 é‡åŒ–ä¸è§£é‡åŒ– -->
        <div class="file-block">
            <div class="file-header" onclick="toggleBlock(this)">
                <span class="file-title">
                    <span class="arrow-icon">â–¼</span>
                    ğŸ“„ ex4_quantization.mï¼ˆé‡åŒ–ä¸è§£é‡åŒ–ï¼‰
                </span>
                <button class="copy-btn" onclick="copyCode(event, 'code4')">å¤åˆ¶ä»£ç </button>
            </div>
            <div class="file-content">
                <pre id="code4">function [q, tmp, quant] = ex4_quantization(X_CUT_99)
%EX4_QUANTIZATION å¯¹DCTç³»æ•°è¿›è¡Œé‡åŒ–å’Œè§£é‡åŒ–

% è®¾ç½®é‡åŒ–ä½æ•°
b = 6;  % 6ä½é‡åŒ–ï¼Œå¯è¡¨ç¤º2^6=64ä¸ªçº§åˆ«

% æ‰¾å‡ºæœ€å¤§å€¼ä½œä¸ºé‡åŒ–åŒºé—´
L = <span class="todo">?</span>;  % ä½¿ç”¨maxå’Œabså‡½æ•°

% è®¡ç®—é‡åŒ–æ­¥é•¿
q = <span class="todo">?</span>;  % é‡åŒ–æ­¥é•¿å…¬å¼

% é‡åŒ–ï¼šå°†è¿ç»­å€¼æ˜ å°„åˆ°ç¦»æ•£çº§åˆ«
tmp = <span class="todo">?</span>;  % ä½¿ç”¨roundå‡½æ•°å››èˆäº”å…¥

% è§£é‡åŒ–ï¼šå°†ç¦»æ•£å€¼æ˜ å°„å›è¿ç»­å€¼
quant = <span class="todo">?</span>;  % ä¹˜ä»¥é‡åŒ–æ­¥é•¿

end</pre>
            </div>
        </div>

        <!-- ex5 IDCTé€†å˜æ¢ -->
        <div class="file-block">
            <div class="file-header" onclick="toggleBlock(this)">
                <span class="file-title">
                    <span class="arrow-icon">â–¼</span>
                    ğŸ“„ ex5_idct_quant.mï¼ˆIDCTé€†å˜æ¢ï¼‰
                </span>
                <button class="copy-btn" onclick="copyCode(event, 'code5')">å¤åˆ¶ä»£ç </button>
            </div>
            <div class="file-content">
                <pre id="code5">function I_X_quant = ex5_idct_quant(quant)
%EX5_IDCT_QUANT å¯¹é‡åŒ–åçš„DCTç³»æ•°è¿›è¡Œé€†å˜æ¢

[row, col] = size(quant);
I_X_quant = zeros(row, col);

for c = 1:col
    I_X_quant(:, c) = <span class="todo">?</span>;  % ä½¿ç”¨idctå‡½æ•°å¯¹quantçš„ç¬¬cåˆ—è¿›è¡Œé€†å˜æ¢
end
end</pre>
            </div>
        </div>

        <!-- ex6 åˆå¹¶é‡å»º -->
        <div class="file-block">
            <div class="file-header" onclick="toggleBlock(this)">
                <span class="file-title">
                    <span class="arrow-icon">â–¼</span>
                    ğŸ“„ ex6_recombine_I_X.mï¼ˆåˆå¹¶é‡å»ºï¼‰
                </span>
                <button class="copy-btn" onclick="copyCode(event, 'code6')">å¤åˆ¶ä»£ç </button>
            </div>
            <div class="file-content">
                <pre id="code6">function [dis, reconstruct] = ex6_recombine_I_X(I_X_quant)
%EX6_RECOMBINE_I_X å°†IDCTåçš„ç‰‡æ®µåˆå¹¶é‡å»ºå®Œæ•´éŸ³é¢‘

global path_out fs; % å£°æ˜å…¨å±€å˜é‡fs

[row, col] = size(I_X_quant);

% è®¡ç®—é‡å»ºä¿¡å·çš„æ€»é•¿åº¦
dis = <span class="todo">?</span>;  % è¡Œæ•°ä¹˜ä»¥åˆ—æ•°

% åˆå§‹åŒ–é‡å»ºä¿¡å·
reconstruct = <span class="todo">?</span>;  % åˆ›å»ºä¸€ç»´é›¶å‘é‡

% å°†æ¯ä¸ªç‰‡æ®µæ‹¼æ¥èµ·æ¥
for n = 1:col
    start_idx = <span class="todo">?</span>;  % èµ·å§‹ç´¢å¼•
    end_idx = <span class="todo">?</span>;    % ç»“æŸç´¢å¼•
    reconstruct(start_idx:end_idx) = <span class="todo">?</span>;  % å°†ç¬¬nåˆ—èµ‹å€¼åˆ°å¯¹åº”ä½ç½®
end

% ä¿å­˜é‡å»ºçš„éŸ³é¢‘
audiowrite(path_out, reconstruct, fs);  % ä½¿ç”¨ä»åŸå§‹éŸ³é¢‘è¯»å–çš„æ­£ç¡®é‡‡æ ·ç‡fs
end</pre>
            </div>
        </div>

        <!-- ex7 æ€§èƒ½åˆ†æ -->
        <div class="file-block">
            <div class="file-header" onclick="toggleBlock(this)">
                <span class="file-title">
                    <span class="arrow-icon">â–¼</span>
                    ğŸ“„ ex7_analyze.mï¼ˆæ€§èƒ½åˆ†æï¼‰
                </span>
                <button class="copy-btn" onclick="copyCode(event, 'code7')">å¤åˆ¶ä»£ç </button>
            </div>
            <div class="file-content">
                <pre id="code7">function ratio = ex7_analyze(reconstruct, show_plot)
%EX7_ANALYZE åˆ†æå‹ç¼©æ•ˆæœå¹¶å¯è§†åŒ–å¯¹æ¯”

global path;

% è¯»å–åŸå§‹éŸ³é¢‘
[x_original, fs] = audioread(path);

% ç¡®ä¿é•¿åº¦ä¸€è‡´ï¼ˆå–è¾ƒçŸ­çš„é•¿åº¦ï¼‰
min_length = <span class="todo">?</span>;  % ä½¿ç”¨minå‡½æ•°
x_original = x_original(1:min_length);
reconstruct = reconstruct(1:min_length);

% è®¡ç®—å‡æ–¹è¯¯å·®MSE
mse = <span class="todo">?</span>;  % ä½¿ç”¨meanå‡½æ•°

% è®¡ç®—å‹ç¼©æ¯”ï¼ˆç®€åŒ–è®¡ç®—ï¼Œå®é™…åº”è€ƒè™‘å­˜å‚¨çš„ç³»æ•°æ•°é‡ï¼‰
% å‡è®¾åŸå§‹ä¸º16ä½ï¼Œå‹ç¼©åä¸º6ä½é‡åŒ–
ratio = 16 / 6;

% æ˜¾ç¤ºç»“æœ
fprintf('å‹ç¼©æ¯”: %.2f:1\n', ratio);
fprintf('å‡æ–¹è¯¯å·®MSE: %.6f\n', mse);

% å¦‚æœéœ€è¦æ˜¾ç¤ºå›¾å½¢
if show_plot
    figure('Name', 'åŸå§‹ä¿¡å· vs é‡å»ºä¿¡å·', 'NumberTitle', 'off');
    
    % ç»˜åˆ¶æ—¶åŸŸå¯¹æ¯”
    subplot(2,1,1);
    plot_range = 1:min(5000, min_length);  % åªæ˜¾ç¤ºå‰5000ä¸ªç‚¹
    plot(plot_range, x_original(plot_range), 'b', 'LineWidth', 1);
    hold on;
    plot(plot_range, reconstruct(plot_range), 'r--', 'LineWidth', 1);
    legend('åŸå§‹ä¿¡å·', 'é‡å»ºä¿¡å·');
    title('æ—¶åŸŸæ³¢å½¢å¯¹æ¯”');
    xlabel('é‡‡æ ·ç‚¹');
    ylabel('å¹…åº¦');
    grid on;
    
    % ç»˜åˆ¶è¯¯å·®
    subplot(2,1,2);
    error_signal = x_original - reconstruct;
    plot(plot_range, error_signal(plot_range), 'g', 'LineWidth', 1);
    title('é‡å»ºè¯¯å·®');
    xlabel('é‡‡æ ·ç‚¹');
    ylabel('è¯¯å·®å¹…åº¦');
    grid on;
end
end</pre>
            </div>
        </div>

    </div>

    <script>
        function toggleBlock(header) {
            const block = header.parentElement;
            block.classList.toggle('collapsed');
        }

        function expandAll() {
            document.querySelectorAll('.file-block').forEach(block => {
                block.classList.remove('collapsed');
            });
        }

        function collapseAll() {
            document.querySelectorAll('.file-block').forEach(block => {
                block.classList.add('collapsed');
            });
        }

        function copyCode(event, codeId) {
            event.stopPropagation();
            const code = document.getElementById(codeId).innerText;
            navigator.clipboard.writeText(code).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'âœ“ å·²å¤åˆ¶';
                btn.style.background = '#38a169';
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '#48bb78';
                }, 2000);
            });
        }
    </script>
</body>
</html>