<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DSP-Lab2 æ™ºèƒ½ç»ƒä¹ ç³»ç»Ÿ</title>
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$','$'], ['\\(','\\)']],
                displayMath: [['$$','$$'], ['\\[','\\]']],
                processEscapes: true
            },
            CommonHTML: { scale: 110 },
            "HTML-CSS": { scale: 110 }
        });
    </script>
    
    <style>
        .mathjax-status {
            position: fixed; top: 10px; right: 15px; padding: 8px 15px; border-radius: 5px;
            background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb;
            font-size: 14px; z-index: 10000; font-family: 'Microsoft YaHei', sans-serif;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        .mathjax-status.loading { background-color: #fff3cd; color: #856404; border-color: #ffeeba; }
        .mathjax-status.success {
            background-color: #d4edda; color: #155724; border-color: #c3e6cb;
            transition: opacity 0.5s ease-out 1.5s; opacity: 0;
        }
    </style>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Microsoft YaHei', 'SimSun', Arial, sans-serif;
            background: linear-gradient(135deg, #608de0 0%, #7dadff 50%, #5ca353 100%);
            min-height: 100vh; padding: 20px;
        }
        .container {
            max-width: 900px; margin: 0 auto; background: white; border-radius: 20px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.25); padding: 40px;
        }
        h1 { color: #2d57a4; text-align: center; margin-bottom: 30px; font-size: 2em; }
        h2 { color: #608de0; margin: 25px 0 15px 0; }
        
        .login-section, .quiz-section, .result-section { display: none; }
        .login-section.active, .quiz-section.active, .result-section.active { display: block; }
        
        .form-group { margin-bottom: 20px; }
        label { display: block; color: #2d57a4; font-weight: bold; margin-bottom: 8px; }
        input[type="text"] { 
            width: 100%; padding: 12px; border: 2px solid #7dadff; border-radius: 8px; 
            font-size: 16px; transition: border-color 0.3s;
        }
        input[type="text"]:focus { border-color: #2d57a4; outline: none; }
        
        button {
            background: linear-gradient(135deg, #608de0 0%, #7dadff 100%); color: white; border: none;
            padding: 12px 30px; border-radius: 25px; cursor: pointer; font-size: 16px;
            font-weight: bold; transition: all 0.3s; box-shadow: 0 3px 10px rgba(96, 141, 224, 0.3);
        }
        button:hover {
            background: linear-gradient(135deg, #2d57a4 0%, #608de0 100%);
            transform: translateY(-2px); box-shadow: 0 5px 15px rgba(96, 141, 224, 0.5);
        }
        button:disabled { background: #ccc; cursor: not-allowed; transform: none; }
        
        .question-box { 
            background: #f8f9fa; border-left: 5px solid #608de0; padding: 25px; 
            margin: 20px 0; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .question-title { color: #2d57a4; font-weight: bold; font-size: 1.2em; margin-bottom: 15px; }
        .question-number { 
            display: inline-block; background: #608de0; color: white; padding: 4px 12px; 
            border-radius: 15px; font-size: 0.9em; margin-right: 10px;
        }
        
        .options { margin: 15px 0; }
        .option, .checkbox-option {
            display: block; background: white; padding: 12px; margin: 8px 0; 
            border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; 
            transition: all 0.3s; position: relative;
        }
        .option:hover, .checkbox-option:hover { background: #e8f5ff; border-color: #608de0; }
        .option.selected { background: #608de0; color: white; border-color: #2d57a4; }
        .option.correct, .checkbox-option.correct { 
            background: #5ca353; color: white; border-color: #4a8842; 
            animation: correctPulse 0.5s ease-in-out;
        }
        .option.incorrect, .checkbox-option.incorrect { 
            background: #D46A6A; color: white; border-color: #912d32;
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        
        .feedback { margin: 15px 0; padding: 15px; border-radius: 8px; font-weight: bold; }
        .feedback.correct { background: #e8f5e9; color: #5ca353; border-left: 5px solid #5ca353; }
        .feedback.incorrect { background: #ffebee; color: #912d32; border-left: 5px solid #912d32; }
        
        .progress-bar { 
            width: 100%; height: 30px; background: #e0e0e0; border-radius: 15px; 
            overflow: hidden; margin: 20px 0; position: relative;
        }
        .progress-fill {
            height: 100%; background: linear-gradient(90deg, #5ca353 0%, #608de0 100%);
            transition: width 0.5s; display: flex; align-items: center; justify-content: center;
            color: white; font-weight: bold;
        }
        
        .topic-indicator {
            background: linear-gradient(135deg, #fff8e1 0%, #fffbf0 100%);
            border-left: 5px solid #fbc02d; padding: 15px; margin: 20px 0; 
            border-radius: 8px; text-align: center;
        }
        .topic-name { color: #2d57a4; font-size: 1.3em; font-weight: bold; }
        .topic-progress { color: #666; font-size: 0.9em; margin-top: 8px; }
        
        .stats-table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        .stats-table th, .stats-table td { padding: 12px; text-align: left; border: 1px solid #e0e0e0; }
        .stats-table th { background: linear-gradient(135deg, #608de0 0%, #7dadff 100%); color: white; }
        .stats-table tr:nth-child(even) { background: #f8f9fa; }
        
        .mastery-excellent { color: #5ca353; font-weight: bold; }
        .mastery-good { color: #608de0; font-weight: bold; }
        .mastery-fair { color: #D46A6A; font-weight: bold; }
        .mastery-poor { color: #912d32; font-weight: bold; }
        
        .info-box { 
            background: linear-gradient(135deg, #e8f5ff 0%, #f0f9ff 100%);
            border-left: 5px solid #608de0; padding: 15px; margin: 15px 0; border-radius: 8px; 
        }
        .warning-box {
            background: linear-gradient(135deg, #fff8e1 0%, #fffbf0 100%);
            border-left: 5px solid #D46A6A; padding: 15px; margin: 15px 0; border-radius: 8px;
        }
        
        input[type="checkbox"] { margin-right: 8px; width: 18px; height: 18px; cursor: pointer; }
        .checkbox-option { display: flex; align-items: center; }
        
        .student-info-display {
            background: #f8f9fa; padding: 12px; border-radius: 8px; margin-bottom: 20px;
            text-align: center; color: #2d57a4; font-weight: bold;
        }
        
        .explanation-detail {
            margin-top: 10px; padding: 10px; background: rgba(255,255,255,0.5);
            border-radius: 5px; font-size: 0.95em; font-weight: normal;
        }
    </style>
</head>
<body>
    <div id="mathjaxStatus" class="mathjax-status loading">æ­£åœ¨åŠ è½½æ•°å­¦å…¬å¼...</div>
    
    <div class="container">
        <!-- ç™»å½•ç•Œé¢ -->
        <div class="login-section active">
            <h1>ğŸ“ DSP-Lab2 æ™ºèƒ½ç»ƒä¹ ç³»ç»Ÿ</h1>
            <div class="info-box">
                <strong>ğŸ“Œ ç³»ç»Ÿç‰¹è‰²</strong>
                <ul style="margin: 10px 0 0 20px; line-height: 1.8;">
                    <li><strong>çŸ¥è¯†ç‚¹å…¨è¦†ç›–</strong>ï¼šæ¶µç›–å·®åˆ†æ–¹ç¨‹ã€Zå˜æ¢ã€é›¶æç‚¹ã€ç¨³å®šæ€§ç­‰6å¤§æ ¸å¿ƒçŸ¥è¯†ç‚¹</li>
                    <li><strong>é¢˜ç›®éšæœºåŒ–</strong>ï¼šæ¯æ¬¡ç»ƒä¹ æ•°å€¼ã€é€‰é¡¹é¡ºåºéƒ½ä¸åŒï¼Œé¿å…æ­»è®°ç¡¬èƒŒ</li>
                    <li><strong>æ™ºèƒ½å¾ªç¯</strong>ï¼šç­”é”™è‡ªåŠ¨å‡ºæ–°é¢˜å·©å›ºï¼Œç­”å¯¹æ‰è¿›å…¥ä¸‹ä¸€çŸ¥è¯†ç‚¹</li>
                    <li><strong>è¯¦ç»†åé¦ˆ</strong>ï¼šæ¯é¢˜éƒ½æœ‰è¯¦ç»†è§£æï¼Œå¸®åŠ©ç†è§£æ ¸å¿ƒæ¦‚å¿µ</li>
                </ul>
            </div>
            <div class="form-group">
                <label>å­¦å·:</label>
                <input type="text" id="studentId" placeholder="è¯·è¾“å…¥å­¦å·">
            </div>
            <div class="form-group">
                <label>å§“å:</label>
                <input type="text" id="studentName" placeholder="è¯·è¾“å…¥å§“å">
            </div>
            <button onclick="startQuiz()">å¼€å§‹ç»ƒä¹ </button>
        </div>

        <!-- æµ‹éªŒç•Œé¢ -->
        <div class="quiz-section">
            <h1>DSP-Lab2 æ™ºèƒ½ç»ƒä¹ </h1>
            <div id="studentInfo" class="student-info-display"></div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar">0%</div>
            </div>
            
            <div id="currentTopic" class="topic-indicator"></div>
            
            <div class="question-box">
                <div class="question-title" id="questionTitle"></div>
                <div id="questionContent"></div>
                <div id="options" class="options"></div>
                <div id="feedback"></div>
                <button id="submitBtn" onclick="submitAnswer()">æäº¤ç­”æ¡ˆ</button>
                <button id="nextBtn" onclick="nextQuestion()" style="display:none;">ä¸‹ä¸€é¢˜</button>
            </div>
        </div>

        <!-- ç»“æœç•Œé¢ -->
        <div class="result-section">
            <h1>ğŸ“Š ç»ƒä¹ ç»“æœæŠ¥å‘Š</h1>
            <div id="finalReport"></div>
            <button onclick="saveScreenshot()" id="saveBtn">ğŸ’¾ ä¿å­˜æŠ¥å‘Š</button>
            <button onclick="location.reload()" style="margin-left: 10px;">ğŸ”„ é‡æ–°ç»ƒä¹ </button>
        </div>
    </div>

    <script>
        // ==================== çŸ¥è¯†ç‚¹é¢˜åº“å®šä¹‰ ====================
        const knowledgeBase = {
            // çŸ¥è¯†ç‚¹1: å·®åˆ†æ–¹ç¨‹ä¸MATLABå®ç°
            differenceEquation: {
                id: 'differenceEquation',
                name: 'å·®åˆ†æ–¹ç¨‹ä¸MATLABå®ç°',
                description: 'ç†è§£å·®åˆ†æ–¹ç¨‹çš„å½¢å¼åŠå…¶ä¸filterå‡½æ•°å‚æ•°çš„å¯¹åº”å…³ç³»',
                questionGenerators: [
                    // é¢˜å‹1: å·®åˆ†æ–¹ç¨‹è½¬ç³»æ•°å‘é‡
                    {
                        type: 'single',
                        generate: () => {
                            const scenarios = [
                                { eq: 'y[n] - 0.5y[n-1] = x[n]', a: '[1, -0.5]', b: '[1]' },
                                { eq: 'y[n] + 0.8y[n-1] = 2x[n]', a: '[1, 0.8]', b: '[2]' },
                                { eq: 'y[n] = 0.5x[n] + x[n-1]', a: '[1]', b: '[0.5, 1]' },
                                { eq: 'y[n] - 0.3y[n-1] + 0.2y[n-2] = x[n]', a: '[1, -0.3, 0.2]', b: '[1]' },
                                { eq: 'y[n] = x[n] - 0.5x[n-1] + 0.25x[n-2]', a: '[1]', b: '[1, -0.5, 0.25]' }
                            ];
                            const s = scenarios[Math.floor(Math.random() * scenarios.length)];
                            const wrongOptions = [
                                { a: '[1, 0.5]', b: '[1]' },
                                { a: '[1]', b: '[1, -0.5]' },
                                { a: '[-0.5, 1]', b: '[1]' }
                            ];
                            return {
                                question: `å·®åˆ†æ–¹ç¨‹ $${s.eq}$ å¯¹åº”çš„MATLAB <code>filter(b,a,x)</code> å‚æ•°åº”ä¸ºï¼š`,
                                options: shuffleOptions([
                                    { text: `a = ${s.a}, b = ${s.b}`, correct: true },
                                    ...wrongOptions.slice(0, 3)
                                ]),
                                explanation: `æ ¹æ®MATLABçš„filterå‡½æ•°å®šä¹‰ï¼Œaå‘é‡å¯¹åº”y[n]ä¾§çš„ç³»æ•°ï¼ˆy[n]ç³»æ•°å½’ä¸€åŒ–ä¸º1ï¼‰ï¼Œbå‘é‡å¯¹åº”x[n]ä¾§çš„ç³»æ•°ã€‚æ³¨æ„ç¬¦å·ï¼šæ–¹ç¨‹ä¸­çš„å‡å·åœ¨aå‘é‡ä¸­å˜ä¸ºè´Ÿå·ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹2: åˆ¤æ–­ç³»æ•°æ­£è¯¯
                    {
                        type: 'single',
                        generate: () => {
                            const coef = (Math.random() * 1.5 + 0.2).toFixed(1);
                            const eq = `y[n] - ${coef}y[n-1] = x[n]`;
                            return {
                                question: `å¯¹äºå·®åˆ†æ–¹ç¨‹ $${eq}$ï¼Œä»¥ä¸‹å“ªä¸ªè¯´æ³•æ˜¯<strong>é”™è¯¯</strong>çš„ï¼Ÿ`,
                                options: shuffleOptions([
                                    { text: `aå‘é‡çš„ç¬¬ä¸€ä¸ªå…ƒç´ å¿…é¡»æ˜¯${coef}`, correct: true },
                                    { text: 'aå‘é‡çš„ç¬¬ä¸€ä¸ªå…ƒç´ åº”è¯¥æ˜¯1', correct: false },
                                    { text: `aå‘é‡åº”ä¸º[1, -${coef}]`, correct: false },
                                    { text: 'bå‘é‡åº”ä¸º[1]', correct: false }
                                ]),
                                explanation: `MATLABçš„filterå‡½æ•°çº¦å®šaå‘é‡çš„ç¬¬ä¸€ä¸ªå…ƒç´ å¯¹åº”y[n]çš„ç³»æ•°ï¼Œé€šå¸¸å½’ä¸€åŒ–ä¸º1ã€‚æ–¹ç¨‹ $${eq}$ ä¸­ï¼Œa = [1, -${coef}]ï¼Œè€Œä¸æ˜¯[${coef}, ...]ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹3: FIR vs IIRåˆ¤æ–­
                    {
                        type: 'single',
                        generate: () => {
                            const isFIR = Math.random() > 0.5;
                            const eq = isFIR 
                                ? `y[n] = ${(Math.random() * 2).toFixed(1)}x[n] + x[n-1]`
                                : `y[n] = ${(Math.random() * 0.9).toFixed(1)}y[n-1] + x[n]`;
                            return {
                                question: `å·®åˆ†æ–¹ç¨‹ $${eq}$ æè¿°çš„æ˜¯ä»€ä¹ˆç±»å‹çš„ç³»ç»Ÿï¼Ÿ`,
                                options: shuffleOptions([
                                    { text: isFIR ? 'FIRç³»ç»Ÿï¼ˆæœ‰é™è„‰å†²å“åº”ï¼‰' : 'IIRç³»ç»Ÿï¼ˆæ— é™è„‰å†²å“åº”ï¼‰', correct: true },
                                    { text: isFIR ? 'IIRç³»ç»Ÿï¼ˆæ— é™è„‰å†²å“åº”ï¼‰' : 'FIRç³»ç»Ÿï¼ˆæœ‰é™è„‰å†²å“åº”ï¼‰', correct: false },
                                    { text: 'æ—¢æ˜¯FIRåˆæ˜¯IIR', correct: false },
                                    { text: 'æ— æ³•åˆ¤æ–­', correct: false }
                                ]),
                                explanation: isFIR 
                                    ? 'FIRç³»ç»Ÿçš„å·®åˆ†æ–¹ç¨‹ä¸­åªæœ‰x[n]åŠå…¶å»¶è¿Ÿé¡¹ï¼Œæ²¡æœ‰y[n]çš„å»¶è¿Ÿé¡¹ã€‚å…¶å†²æ¿€å“åº”åœ¨æœ‰é™æ—¶é—´åå˜ä¸º0ã€‚'
                                    : 'IIRç³»ç»Ÿçš„å·®åˆ†æ–¹ç¨‹ä¸­åŒ…å«y[n]çš„å»¶è¿Ÿé¡¹ï¼ˆå¦‚y[n-1]ï¼‰ï¼Œå½¢æˆåé¦ˆï¼Œå¯¼è‡´å†²æ¿€å“åº”ç†è®ºä¸Šæ— é™é•¿ã€‚'
                            };
                        }
                    },
                    // é¢˜å‹4: ç´¢å¼•åç§»ç†è§£
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'MATLABæ•°ç»„ç´¢å¼•ä»1å¼€å§‹ï¼Œè€Œå·®åˆ†æ–¹ç¨‹é€šå¸¸ä»0å¼€å§‹ã€‚å¯¹äºæ–¹ç¨‹ $y[n] + 2y[n-1] = x[n]$ï¼Œaå‘é‡ä¸­ <code>a[2]</code> å¯¹åº”çš„æ˜¯ï¼š',
                                options: shuffleOptions([
                                    { text: '$y[n-1]$ çš„ç³»æ•°ï¼ˆå³2ï¼‰', correct: true },
                                    { text: '$y[n]$ çš„ç³»æ•°ï¼ˆå³1ï¼‰', correct: false },
                                    { text: '$y[n-2]$ çš„ç³»æ•°', correct: false },
                                    { text: 'æ²¡æœ‰å¯¹åº”å…³ç³»', correct: false }
                                ]),
                                explanation: 'MATLABä¸­ a[1]å¯¹åº”$a_0$ï¼ˆå³$y[n]$çš„ç³»æ•°ï¼‰ï¼Œa[2]å¯¹åº”$a_1$ï¼ˆå³$y[n-1]$çš„ç³»æ•°ï¼‰ã€‚å› æ­¤a[2] = 2ã€‚'
                            };
                        }
                    },
                    // é¢˜å‹5: é˜¶è·ƒå“åº”é¢„æµ‹
                    {
                        type: 'single',
                        generate: () => {
                            const isFIR = Math.random() > 0.5;
                            const eq = isFIR ? 'y[n] = x[n] + x[n-1]' : 'y[n] = 0.5y[n-1] + x[n]';
                            return {
                                question: `å¯¹äºç³»ç»Ÿ $${eq}$ï¼Œå½“è¾“å…¥ä¸ºå•ä½é˜¶è·ƒä¿¡å·$u[n]$æ—¶ï¼Œè¾“å‡ºå“åº”çš„ç‰¹ç‚¹æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: isFIR ? 'åœ¨nâ‰¥1åç¨³å®šåœ¨å¸¸æ•°2' : 'é€æ¸å¢é•¿å¹¶è¶‹è¿‘äºç¨³æ€å€¼2', correct: true },
                                    { text: isFIR ? 'æŒç»­å¢é•¿' : 'åœ¨æœ‰é™æ—¶é—´åå˜ä¸º0', correct: false },
                                    { text: 'æŒ¯è¡', correct: false },
                                    { text: 'å‘æ•£åˆ°æ— ç©·', correct: false }
                                ]),
                                explanation: isFIR
                                    ? 'FIRç³»ç»Ÿçš„é˜¶è·ƒå“åº”ï¼šy[0]=1, y[1]=2, y[n]=2 (nâ‰¥1)ï¼Œå› ä¸ºåªæœ‰å½“å‰å’Œå‰ä¸€ä¸ªè¾“å…¥éé›¶ã€‚'
                                    : 'IIRç³»ç»Ÿ $y[n]=0.5y[n-1]+u[n]$ çš„ç¨³æ€å€¼å¯ç”± $Y_{ss}=0.5Y_{ss}+1$ æ±‚å¾—ï¼Œ$Y_{ss}=2$ã€‚'
                            };
                        }
                    }
                ]
            },

            // çŸ¥è¯†ç‚¹2: Zå˜æ¢ä¸ç³»ç»Ÿå‡½æ•°
            zTransform: {
                id: 'zTransform',
                name: 'Zå˜æ¢ä¸ç³»ç»Ÿå‡½æ•°',
                description: 'æŒæ¡Zå˜æ¢çš„å®šä¹‰ã€ç³»ç»Ÿå‡½æ•°çš„å½¢å¼åŠå…¶ç‰©ç†æ„ä¹‰',
                questionGenerators: [
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'ç¦»æ•£æ—¶é—´ä¿¡å· $x[n]$ çš„åŒè¾¹Zå˜æ¢å®šä¹‰ä¸ºï¼š',
                                options: shuffleOptions([
                                    { text: '$X(z) = \\sum_{n=-\\infty}^{\\infty} x[n]z^{-n}$', correct: true },
                                    { text: '$X(z) = \\sum_{n=0}^{\\infty} x[n]z^{-n}$', correct: false },
                                    { text: '$X(z) = \\sum_{n=-\\infty}^{\\infty} x[n]z^{n}$', correct: false },
                                    { text: '$X(z) = \\int_{-\\infty}^{\\infty} x(t)z^{-t}dt$', correct: false }
                                ]),
                                explanation: 'åŒè¾¹Zå˜æ¢çš„æ±‚å’ŒèŒƒå›´æ˜¯ä»$-\\infty$åˆ°$+\\infty$ï¼ŒæŒ‡æ•°æ˜¯$z^{-n}$ã€‚å•è¾¹Zå˜æ¢åˆ™ä»n=0å¼€å§‹ã€‚'
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            const a = (Math.random() * 0.8 + 0.1).toFixed(1);
                            return {
                                question: `å¯¹äºå› æœç³»ç»Ÿï¼Œå·®åˆ†æ–¹ç¨‹ $y[n] - ${a}y[n-1] = x[n]$ çš„ç³»ç»Ÿå‡½æ•° $H(z)$ ä¸ºï¼š`,
                                options: shuffleOptions([
                                    { text: `$H(z) = \\frac{1}{1 - ${a}z^{-1}}$`, correct: true },
                                    { text: `$H(z) = \\frac{z}{z - ${a}}$`, correct: false },
                                    { text: `$H(z) = \\frac{1 - ${a}z^{-1}}{1}$`, correct: false },
                                    { text: `$H(z) = 1 - ${a}z^{-1}$`, correct: false }
                                ]),
                                explanation: `å¯¹å·®åˆ†æ–¹ç¨‹ä¸¤è¾¹åšZå˜æ¢ï¼š$Y(z)(1-${a}z^{-1})=X(z)$ï¼Œå› æ­¤ $H(z)=Y(z)/X(z)=1/(1-${a}z^{-1})$ã€‚`
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'ç³»ç»Ÿå‡½æ•° $H(z)$ è¡¨ç¤ºçš„æ˜¯ï¼š',
                                options: shuffleOptions([
                                    { text: 'è¾“å‡ºä¿¡å·çš„Zå˜æ¢ä¸è¾“å…¥ä¿¡å·çš„Zå˜æ¢ä¹‹æ¯”', correct: true },
                                    { text: 'è¾“å…¥ä¿¡å·çš„Zå˜æ¢ä¸è¾“å‡ºä¿¡å·çš„Zå˜æ¢ä¹‹æ¯”', correct: false },
                                    { text: 'ç³»ç»Ÿå†²æ¿€å“åº”çš„æ—¶åŸŸè¡¨è¾¾å¼', correct: false },
                                    { text: 'ç³»ç»Ÿé¢‘ç‡å“åº”çš„å¹…åº¦', correct: false }
                                ]),
                                explanation: 'ç³»ç»Ÿå‡½æ•°å®šä¹‰ä¸º $H(z) = Y(z)/X(z)$ï¼Œå³è¾“å‡ºä¸è¾“å…¥çš„Zå˜æ¢ä¹‹æ¯”ã€‚å®ƒå®Œæ•´æè¿°äº†LTIç³»ç»Ÿçš„ç‰¹æ€§ã€‚'
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            const order = Math.floor(Math.random() * 2) + 2;
                            return {
                                question: `ä¸€ä¸ª${order}é˜¶çš„å·®åˆ†æ–¹ç¨‹å¯¹åº”çš„ç³»ç»Ÿå‡½æ•° $H(z)$ æ˜¯ä¸€ä¸ªä»€ä¹ˆç±»å‹çš„å‡½æ•°ï¼Ÿ`,
                                options: shuffleOptions([
                                    { text: 'æœ‰ç†å‡½æ•°ï¼ˆåˆ†å­åˆ†æ¯éƒ½æ˜¯å¤šé¡¹å¼ï¼‰', correct: true },
                                    { text: 'è¶…è¶Šå‡½æ•°', correct: false },
                                    { text: 'æŒ‡æ•°å‡½æ•°', correct: false },
                                    { text: 'å¯¹æ•°å‡½æ•°', correct: false }
                                ]),
                                explanation: 'çº¿æ€§å¸¸ç³»æ•°å·®åˆ†æ–¹ç¨‹å¯¹åº”çš„ç³»ç»Ÿå‡½æ•°éƒ½æ˜¯æœ‰ç†å‡½æ•°å½¢å¼ï¼š$H(z)=N(z)/D(z)$ï¼Œå…¶ä¸­N(z)å’ŒD(z)éƒ½æ˜¯zçš„å¤šé¡¹å¼ã€‚'
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'å¯¹äºç³»ç»Ÿ $y[n] = x[n] - x[n-2]$ï¼Œå…¶ç³»ç»Ÿå‡½æ•°ä¸ºï¼š',
                                options: shuffleOptions([
                                    { text: '$H(z) = 1 - z^{-2}$', correct: true },
                                    { text: '$H(z) = 1 + z^{-2}$', correct: false },
                                    { text: '$H(z) = z^{-2}$', correct: false },
                                    { text: '$H(z) = \\frac{1}{1-z^{-2}}$', correct: false }
                                ]),
                                explanation: 'ç›´æ¥å¯¹æ–¹ç¨‹åšZå˜æ¢ï¼š$Y(z) = X(z) - X(z)z^{-2}$ï¼Œå› æ­¤ $H(z) = 1 - z^{-2}$ã€‚'
                            };
                        }
                    }
                ]
            },

            // çŸ¥è¯†ç‚¹3: é›¶ç‚¹ä¸æç‚¹
            poleZero: {
                id: 'poleZero',
                name: 'é›¶ç‚¹ä¸æç‚¹',
                description: 'ç†è§£é›¶ç‚¹ã€æç‚¹çš„å®šä¹‰åŠå…¶åœ¨ç³»ç»Ÿåˆ†æä¸­çš„ä½œç”¨',
                questionGenerators: [
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'å¯¹äºç³»ç»Ÿå‡½æ•° $H(z) = \\frac{N(z)}{D(z)}$ï¼Œä»¥ä¸‹è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼š',
                                options: shuffleOptions([
                                    { text: '$N(z)$çš„æ ¹ç§°ä¸ºé›¶ç‚¹ï¼Œ$D(z)$çš„æ ¹ç§°ä¸ºæç‚¹', correct: true },
                                    { text: '$D(z)$çš„æ ¹ç§°ä¸ºé›¶ç‚¹ï¼Œ$N(z)$çš„æ ¹ç§°ä¸ºæç‚¹', correct: false },
                                    { text: 'é›¶ç‚¹å’Œæç‚¹éƒ½æ˜¯$N(z)$çš„æ ¹', correct: false },
                                    { text: 'é›¶ç‚¹å’Œæç‚¹éƒ½æ˜¯$D(z)$çš„æ ¹', correct: false }
                                ]),
                                explanation: 'é›¶ç‚¹ï¼ˆZerosï¼‰æ˜¯ä½¿$H(z)=0$çš„zå€¼ï¼Œå³åˆ†å­$N(z)=0$çš„æ ¹ï¼›æç‚¹ï¼ˆPolesï¼‰æ˜¯ä½¿$H(z)â†’\\infty$çš„zå€¼ï¼Œå³åˆ†æ¯$D(z)=0$çš„æ ¹ã€‚'
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            const a = (Math.random() * 0.8 + 0.1).toFixed(1);
                            return {
                                question: `ç³»ç»Ÿå‡½æ•° $H(z) = \\frac{1}{1 - ${a}z^{-1}}$ çš„æç‚¹ä½äºï¼š`,
                                options: shuffleOptions([
                                    { text: `$z = ${a}$`, correct: true },
                                    { text: `$z = -${a}$`, correct: false },
                                    { text: `$z = ${a}^{-1}$`, correct: false },
                                    { text: '$z = 0$', correct: false }
                                ]),
                                explanation: `ä»¤åˆ†æ¯ä¸º0ï¼š$1-${a}z^{-1}=0$ï¼Œå¾— $z^{-1}=${a}$ï¼Œå› æ­¤ $z=${a}$ã€‚æ³¨æ„è¦å…ˆå°†$z^{-1}$å½¢å¼è½¬æ¢ä¸ºzçš„æ­£æ¬¡å¹‚ã€‚`
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'ç³»ç»Ÿå‡½æ•° $H(z) = \\frac{z^2 - 1}{z^2 - 0.5z}$ æœ‰å‡ ä¸ªé›¶ç‚¹å’Œå‡ ä¸ªæç‚¹ï¼Ÿï¼ˆåŒ…æ‹¬z=0å¤„ï¼‰',
                                options: shuffleOptions([
                                    { text: '2ä¸ªé›¶ç‚¹ï¼Œ2ä¸ªæç‚¹', correct: true },
                                    { text: '2ä¸ªé›¶ç‚¹ï¼Œ1ä¸ªæç‚¹', correct: false },
                                    { text: '1ä¸ªé›¶ç‚¹ï¼Œ2ä¸ªæç‚¹', correct: false },
                                    { text: '0ä¸ªé›¶ç‚¹ï¼Œ2ä¸ªæç‚¹', correct: false }
                                ]),
                                explanation: 'åˆ†å­$z^2-1=(z-1)(z+1)$æœ‰2ä¸ªé›¶ç‚¹ï¼šz=1å’Œz=-1ã€‚åˆ†æ¯$z^2-0.5z=z(z-0.5)$æœ‰2ä¸ªæç‚¹ï¼šz=0å’Œz=0.5ã€‚'
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'åœ¨ä½¿ç”¨MATLABçš„<code>roots</code>å‡½æ•°æ±‚é›¶æç‚¹æ—¶ï¼Œå¦‚æœåˆ†å­åˆ†æ¯é˜¶æ¬¡ä¸åŒï¼Œå¯èƒ½ä¼šï¼š',
                                options: shuffleOptions([
                                    { text: 'å¿½ç•¥z=0å¤„çš„é›¶ç‚¹æˆ–æç‚¹', correct: true },
                                    { text: 'äº§ç”Ÿè™šå‡çš„é›¶ç‚¹', correct: false },
                                    { text: 'æ— æ³•è¿è¡Œ', correct: false },
                                    { text: 'è‡ªåŠ¨è¡¥é½é˜¶æ¬¡', correct: false }
                                ]),
                                explanation: 'è¿™å°±æ˜¯ä¸ºä»€ä¹ˆéœ€è¦<code>dpzplot</code>å‡½æ•°ï¼šå®ƒä¼šå…ˆç”¨<code>zeros</code>è¡¥é½ç³»æ•°å‘é‡é•¿åº¦ï¼Œç¡®ä¿ä¸é—æ¼z=0å¤„çš„æ ¹ã€‚'
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'åœ¨é›¶æç‚¹å›¾ï¼ˆZå¹³é¢ï¼‰ä¸Šï¼Œæç‚¹é€šå¸¸ç”¨ä»€ä¹ˆç¬¦å·è¡¨ç¤ºï¼Ÿ',
                                options: shuffleOptions([
                                    { text: 'Ã—ï¼ˆå‰å·ï¼‰', correct: true },
                                    { text: 'â—‹ï¼ˆåœ†åœˆï¼‰', correct: false },
                                    { text: 'â–¡ï¼ˆæ–¹æ¡†ï¼‰', correct: false },
                                    { text: 'â–³ï¼ˆä¸‰è§’å½¢ï¼‰', correct: false }
                                ]),
                                explanation: 'çº¦å®šä¿—æˆï¼šæç‚¹ç”¨Ã—ï¼ˆå‰å·ï¼‰è¡¨ç¤ºï¼Œé›¶ç‚¹ç”¨â—‹ï¼ˆåœ†åœˆï¼‰è¡¨ç¤ºã€‚è¿™åœ¨æ‰€æœ‰ä¿¡å·å¤„ç†æ•™æå’Œå·¥å…·ä¸­éƒ½æ˜¯ç»Ÿä¸€çš„ã€‚'
                            };
                        }
                    }
                ]
            },

            // çŸ¥è¯†ç‚¹4: ç³»ç»Ÿç¨³å®šæ€§
            stability: {
                id: 'stability',
                name: 'ç³»ç»Ÿç¨³å®šæ€§åˆ¤æ–­',
                description: 'é€šè¿‡æç‚¹ä½ç½®åˆ¤æ–­ç³»ç»Ÿçš„ç¨³å®šæ€§ã€å› æœæ€§',
                questionGenerators: [
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'ä¸€ä¸ª<strong>å› æœç¨³å®š</strong>çš„LTIç³»ç»Ÿï¼Œå…¶æ‰€æœ‰æç‚¹å¿…é¡»ï¼š',
                                options: shuffleOptions([
                                    { text: 'ä½äºå•ä½åœ†å†…ï¼ˆ$|p_k| < 1$ï¼‰', correct: true },
                                    { text: 'ä½äºå•ä½åœ†ä¸Šï¼ˆ$|p_k| = 1$ï¼‰', correct: false },
                                    { text: 'ä½äºå•ä½åœ†å¤–ï¼ˆ$|p_k| > 1$ï¼‰', correct: false },
                                    { text: 'ä½äºå®è½´ä¸Š', correct: false }
                                ]),
                                explanation: 'å› æœç¨³å®šç³»ç»Ÿçš„å……è¦æ¡ä»¶ï¼šROCåŒ…å«å•ä½åœ†ã€‚è¿™è¦æ±‚æ‰€æœ‰æç‚¹éƒ½åœ¨å•ä½åœ†å†…ã€‚æç‚¹åœ¨åœ†ä¸Šä¸ºä¸´ç•Œç¨³å®šï¼Œåœ¨åœ†å¤–åˆ™ä¸ç¨³å®šã€‚'
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            const r = (Math.random() * 0.5 + 1.2).toFixed(1); // >1
                            return {
                                question: `ç³»ç»Ÿæœ‰ä¸€ä¸ªæç‚¹ä½äº $z = ${r}$ å¤„ï¼ˆå®æ•°ï¼‰ï¼Œè¯¥ç³»ç»Ÿæ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'ä¸ç¨³å®šçš„', correct: true },
                                    { text: 'ç¨³å®šçš„', correct: false },
                                    { text: 'ä¸´ç•Œç¨³å®šçš„', correct: false },
                                    { text: 'æ— æ³•åˆ¤æ–­', correct: false }
                                ]),
                                explanation: `æç‚¹æ¨¡å€¼ $|${r}| = ${r} > 1$ï¼Œä½äºå•ä½åœ†å¤–ï¼Œå› æ­¤ç³»ç»Ÿä¸ç¨³å®šã€‚å†²æ¿€å“åº”ä¼šå‘æ•£ã€‚`
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'å¯¹äºæç‚¹æ°å¥½ä½äºå•ä½åœ†ä¸Šçš„ç³»ç»Ÿï¼ˆå¦‚ $z=1$ æˆ– $z=e^{j\\pi/4}$ï¼‰ï¼Œç³»ç»Ÿçš„å†²æ¿€å“åº”ä¼šï¼š',
                                options: shuffleOptions([
                                    { text: 'ç­‰å¹…æŒ¯è¡æˆ–æ’å®šï¼Œä¸æ”¶æ•›ä¹Ÿä¸å‘æ•£', correct: true },
                                    { text: 'æŒ‡æ•°è¡°å‡åˆ°0', correct: false },
                                    { text: 'æŒ‡æ•°å‘æ•£åˆ°æ— ç©·', correct: false },
                                    { text: 'åœ¨æœ‰é™æ—¶é—´åå˜ä¸º0', correct: false }
                                ]),
                                explanation: 'æç‚¹åœ¨å•ä½åœ†ä¸Šå¯¹åº”ä¸´ç•Œç¨³å®šï¼š$h[n] = r^n$å½“r=1æ—¶ä¸ºå¸¸æ•°ï¼›æç‚¹ä¸º$e^{j\\omega_0}$æ—¶ä¸ºç­‰å¹…æ­£å¼¦æŒ¯è¡ã€‚'
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            const r = (Math.random() * 0.8 + 0.1).toFixed(1); // <1
                            const theta = Math.floor(Math.random() * 180);
                            return {
                                question: `æç‚¹ $p = ${r}e^{j${theta}Â°}$ å¯¹åº”çš„å†²æ¿€å“åº”ç‰¹ç‚¹æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'è¡°å‡æŒ¯è¡ï¼ˆæŒ¯å¹…é€æ¸å‡å°çš„æ­£å¼¦æ³¢ï¼‰', correct: true },
                                    { text: 'ç­‰å¹…æŒ¯è¡', correct: false },
                                    { text: 'å‘æ•£æŒ¯è¡', correct: false },
                                    { text: 'å•è°ƒè¡°å‡ï¼ˆæ— æŒ¯è¡ï¼‰', correct: false }
                                ]),
                                explanation: `æ¨¡å€¼$r=${r}<1$ä½¿å“åº”è¡°å‡ï¼›è§’åº¦$${theta}Â°$ä½¿å“åº”æŒ¯è¡ã€‚ç»„åˆèµ·æ¥å°±æ˜¯è¡°å‡æŒ¯è¡ï¼Œå¸¸è§äºé˜»å°¼è°æŒ¯å™¨ã€‚`
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'ç³»ç»Ÿç¨³å®šæ€§çš„åˆ¤æ–­ä¾æ®æ˜¯ï¼š',
                                options: shuffleOptions([
                                    { text: 'å†²æ¿€å“åº”ç»å¯¹å¯å’Œï¼š$\\sum_{n=-\\infty}^{\\infty}|h[n]| < \\infty$', correct: true },
                                    { text: 'é˜¶è·ƒå“åº”æœ‰ç•Œ', correct: false },
                                    { text: 'é¢‘ç‡å“åº”æœ‰ç•Œ', correct: false },
                                    { text: 'é›¶ç‚¹éƒ½åœ¨å•ä½åœ†å†…', correct: false }
                                ]),
                                explanation: 'ç¨³å®šæ€§çš„æ•°å­¦å®šä¹‰ï¼šå†²æ¿€å“åº”ç»å¯¹å¯å’Œã€‚å¯¹äºå› æœç³»ç»Ÿï¼Œè¿™ç­‰ä»·äºROCåŒ…å«å•ä½åœ†ï¼Œå³æ‰€æœ‰æç‚¹åœ¨åœ†å†…ã€‚'
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'FIRç³»ç»Ÿï¼ˆæœ‰é™è„‰å†²å“åº”ç³»ç»Ÿï¼‰çš„ç¨³å®šæ€§å¦‚ä½•ï¼Ÿ',
                                options: shuffleOptions([
                                    { text: 'æ€»æ˜¯ç¨³å®šçš„', correct: true },
                                    { text: 'å–å†³äºç³»æ•°', correct: false },
                                    { text: 'å¯èƒ½ä¸ç¨³å®š', correct: false },
                                    { text: 'æ€»æ˜¯ä¸ç¨³å®šçš„', correct: false }
                                ]),
                                explanation: 'FIRç³»ç»Ÿçš„å†²æ¿€å“åº”åœ¨æœ‰é™æ—¶é—´åä¸º0ï¼Œå› æ­¤å¿…ç„¶ç»å¯¹å¯å’Œï¼Œæ€»æ˜¯ç¨³å®šçš„ã€‚åªæœ‰IIRç³»ç»Ÿæ‰éœ€è¦æ£€æŸ¥æç‚¹ä½ç½®ã€‚'
                            };
                        }
                    }
                ]
            },

            // çŸ¥è¯†ç‚¹5: ROCä¸ç³»ç»Ÿç‰¹æ€§
            roc: {
                id: 'roc',
                name: 'ROCï¼ˆæ”¶æ•›åŸŸï¼‰ä¸ç³»ç»Ÿç‰¹æ€§',
                description: 'ç†è§£æ”¶æ•›åŸŸçš„æ¦‚å¿µåŠå…¶ä¸å› æœæ€§ã€ç¨³å®šæ€§çš„å…³ç³»',
                questionGenerators: [
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'ROCï¼ˆRegion of Convergenceï¼‰æ˜¯æŒ‡ï¼š',
                                options: shuffleOptions([
                                    { text: 'Zå˜æ¢æ”¶æ•›çš„zå€¼é›†åˆ', correct: true },
                                    { text: 'ç³»ç»Ÿå‡½æ•°çš„é›¶ç‚¹é›†åˆ', correct: false },
                                    { text: 'ç³»ç»Ÿå‡½æ•°çš„æç‚¹é›†åˆ', correct: false },
                                    { text: 'é¢‘ç‡å“åº”çš„èŒƒå›´', correct: false }
                                ]),
                                explanation: 'ROCæ˜¯ä½¿Zå˜æ¢çº§æ•°æ”¶æ•›çš„æ‰€æœ‰zå€¼çš„é›†åˆã€‚ä¸åŒçš„ROCå¯¹åº”ä¸åŒçš„æ—¶åŸŸä¿¡å·ï¼ˆå³ä½¿ç³»ç»Ÿå‡½æ•°ä»£æ•°å½¢å¼ç›¸åŒï¼‰ã€‚'
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'å¯¹äº<strong>å› æœ</strong>ç³»ç»Ÿï¼ŒROCå¿…é¡»æ˜¯ï¼š',
                                options: shuffleOptions([
                                    { text: 'æŸä¸ªåœ†çš„å¤–éƒ¨ï¼ˆåŒ…æ‹¬æ— ç©·è¿œç‚¹ï¼‰', correct: true },
                                    { text: 'æŸä¸ªåœ†çš„å†…éƒ¨', correct: false },
                                    { text: 'å•ä½åœ†', correct: false },
                                    { text: 'æ•´ä¸ªzå¹³é¢', correct: false }
                                ]),
                                explanation: 'å› æœä¿¡å·ï¼ˆ$h[n]=0, n<0$ï¼‰çš„ROCæ˜¯æŸä¸ªåœ†çš„å¤–éƒ¨ï¼Œåœ†çš„åŠå¾„ç”±æœ€å¤–ä¾§æç‚¹çš„æ¨¡å€¼å†³å®šã€‚'
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'ç³»ç»Ÿ<strong>ç¨³å®š</strong>çš„å……è¦æ¡ä»¶æ˜¯ROCï¼š',
                                options: shuffleOptions([
                                    { text: 'åŒ…å«å•ä½åœ†', correct: true },
                                    { text: 'ä¸åŒ…å«å•ä½åœ†', correct: false },
                                    { text: 'å°±æ˜¯å•ä½åœ†', correct: false },
                                    { text: 'åŒ…å«åŸç‚¹', correct: false }
                                ]),
                                explanation: 'ç¨³å®šæ€§è¦æ±‚é¢‘ç‡å“åº”$H(e^{j\\omega})$å­˜åœ¨ï¼Œå³$z=e^{j\\omega}$ï¼ˆå•ä½åœ†ï¼‰å¿…é¡»åœ¨ROCå†…ã€‚'
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            const r = (Math.random() * 0.8 + 0.2).toFixed(1);
                            return {
                                question: `ç³»ç»Ÿå‡½æ•° $H(z)=\\frac{1}{1-${r}z^{-1}}$ çš„å› æœç³»ç»Ÿå¯¹åº”çš„ROCæ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: `$|z| > ${r}$`, correct: true },
                                    { text: `$|z| < ${r}$`, correct: false },
                                    { text: `$|z| = ${r}$`, correct: false },
                                    { text: 'æ•´ä¸ªzå¹³é¢', correct: false }
                                ]),
                                explanation: `æç‚¹åœ¨$z=${r}$ã€‚å› æœç³»ç»ŸROCæ˜¯æœ€å¤–ä¾§æç‚¹ä¹‹å¤–ï¼Œå³$|z|>${r}$ã€‚æ­¤ROCåŒ…å«å•ä½åœ†ï¼ˆå› ä¸º${r}<1ï¼‰ï¼Œæ‰€ä»¥ç³»ç»Ÿç¨³å®šã€‚`
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'ä¸¤ä¸ªä¸åŒçš„æ—¶åŸŸåºåˆ—å¯èƒ½æœ‰ç›¸åŒçš„ç³»ç»Ÿå‡½æ•°ä»£æ•°å½¢å¼ï¼Œå®ƒä»¬çš„åŒºåˆ«åœ¨äºï¼š',
                                options: shuffleOptions([
                                    { text: 'ROCä¸åŒ', correct: true },
                                    { text: 'é›¶ç‚¹ä½ç½®ä¸åŒ', correct: false },
                                    { text: 'æç‚¹ä½ç½®ä¸åŒ', correct: false },
                                    { text: 'å¢ç›Šä¸åŒ', correct: false }
                                ]),
                                explanation: 'ä¾‹å¦‚$H(z)=1/(1-0.5z^{-1})$ï¼ŒROCä¸º$|z|>0.5$æ—¶å¯¹åº”å› æœåºåˆ—ï¼›ROCä¸º$|z|<0.5$æ—¶å¯¹åº”åå› æœåºåˆ—ã€‚'
                            };
                        }
                    }
                ]
            },

            // çŸ¥è¯†ç‚¹6: ç³»ç»Ÿå“åº”ç‰¹æ€§
            systemResponse: {
                id: 'systemResponse',
                name: 'ç³»ç»Ÿå“åº”ç‰¹æ€§',
                description: 'ç†è§£å†²æ¿€å“åº”ã€é˜¶è·ƒå“åº”ä¸ç³»ç»Ÿå‚æ•°çš„å…³ç³»',
                questionGenerators: [
                    {
                        type: 'single',
                        generate: () => {
                            const r = (Math.random() * 0.8 + 0.1).toFixed(1);
                            return {
                                question: `å•æç‚¹ç³»ç»Ÿ $H(z) = \\frac{1}{1-${r}z^{-1}}$ çš„å†²æ¿€å“åº”ä¸ºï¼š`,
                                options: shuffleOptions([
                                    { text: `$h[n] = ${r}^n u[n]$`, correct: true },
                                    { text: `$h[n] = ${r}^{-n} u[n]$`, correct: false },
                                    { text: `$h[n] = (${r})^n u[-n]$`, correct: false },
                                    { text: `$h[n] = \\delta[n]$`, correct: false }
                                ]),
                                explanation: `å¯¹ $H(z)=1/(1-${r}z^{-1})$ åšåZå˜æ¢ï¼Œå¾—åˆ° $h[n]=${r}^n u[n]$ã€‚è¿™æ˜¯ä¸€ä¸ªæŒ‡æ•°è¡°å‡åºåˆ—ï¼ˆå› ä¸º${r}<1ï¼‰ã€‚`
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'å¯¹äºç¨³å®šçš„IIRç³»ç»Ÿï¼Œå½“è¾“å…¥ä¸ºå•ä½é˜¶è·ƒ$u[n]$æ—¶ï¼Œè¾“å‡ºçš„ç¨³æ€å€¼å¯ä»¥é€šè¿‡ä»€ä¹ˆæ–¹æ³•å¿«é€Ÿè®¡ç®—ï¼Ÿ',
                                options: shuffleOptions([
                                    { text: 'ä»¤ $Y_{ss} = aY_{ss} + 1$ æ±‚è§£ï¼ˆaä¸ºåé¦ˆç³»æ•°ï¼‰', correct: true },
                                    { text: 'è®¡ç®—å‰100ä¸ªç‚¹çš„å¹³å‡å€¼', correct: false },
                                    { text: 'ç›´æ¥ç­‰äºç³»ç»Ÿå¢ç›Š', correct: false },
                                    { text: 'æ— æ³•é¢„æµ‹', correct: false }
                                ]),
                                explanation: 'ç¨³æ€æ—¶$y[n]=y[n-1]=Y_{ss}$ï¼Œä»£å…¥å·®åˆ†æ–¹ç¨‹å¯æ±‚å‡ºç¨³æ€å€¼ã€‚ä¾‹å¦‚$y[n]=0.8y[n-1]+u[n]$ï¼Œåˆ™$Y_{ss}=0.8Y_{ss}+1$ï¼Œå¾—$Y_{ss}=5$ã€‚'
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'FIRç³»ç»Ÿå¯¹å•ä½é˜¶è·ƒè¾“å…¥çš„å“åº”ç‰¹ç‚¹æ˜¯ï¼š',
                                options: shuffleOptions([
                                    { text: 'åœ¨æœ‰é™æ—¶é—´åè¾¾åˆ°ç¨³æ€ï¼ˆå˜ä¸ºå¸¸æ•°ï¼‰', correct: true },
                                    { text: 'æŒç»­å¢é•¿', correct: false },
                                    { text: 'æŒ¯è¡', correct: false },
                                    { text: 'é€æ¸è¡°å‡åˆ°0', correct: false }
                                ]),
                                explanation: 'FIRç³»ç»Ÿå¦‚$y[n]=0.5x[n]+x[n-1]$å¯¹é˜¶è·ƒè¾“å…¥ï¼šy[0]=0.5, y[1]=1.5, y[nâ‰¥1]=1.5ã€‚è®°å¿†é•¿åº¦æœ‰é™å¯¼è‡´å¿«é€Ÿç¨³å®šã€‚'
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            const theta = Math.floor(Math.random() * 180);
                            return {
                                question: `æç‚¹ $p=e^{j${theta}Â°}$ï¼ˆåœ¨å•ä½åœ†ä¸Šï¼‰å¯¹åº”çš„å†²æ¿€å“åº”æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: `é¢‘ç‡ä¸º${theta}Â°çš„ç­‰å¹…æ­£å¼¦æŒ¯è¡`, correct: true },
                                    { text: 'è¡°å‡æŒ¯è¡', correct: false },
                                    { text: 'å‘æ•£æŒ¯è¡', correct: false },
                                    { text: 'æ’å®šå¸¸æ•°', correct: false }
                                ]),
                                explanation: `æç‚¹åœ¨å•ä½åœ†ä¸Šä¸”ä¸ºå¤æ•°æ—¶ï¼Œ$h[n]=\\cos(${theta}Â°n)$ï¼Œäº§ç”ŸæŒç»­çš„ç­‰å¹…æŒ¯è¡ã€‚è¿™å°±æ˜¯æ•°å­—è°æŒ¯å™¨çš„åŸç†ã€‚`
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: 'ç³»ç»Ÿ $y[n] = ay[n-1] + x[n]$ åœ¨åˆå§‹æ¡ä»¶ $y[-1] \\neq 0$ æ—¶ï¼š',
                                options: shuffleOptions([
                                    { text: 'ä¸æ»¡è¶³çº¿æ€§ç³»ç»Ÿçš„é›¶çŠ¶æ€ç‰¹æ€§ï¼ˆå› ä¸ºæœ‰åˆå§‹çŠ¶æ€çš„å½±å“ï¼‰', correct: true },
                                    { text: 'ä»ç„¶æ˜¯çº¿æ€§ç³»ç»Ÿ', correct: false },
                                    { text: 'å˜æˆéçº¿æ€§ç³»ç»Ÿ', correct: false },
                                    { text: 'æ— æ³•è¿è¡Œ', correct: false }
                                ]),
                                explanation: 'éé›¶åˆå§‹æ¡ä»¶ç ´åäº†é›¶è¾“å…¥é›¶è¾“å‡ºçš„ç‰¹æ€§ã€‚çº¿æ€§ç³»ç»Ÿè¦æ±‚é›¶çŠ¶æ€ï¼ˆæ‰€æœ‰åˆå§‹æ¡ä»¶ä¸º0ï¼‰ã€‚è¿™å°±æ˜¯ç»ƒä¹ å››ä»»åŠ¡ä¸‰çš„æ ¸å¿ƒæ¦‚å¿µã€‚'
                            };
                        }
                    },
                    {
                        type: 'single',
                        generate: () => {
                            const a = (Math.random() * 0.9 + 0.1).toFixed(1);
                            return {
                                question: `å¯¹äºç¨³å®šç³»ç»Ÿ $y[n]=${a}y[n-1]+x[n]$ï¼Œä¸åŒçš„åˆå§‹æ¡ä»¶$y[-1]$å¯¹æœ€ç»ˆç¨³æ€è¾“å‡ºçš„å½±å“æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'åˆå§‹æ¡ä»¶çš„å½±å“ä¼šé€æ¸æ¶ˆå¤±ï¼Œæœ€ç»ˆè¶‹äºç›¸åŒç¨³æ€', correct: true },
                                    { text: 'åˆå§‹æ¡ä»¶çš„å½±å“æ°¸è¿œå­˜åœ¨', correct: false },
                                    { text: 'åˆå§‹æ¡ä»¶è¶Šå¤§ï¼Œç¨³æ€å€¼è¶Šå¤§', correct: false },
                                    { text: 'æ— æ³•é¢„æµ‹', correct: false }
                                ]),
                                explanation: `å› ä¸º$${a}<1$ï¼Œåˆå§‹çŠ¶æ€å“åº”$${a}^n y[-1]$ä¼šè¡°å‡åˆ°0ã€‚ç¨³å®šç³»ç»Ÿä¼š"å¿˜è®°"åˆå§‹æ¡ä»¶ï¼Œè¿™æ˜¯ç¨³å®šæ€§çš„é‡è¦ä½“ç°ã€‚`
                            };
                        }
                    }
                ]
            }
        };

        // ==================== å·¥å…·å‡½æ•° ====================
        function shuffleArray(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function shuffleOptions(options) {
            const correctOption = options.find(opt => opt.correct);
            const shuffled = shuffleArray(options);
            // è¿”å›æ‰“ä¹±åçš„é€‰é¡¹ï¼Œå¹¶è®°å½•æ­£ç¡®ç­”æ¡ˆçš„æ–°ç´¢å¼•
            const correctIndex = shuffled.findIndex(opt => opt.correct);
            return {
                options: shuffled,
                correctIndex: correctIndex
            };
        }

        // ==================== å­¦ç”Ÿæ•°æ®ç®¡ç† ====================
        let studentData = {
            id: '',
            name: '',
            currentTopicIndex: 0,
            topicStats: {},
            startTime: null
        };

        const topics = Object.values(knowledgeBase);

        function initializeStats() {
            topics.forEach(topic => {
                studentData.topicStats[topic.id] = {
                    attempts: 0,
                    correct: 0,
                    questions: []
                };
            });
        }

        // ==================== ä¸»æµç¨‹å‡½æ•° ====================
        function startQuiz() {
            const id = document.getElementById('studentId').value.trim();
            const name = document.getElementById('studentName').value.trim();
            
            if (!id || !name) {
                alert('è¯·å¡«å†™å­¦å·å’Œå§“åï¼');
                return;
            }

            studentData.id = id;
            studentData.name = name;
            studentData.startTime = new Date();
            initializeStats();

            document.querySelector('.login-section').classList.remove('active');
            document.querySelector('.quiz-section').classList.add('active');
            
            document.getElementById('studentInfo').innerHTML = 
                `<strong>å­¦å·ï¼š</strong>${id} &nbsp;&nbsp; <strong>å§“åï¼š</strong>${name}`;
            
            loadQuestion();
        }

        function loadQuestion() {
            if (studentData.currentTopicIndex >= topics.length) {
                showResults();
                return;
            }

            const currentTopic = topics[studentData.currentTopicIndex];
            const stats = studentData.topicStats[currentTopic.id];
            
            // éšæœºé€‰æ‹©ä¸€ä¸ªé¢˜ç›®ç”Ÿæˆå™¨
            const generator = currentTopic.questionGenerators[
                Math.floor(Math.random() * currentTopic.questionGenerators.length)
            ];
            
            // ç”Ÿæˆé¢˜ç›®
            const questionData = generator.generate();
            
            // ä¿å­˜é¢˜ç›®æ•°æ®
            const question = {
                type: generator.type,
                question: questionData.question,
                options: questionData.options.options,
                correct: questionData.options.correctIndex,
                explanation: questionData.explanation,
                answered: false,
                isCorrect: false
            };
            
            stats.questions.push(question);

            // æ›´æ–°è¿›åº¦
            const progress = ((studentData.currentTopicIndex / topics.length) * 100).toFixed(0);
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressBar').textContent = progress + '%';

            // æ˜¾ç¤ºå½“å‰çŸ¥è¯†ç‚¹
            document.getElementById('currentTopic').innerHTML = `
                <div class="topic-name">ğŸ“š ${currentTopic.name}</div>
                <div class="topic-progress">çŸ¥è¯†ç‚¹ ${studentData.currentTopicIndex + 1}/${topics.length} | ${currentTopic.description}</div>
            `;

            // æ˜¾ç¤ºé¢˜ç›®
            const questionNum = stats.questions.length;
            document.getElementById('questionTitle').innerHTML = 
                `<span class="question-number">ç¬¬ ${questionNum} é¢˜</span>${questionData.question}`;
            
            document.getElementById('questionContent').innerHTML = '';

            // ç”Ÿæˆé€‰é¡¹
            let optionsHTML = '';
            if (generator.type === 'single') {
                question.options.forEach((opt, index) => {
                    optionsHTML += `
                        <div class="option" data-index="${index}" onclick="selectOption(${index})">
                            ${String.fromCharCode(65 + index)}. ${opt.text}
                        </div>
                    `;
                });
            } else {
                question.options.forEach((opt, index) => {
                    optionsHTML += `
                        <div class="checkbox-option" onclick="toggleCheckbox(${index})">
                            <input type="checkbox" id="opt${index}">
                            <label for="opt${index}">${String.fromCharCode(65 + index)}. ${opt.text}</label>
                        </div>
                    `;
                });
            }

            document.getElementById('options').innerHTML = optionsHTML;
            document.getElementById('feedback').innerHTML = '';
            document.getElementById('submitBtn').style.display = 'inline-block';
            document.getElementById('nextBtn').style.display = 'none';

            // é‡æ–°æ¸²æŸ“æ•°å­¦å…¬å¼
            if (typeof MathJax !== 'undefined') {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            }
        }

        function selectOption(index) {
            document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            document.querySelectorAll('.option')[index].classList.add('selected');
        }

        function toggleCheckbox(index) {
            const checkbox = document.getElementById(`opt${index}`);
            checkbox.checked = !checkbox.checked;
        }

        function submitAnswer() {
            const currentTopic = topics[studentData.currentTopicIndex];
            const stats = studentData.topicStats[currentTopic.id];
            const question = stats.questions[stats.questions.length - 1];
            
            let selectedAnswers, isCorrect;

            if (question.type === 'single') {
                const selected = document.querySelector('.option.selected');
                if (!selected) {
                    alert('è¯·é€‰æ‹©ä¸€ä¸ªç­”æ¡ˆï¼');
                    return;
                }
                
                selectedAnswers = parseInt(selected.getAttribute('data-index'));
                isCorrect = selectedAnswers === question.correct;

                // æ˜¾ç¤ºæ­£ç¡®/é”™è¯¯
                document.querySelectorAll('.option').forEach((opt, idx) => {
                    if (idx === question.correct) {
                        opt.classList.add('correct');
                    } else if (idx === selectedAnswers && !isCorrect) {
                        opt.classList.add('incorrect');
                    }
                    opt.style.pointerEvents = 'none';
                });
            } else {
                selectedAnswers = [];
                document.querySelectorAll('input[type="checkbox"]').forEach((cb, idx) => {
                    if (cb.checked) selectedAnswers.push(idx);
                });
                
                if (selectedAnswers.length === 0) {
                    alert('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªç­”æ¡ˆï¼');
                    return;
                }

                isCorrect = selectedAnswers.length === question.correct.length && 
                           selectedAnswers.every(ans => question.correct.includes(ans));

                document.querySelectorAll('.checkbox-option').forEach((opt, idx) => {
                    if (question.correct.includes(idx)) {
                        opt.classList.add('correct');
                    } else if (selectedAnswers.includes(idx)) {
                        opt.classList.add('incorrect');
                    }
                    opt.style.pointerEvents = 'none';
                });
            }

            // æ›´æ–°ç»Ÿè®¡
            stats.attempts++;
            question.answered = true;
            question.isCorrect = isCorrect;
            if (isCorrect) stats.correct++;

            // æ˜¾ç¤ºåé¦ˆ
            const feedbackDiv = document.getElementById('feedback');
            feedbackDiv.innerHTML = `
                <div class="feedback ${isCorrect ? 'correct' : 'incorrect'}">
                    ${isCorrect ? 'âœ… å›ç­”æ­£ç¡®ï¼' : 'âŒ å›ç­”é”™è¯¯ï¼Œè¯·ç»§ç»­ç»ƒä¹ ï¼'}
                    <div class="explanation-detail">${question.explanation}</div>
                </div>
            `;

            document.getElementById('submitBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'inline-block';
            
            if (isCorrect) {
                document.getElementById('nextBtn').textContent = 
                    studentData.currentTopicIndex < topics.length - 1 ? 'è¿›å…¥ä¸‹ä¸€çŸ¥è¯†ç‚¹ â†’' : 'æŸ¥çœ‹ç»“æœ â†’';
            } else {
                document.getElementById('nextBtn').textContent = 'ç»§ç»­ç»ƒä¹ æ­¤çŸ¥è¯†ç‚¹ â†’';
            }

            // é‡æ–°æ¸²æŸ“æ•°å­¦å…¬å¼
            if (typeof MathJax !== 'undefined') {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            }
        }

        function nextQuestion() {
            const lastQuestion = studentData.topicStats[topics[studentData.currentTopicIndex].id]
                .questions.slice(-1)[0];
            
            if (lastQuestion.isCorrect) {
                // ç­”å¯¹äº†ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªçŸ¥è¯†ç‚¹
                studentData.currentTopicIndex++;
                if (studentData.currentTopicIndex >= topics.length) {
                    showResults();
                } else {
                    loadQuestion();
                }
            } else {
                // ç­”é”™äº†ï¼Œç»§ç»­å½“å‰çŸ¥è¯†ç‚¹
                loadQuestion();
            }
        }

        function showResults() {
            document.querySelector('.quiz-section').classList.remove('active');
            document.querySelector('.result-section').classList.add('active');

            const endTime = new Date();
            const duration = Math.round((endTime - studentData.startTime) / 1000 / 60); // åˆ†é’Ÿ

            let reportHTML = `
                <div style="text-align: center; margin-bottom: 30px; padding: 20px; background: linear-gradient(135deg, #e8f5ff 0%, #f0f9ff 100%); border-radius: 10px;">
                    <h2 style="color: #608de0;">ğŸ‰ ${studentData.name} åŒå­¦</h2>
                    <p style="color: #666; font-size: 1.1em; margin: 10px 0;">å­¦å·ï¼š${studentData.id}</p>
                    <p style="color: #666;">ç”¨æ—¶ï¼š${duration} åˆ†é’Ÿ</p>
                </div>

                <table class="stats-table">
                    <tr>
                        <th>çŸ¥è¯†ç‚¹</th>
                        <th>ç­”é¢˜æ¬¡æ•°</th>
                        <th>æŒæ¡ç¨‹åº¦</th>
                    </tr>
            `;

            let excellentTopics = [], goodTopics = [], fairTopics = [], poorTopics = [];

            topics.forEach(topic => {
                const stats = studentData.topicStats[topic.id];
                let mastery, masteryClass;

                if (stats.attempts === 1) {
                    mastery = 'ä¼˜ç§€ â­â­â­â­';
                    masteryClass = 'mastery-excellent';
                    excellentTopics.push(topic.name);
                } else if (stats.attempts === 2) {
                    mastery = 'è‰¯å¥½ â­â­â­';
                    masteryClass = 'mastery-good';
                    goodTopics.push(topic.name);
                } else if (stats.attempts <= 4) {
                    mastery = 'ä¸€èˆ¬ â­â­';
                    masteryClass = 'mastery-fair';
                    fairTopics.push(topic.name);
                } else {
                    mastery = 'éœ€åŠ å¼º â­';
                    masteryClass = 'mastery-poor';
                    poorTopics.push(topic.name);
                }

                reportHTML += `
                    <tr>
                        <td><strong>${topic.name}</strong></td>
                        <td>${stats.attempts} æ¬¡</td>
                        <td class="${masteryClass}">${mastery}</td>
                    </tr>
                `;
            });

            reportHTML += '</table>';

            // çŸ¥è¯†æŒæ¡åˆ†æ
            reportHTML += '<div style="margin-top: 30px;"><h3 style="color: #2d57a4;">ğŸ“Š çŸ¥è¯†æŒæ¡åˆ†æ</h3>';

            if (excellentTopics.length > 0) {
                reportHTML += `
                    <div style="background: #e8f5e9; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 5px solid #5ca353;">
                        <strong style="color: #5ca353;">âœ… æŒæ¡ä¼˜ç§€ï¼ˆä¸€æ¬¡é€šè¿‡ï¼‰ï¼š</strong><br>
                        ${excellentTopics.join('ã€')}
                    </div>
                `;
            }

            if (goodTopics.length > 0) {
                reportHTML += `
                    <div style="background: #e8f5ff; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 5px solid #608de0;">
                        <strong style="color: #608de0;">ğŸ‘ æŒæ¡è‰¯å¥½ï¼ˆä¸¤æ¬¡é€šè¿‡ï¼‰ï¼š</strong><br>
                        ${goodTopics.join('ã€')}
                    </div>
                `;
            }

            if (fairTopics.length > 0) {
                reportHTML += `
                    <div style="background: #fff8e1; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 5px solid #D46A6A;">
                        <strong style="color: #D46A6A;">âš ï¸ éœ€è¦å·©å›ºï¼ˆ3-4æ¬¡é€šè¿‡ï¼‰ï¼š</strong><br>
                        ${fairTopics.join('ã€')}
                    </div>
                `;
            }

            if (poorTopics.length > 0) {
                reportHTML += `
                    <div style="background: #ffebee; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 5px solid #912d32;">
                        <strong style="color: #912d32;">âŒ é‡ç‚¹åŠ å¼ºï¼ˆ5æ¬¡ä»¥ä¸Šï¼‰ï¼š</strong><br>
                        ${poorTopics.join('ã€')}
                        <p style="margin-top: 10px; font-size: 0.9em;">å»ºè®®ï¼šé‡æ–°å­¦ä¹ ç›¸å…³ç†è®ºï¼Œå¤šåšç»ƒä¹ ã€‚</p>
                    </div>
                `;
            }

            reportHTML += '</div>';

            document.getElementById('finalReport').innerHTML = reportHTML;
        }

        function saveScreenshot() {
            const button = document.getElementById('saveBtn');
            button.disabled = true;
            button.textContent = 'â³ æ­£åœ¨ç”Ÿæˆ...';

            html2canvas(document.body, {
                backgroundColor: '#ffffff',
                scale: 2,
                logging: false
            }).then(canvas => {
                canvas.toBlob(blob => {
                    const cleanId = studentData.id.replace(/[^a-zA-Z0-9_\u4e00-\u9fa5-]/g, '_');
                    const cleanName = studentData.name.replace(/[^a-zA-Z0-9_\u4e00-\u9fa5-]/g, '_');
                    const timestamp = new Date().toISOString().slice(0, 10);
                    const filename = `DSP_Lab2_${cleanId}_${cleanName}_${timestamp}.png`;

                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);

                    button.disabled = false;
                    button.textContent = 'âœ… ä¿å­˜æˆåŠŸ';
                    setTimeout(() => {
                        button.textContent = 'ğŸ’¾ å†æ¬¡ä¿å­˜';
                    }, 2000);
                }, 'image/png');
            }).catch(error => {
                console.error('æˆªå›¾å¤±è´¥:', error);
                alert('æˆªå›¾å¤±è´¥ï¼Œè¯·å°è¯•ä½¿ç”¨æµè§ˆå™¨çš„æˆªå›¾åŠŸèƒ½');
                button.disabled = false;
                button.textContent = 'ğŸ’¾ ä¿å­˜æŠ¥å‘Š';
            });
        }
    </script>

    <!-- MathJax åŠ è½½è„šæœ¬ -->
    <script>
        (function() {
            const statusDiv = document.getElementById('mathjaxStatus');
            const primaryCDN = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
            const backupCDN = 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML';

            function loadScript(src, onload, onerror) {
                const script = document.createElement('script');
                script.src = src;
                script.async = true;
                script.onload = onload;
                script.onerror = onerror;
                document.head.appendChild(script);
            }

            function onMathJaxLoad() {
                statusDiv.textContent = 'âœ“ æ•°å­¦å…¬å¼åŠ è½½æˆåŠŸ';
                statusDiv.className = 'mathjax-status success';
            }

            loadScript(primaryCDN, onMathJaxLoad, function() {
                statusDiv.textContent = 'ä¸»CDNåŠ è½½å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨...';
                loadScript(backupCDN, onMathJaxLoad, function() {
                    statusDiv.textContent = 'âŒ å…¬å¼åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ';
                    statusDiv.className = 'mathjax-status';
                });
            });
        })();
    </script>
</body>
</html>