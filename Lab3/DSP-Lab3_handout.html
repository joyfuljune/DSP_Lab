<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 3 - FIRæ»¤æ³¢å™¨è®¾è®¡ (ä¿®è®¢ç‰ˆ)</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: { inlineMath: [['$','$']], displayMath: [['$$','$$']], processEscapes: true },
            CommonHTML: { scale: 110 }, "HTML-CSS": { scale: 110 }
        });
    </script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Microsoft YaHei', Arial, sans-serif; line-height: 1.8; color: #2c3e50; background: linear-gradient(135deg, #608de0 0%, #7dadff 50%, #5ca353 100%); padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 15px 50px rgba(0,0,0,0.25); overflow: hidden; }
        header { background: linear-gradient(135deg, #2d57a4 0%, #608de0 100%); color: white; padding: 50px 40px; text-align: center; border-bottom: 5px solid #7dadff; }
        header h1 { font-size: 2.5em; margin-bottom: 15px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        header .subtitle { font-size: 1.1em; opacity: 0.95; margin-top: 10px; }
        header .institution { font-size: 0.95em; margin-top: 15px; opacity: 0.9; border-top: 2px solid rgba(255,255,255,0.3); padding-top: 15px; }
        nav { background: #f5f7fa; padding: 20px 40px; display: flex; gap: 15px; flex-wrap: wrap; justify-content: center; border-bottom: 3px solid #7dadff; }
        nav a { color: #2d57a4; text-decoration: none; padding: 10px 20px; border-radius: 25px; font-size: 0.95em; font-weight: 500; background: white; border: 2px solid #7dadff; transition: all 0.3s; }
        nav a:hover { background: #7dadff; color: white; transform: translateY(-2px); }
        .content { padding: 50px; }
        section { margin-bottom: 60px; }
        h2 { color: #2d57a4; font-size: 2em; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 4px solid #7dadff; }
        h3 { color: #608de0; font-size: 1.6em; margin: 30px 0 20px 0; }
        h4 { color: #2d57a4; font-size: 1.3em; margin: 25px 0 15px 0; }
        p { margin-bottom: 15px; text-align: justify; line-height: 1.9; }
        code { background-color: #e8eef8; color: #2d57a4; padding: 2px 6px; border-radius: 4px; font-family: Consolas, monospace; font-size: 0.95em; }
        .tip-box { background: linear-gradient(135deg, #e8f5e9 0%, #f1f8f4 100%); border-left: 5px solid #5ca353; padding: 18px; margin: 20px 0; border-radius: 8px; }
        .warning-box { background: linear-gradient(135deg, #ffebee 0%, #fff5f7 100%); border-left: 5px solid #912d32; padding: 18px; margin: 20px 0; border-radius: 8px; }
        .analysis-box { background: #fff8e1; border-left: 5px solid #fbc02d; padding: 20px; margin: 25px 0; border-radius: 8px; }
        .analysis-box h4 { color: #c77700; margin-top: 0; }
        .formula-box { background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%); border-left: 5px solid #608de0; padding: 18px 25px; margin: 15px 0; border-radius: 8px; }
        .exercise-box { background: linear-gradient(135deg, #f0f7ff 0%, #f5f9ff 100%); border: 3px solid #7dadff; border-radius: 12px; padding: 30px; margin: 30px 0; }
        .exercise-box h3 { color: #2d57a4; margin-top: 0; margin-bottom: 25px; }
        .question-item { margin: 20px 0; padding-left: 15px; }
        .question-item h4 { color: #608de0; font-size: 1.2em; margin-top: 20px; border-left: 4px solid #7dadff; padding-left: 10px; }
        .code-block { background: #2b2b2b; color: #d4d4d4; padding: 25px; border-radius: 10px; margin: 25px 0; overflow-x: auto; font-family: Consolas, monospace; line-height: 1.7; position: relative; border: 2px solid #608de0; }
        .code-block::before { content: 'MATLAB'; position: absolute; top: 8px; right: 15px; color: #7dadff; font-size: 0.85em; font-weight: bold; }
        .code-block code { background: none; color: inherit; padding: 0; }
        .code-line { display: block; }
        .code-comment { color: #6a9955; }
        .code-keyword { color: #569cd6; }
        .code-string { color: #ce9178; }
        .code-number { color: #b5cea8; }
        .plot-container { background: #fdfdfd; border-radius: 10px; padding: 20px; margin: 25px 0; box-shadow: 0 3px 12px rgba(0,0,0,0.1); border: 1px solid #e0e6f0; text-align: center; }
        .plot-container h4 { margin-top: 0; margin-bottom: 15px; text-align: center; color: #2d57a4; }
        ul, ol { margin-left: 30px; margin-bottom: 20px; }
        li { margin-bottom: 10px; line-height: 1.8; }
        table { width: 100%; border-collapse: collapse; margin: 25px 0; background: white; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden; }
        th { background: linear-gradient(135deg, #2d57a4 0%, #608de0 100%); color: white; padding: 15px; text-align: left; }
        td { padding: 12px 15px; border-bottom: 1px solid #e0e0e0; }
        tr:hover { background: #f5f7fa; }
        .badge { display: inline-block; padding: 6px 14px; border-radius: 20px; font-size: 0.85em; font-weight: bold; margin-right: 10px; }
        .badge-theory { background: #608de0; color: white; }
        .badge-practice { background: #5ca353; color: white; }
        strong { color: #2d57a4; font-weight: 600; }
        footer { background: linear-gradient(135deg, #2d57a4 0%, #113a85 100%); color: white; text-align: center; padding: 30px; }
        .data-box { background: linear-gradient(135deg, #e3f2fd 0%, #f3f8ff 100%); border-left: 5px solid #2196f3; padding: 18px; margin: 20px 0; border-radius: 8px; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>å®éªŒä¸‰ - FIRæ»¤æ³¢å™¨è®¾è®¡</h1>
            <div class="subtitle">æ•°å­—ä¿¡å·å¤„ç† | çª—å‡½æ•°æ³•ä¸çº¿æ€§ç›¸ä½æ»¤æ³¢å™¨</div>
            <div class="institution">å—äº¬å·¥ä¸šå¤§å­¦æµ¦æ±Ÿå­¦é™¢ | è®¡ç®—æœºä¸é€šä¿¡å·¥ç¨‹å­¦é™¢ | é€šä¿¡å·¥ç¨‹ä¸“ä¸š | DSPè¯¾ç¨‹å®éªŒ</div>
        </header>

        <nav>
            <a href="#objective">å®éªŒç›®çš„</a>
            <a href="#theory">ç†è®ºåŸºç¡€</a>
            <a href="#exercise1">ç»ƒä¹ ä¸€</a>
            <a href="#exercise2">ç»ƒä¹ äºŒ</a>
            <a href="#exercise3">ç»ƒä¹ ä¸‰</a>
            <a href="#exercise4">ç»ƒä¹ å››</a>
        </nav>

        <div class="content">
            <!-- å®éªŒç›®çš„ -->
            <section id="objective">
                <h2><span class="badge badge-theory">ç†è®º</span>å®éªŒç›®çš„</h2>
                <ul>
                    <li>ç†è§£ FIR æ»¤æ³¢å™¨çš„åŸºæœ¬åŸç†å’Œç‰¹æ€§</li>
                    <li>æŒæ¡<strong>çº¿æ€§ç›¸ä½</strong>æ»¤æ³¢å™¨çš„è®¾è®¡æ–¹æ³•å’Œå››ç§ç±»å‹</li>
                    <li>å­¦ä¹ <strong>çª—å‡½æ•°æ³•</strong>è®¾è®¡ FIR æ»¤æ³¢å™¨</li>
                    <li>ä½¿ç”¨ MATLAB å‡½æ•°ï¼ˆ<code>fir1</code>ã€<code>freqz</code>ç­‰ï¼‰è¿›è¡Œæ»¤æ³¢å™¨è®¾è®¡å’Œåˆ†æ</li>
                    <li>åº”ç”¨ FIR æ»¤æ³¢å™¨è¿›è¡Œå®é™…ä¿¡å·å¤„ç†ï¼ˆè¯­éŸ³ä¿¡å·æ»¤æ³¢ï¼‰</li>
                </ul>
                
                <div class="data-box">
                    <strong>ğŸ“‚ å®éªŒæ•°æ®æ–‡ä»¶ï¼š</strong>
                    <ul style="margin-top: 10px;">
                        <li><code>phdist.mat</code> - åŒ…å«ä¸‰ç»„æ»¤æ³¢å™¨ç³»æ•° (a1,b1,a2,b2,a3,b3) å’ŒåŠ å™ªè¯­éŸ³ (xnoise)</li>
                        <li><code>orig.mat</code> - åŒ…å«åŸå§‹è¯­éŸ³ä¿¡å· (x) å’Œé‡‡æ ·ç‡ (Fs=8000Hz)</li>
                    </ul>
                </div>
            </section>

            <!-- ç†è®ºåŸºç¡€ -->
            <section id="theory">
                <h2><span class="badge badge-theory">ç†è®º</span>ç†è®ºåŸºç¡€</h2>
                
                <h3>1. FIRæ»¤æ³¢å™¨åŸºæœ¬åŸç†</h3>
                <p>FIRæ»¤æ³¢å™¨çš„å·®åˆ†æ–¹ç¨‹ä¸ºï¼š</p>
                <div class="formula-box">
                    $$y[n] = \sum_{k=0}^{M} b_k \cdot x[n-k] = b_0 x[n] + b_1 x[n-1] + \cdots + b_M x[n-M]$$
                </div>
                <p>å…¶ä¸­ $M$ æ˜¯æ»¤æ³¢å™¨é˜¶æ•°ï¼Œ$N = M+1$ æ˜¯æ»¤æ³¢å™¨é•¿åº¦ï¼ˆç³»æ•°ä¸ªæ•°ï¼‰ã€‚</p>

                <h3>2. çº¿æ€§ç›¸ä½æ¡ä»¶</h3>
                <p>çº¿æ€§ç›¸ä½FIRæ»¤æ³¢å™¨çš„ç›¸ä½å“åº”ä¸º $\phi(\omega) = -\tau \omega$ï¼Œå…¶ä¸­ $\tau = M/2$ æ˜¯ç¾¤å»¶è¿Ÿï¼ˆå¸¸æ•°ï¼‰ã€‚å®ç°çº¿æ€§ç›¸ä½éœ€è¦è„‰å†²å“åº”æ»¡è¶³å¯¹ç§°æ€§ï¼š</p>
                <table>
                    <tr><th>ç±»å‹</th><th>N</th><th>M</th><th>å¯¹ç§°æ€§</th><th>$H(e^{j\omega})$ åœ¨ $\omega=0$</th><th>$H(e^{j\omega})$ åœ¨ $\omega=\pi$</th></tr>
                    <tr><td>Type I</td><td>å¥‡æ•°</td><td>å¶æ•°</td><td>$h[n]=h[M-n]$</td><td>ä»»æ„</td><td>ä»»æ„</td></tr>
                    <tr><td>Type II</td><td>å¶æ•°</td><td>å¥‡æ•°</td><td>$h[n]=h[M-n]$</td><td>ä»»æ„</td><td><strong>= 0</strong></td></tr>
                    <tr><td>Type III</td><td>å¥‡æ•°</td><td>å¶æ•°</td><td>$h[n]=-h[M-n]$</td><td><strong>= 0</strong></td><td><strong>= 0</strong></td></tr>
                    <tr><td>Type IV</td><td>å¶æ•°</td><td>å¥‡æ•°</td><td>$h[n]=-h[M-n]$</td><td><strong>= 0</strong></td><td>ä»»æ„</td></tr>
                </table>

                <h3>3. çª—å‡½æ•°æ³•è®¾è®¡æ­¥éª¤</h3>
                <ol>
                    <li>ç¡®å®šç†æƒ³æ»¤æ³¢å™¨çš„é¢‘ç‡å“åº” $H_d(e^{j\omega})$</li>
                    <li>è®¡ç®—ç†æƒ³è„‰å†²å“åº” $h_d[n]$ï¼ˆé€šå¸¸æ˜¯æ— é™é•¿çš„éå› æœåºåˆ—ï¼‰</li>
                    <li>é€‰æ‹©çª—å‡½æ•° $w[n]$ å¹¶ç¡®å®šé•¿åº¦ $N$</li>
                    <li>è®¡ç®—å®é™…è„‰å†²å“åº” $h[n] = h_d[n] \cdot w[n]$</li>
                </ol>

                <h3>4. å¸¸ç”¨çª—å‡½æ•°ç‰¹æ€§</h3>
                <table>
                    <tr><th>çª—å‡½æ•°</th><th>MATLABå‡½æ•°</th><th>ä¸»ç“£å®½åº¦</th><th>æ—ç“£è¡°å‡</th><th>è¿‡æ¸¡å¸¦</th></tr>
                    <tr><td>çŸ©å½¢çª—</td><td><code>rectwin(N)</code></td><td>$4\pi/N$</td><td>-13 dB</td><td>æœ€çª„</td></tr>
                    <tr><td>æ±‰å®çª—</td><td><code>hann(N)</code></td><td>$8\pi/N$</td><td>-32 dB</td><td>ä¸­ç­‰</td></tr>
                    <tr><td>æ±‰æ˜çª—</td><td><code>hamming(N)</code></td><td>$8\pi/N$</td><td>-43 dB</td><td>ä¸­ç­‰</td></tr>
                    <tr><td>å¸ƒè±å…‹æ›¼çª—</td><td><code>blackman(N)</code></td><td>$12\pi/N$</td><td>-58 dB</td><td>æœ€å®½</td></tr>
                    <tr><td>å‡¯æ³½çª—</td><td><code>kaiser(N,Î²)</code></td><td>å¯è°ƒ</td><td>å¯è°ƒ</td><td>å¯è°ƒ</td></tr>
                </table>

                <div class="warning-box">
                    <strong>âš ï¸ çª—å‡½æ•°é€‰æ‹©å‡†åˆ™</strong>
                    <ul>
                        <li>è¿‡æ¸¡å¸¦çª„ â†’ é€‰æ‹©æ±‰å®çª—æˆ–æ±‰æ˜çª—</li>
                        <li>é˜»å¸¦è¡°å‡ > 50 dB â†’ é€‰æ‹©å¸ƒè±å…‹æ›¼çª—</li>
                        <li>çµæ´»è°ƒèŠ‚ â†’ ä½¿ç”¨å‡¯æ³½çª—</li>
                        <li><strong>é¿å…ä½¿ç”¨çŸ©å½¢çª—</strong>ï¼ˆæŒ¯é“ƒæ•ˆåº”ä¸¥é‡ï¼‰</li>
                    </ul>
                </div>
            </section>
            <!-- ç»ƒä¹ ä¸€ -->
            <section id="exercise1">
                <h2><span class="badge badge-practice">å®è·µ</span>ç»ƒä¹ ä¸€ï¼šæ±‰æ˜çª—FIRä½é€šæ»¤æ³¢å™¨è®¾è®¡ä¸ä¿¡å·æ»¤æ³¢</h2>
                <div class="exercise-box">
                    <h3>ä»»åŠ¡</h3>
                    <p>è®¾è®¡ä¸€ä¸ª 31 é˜¶ï¼ˆN=32ï¼‰çš„æ±‰æ˜çª— FIR ä½é€šæ»¤æ³¢å™¨ï¼Œæˆªæ­¢é¢‘ç‡ $\omega_c = \pi/4$ï¼Œå¹¶å¯¹åŒé¢‘ä¿¡å·è¿›è¡Œæ»¤æ³¢ã€‚</p>
                    
                    <div class="question-item">
                        <h4>ä»»åŠ¡ä¸€ï¼šè®¾è®¡æ»¤æ³¢å™¨</h4>
                        <p>ä½¿ç”¨ <code>fir1(M, Wn)</code> å‡½æ•°è®¾è®¡æ»¤æ³¢å™¨ï¼Œå…¶ä¸­ $M=31$ï¼Œ$Wn = \omega_c/\pi = 0.25$ã€‚</p>
                        <div class="code-block"><code>
<span class="code-line">M = <span class="code-number">31</span>;                 <span class="code-comment">% æ»¤æ³¢å™¨é˜¶æ•°</span></span>
<span class="code-line">Wn = <span class="code-number">0.25</span>;              <span class="code-comment">% å½’ä¸€åŒ–æˆªæ­¢é¢‘ç‡</span></span>
<span class="code-line">h = <span class="code-keyword">fir1</span>(M, Wn);        <span class="code-comment">% è®¾è®¡æ±‰æ˜çª—FIRæ»¤æ³¢å™¨</span></span>
                        </code></div>
                    </div>

                    <div class="question-item">
                        <h4>ä»»åŠ¡äºŒï¼šåˆ†æé¢‘ç‡å“åº”</h4>
                        <p>ä½¿ç”¨ <code>freqz</code> è®¡ç®— 1024 ç‚¹é¢‘ç‡å“åº”ï¼Œç»˜åˆ¶å¹…åº¦å“åº”ï¼ˆdBï¼‰å’Œç›¸ä½å“åº”ã€‚</p>
                        <ul>
                            <li>è§‚å¯Ÿé€šå¸¦å¹³å¦æ€§å’Œé˜»å¸¦è¡°å‡</li>
                            <li>éªŒè¯ç›¸ä½æ˜¯å¦ä¸ºçº¿æ€§ï¼ˆæ–œç‡ $= -M/2 = -15.5$ï¼‰</li>
                        </ul>
                    </div>

                    <div class="question-item">
                        <h4>ä»»åŠ¡ä¸‰ï¼šåŒéŸ³ä¿¡å·æ»¤æ³¢</h4>
                        <p>ç”Ÿæˆè¾“å…¥ä¿¡å· $x[n] = \cos(\omega_1 n) + \cos(\omega_2 n)$ï¼Œå…¶ä¸­ $\omega_1 = \pi/3$ï¼ˆé˜»å¸¦ï¼‰ï¼Œ$\omega_2 = \pi/6$ï¼ˆé€šå¸¦ï¼‰ï¼Œ$n = 0, 1, \ldots, 127$ã€‚</p>
                        <ol>
                            <li>ä½¿ç”¨ <code>y = conv(h, x)</code> è¿›è¡Œæ»¤æ³¢</li>
                            <li>è®¡ç®— x å’Œ y çš„ 1024 ç‚¹ FFT</li>
                            <li>ç»˜åˆ¶é¢‘è°±å¯¹æ¯”å›¾ï¼ŒéªŒè¯å“ªä¸ªé¢‘ç‡æˆåˆ†è¢«æ»¤é™¤</li>
                        </ol>
                    </div>

                    <div class="analysis-box">
                        <h4>ğŸ“Š æ€è€ƒé¢˜</h4>
                        <ul>
                            <li>$\omega_1 = \pi/3 > \omega_c = \pi/4$ï¼Œä½äºé˜»å¸¦ï¼Œåº”è¢«æ»¤é™¤</li>
                            <li>$\omega_2 = \pi/6 < \omega_c = \pi/4$ï¼Œä½äºé€šå¸¦ï¼Œåº”ä¿ç•™</li>
                            <li>å¦‚æœè¦ä¿ç•™ $\omega_1$ è€Œæ»¤é™¤ $\omega_2$ï¼Œåº”è¯¥è®¾è®¡ä»€ä¹ˆç±»å‹çš„æ»¤æ³¢å™¨ï¼Ÿ</li>
                        </ul>
                    </div>

                    <h4>é¢„æœŸå›¾åƒ</h4>
                    <div style="display: flex; flex-wrap: wrap; justify-content: space-around;">
                        <div class="plot-container" style="width: 48%;">
                            <h4>å¹…åº¦å“åº” (dB)</h4>
                            <svg width="400" height="250" viewBox="0 0 400 250">
                                <rect width="400" height="250" fill="#fdfdfd"/>
                                <g transform="translate(50, 210)">
                                    <line x1="0" y1="0" x2="320" y2="0" stroke="#333" stroke-width="2"/>
                                    <line x1="0" y1="0" x2="0" y2="-180" stroke="#333" stroke-width="2"/>
                                    <text x="330" y="5" font-size="12">Ï‰/Ï€</text>
                                    <text x="-10" y="-180" font-size="12" text-anchor="end">dB</text>
                                    <path d="M 0,-5 Q 40,-4 80,-5 L 80,-5 Q 100,-20 120,-80 Q 140,-150 160,-170 L 320,-170" stroke="#2d57a4" stroke-width="2.5" fill="none"/>
                                    <line x1="80" y1="0" x2="80" y2="-180" stroke="#D46A6A" stroke-width="1.5" stroke-dasharray="5,3"/>
                                    <text x="80" y="15" font-size="10" text-anchor="middle">0.25</text>
                                    <text x="0" y="15" font-size="10">0</text>
                                    <text x="320" y="15" font-size="10">1</text>
                                    <text x="-5" y="0" font-size="10" text-anchor="end">0</text>
                                    <text x="-5" y="-85" font-size="10" text-anchor="end">-40</text>
                                    <text x="-5" y="-170" font-size="10" text-anchor="end">-80</text>
                                </g>
                            </svg>
                        </div>
                        <div class="plot-container" style="width: 48%;">
                            <h4>æ»¤æ³¢åé¢‘è°±</h4>
                            <svg width="400" height="250" viewBox="0 0 400 250">
                                <rect width="400" height="250" fill="#fdfdfd"/>
                                <g transform="translate(50, 210)">
                                    <line x1="0" y1="0" x2="320" y2="0" stroke="#333" stroke-width="2"/>
                                    <line x1="0" y1="0" x2="0" y2="-180" stroke="#333" stroke-width="2"/>
                                    <text x="330" y="5" font-size="12">Ï‰/Ï€</text>
                                    <text x="-10" y="-180" font-size="12" text-anchor="end">|Y|</text>
                                    <line x1="53" y1="0" x2="53" y2="-160" stroke="#5ca353" stroke-width="3"/>
                                    <circle cx="53" cy="-160" r="4" fill="#5ca353"/>
                                    <text x="53" y="-170" font-size="10" text-anchor="middle" fill="#5ca353">Ï‰â‚‚=Ï€/6 ä¿ç•™</text>
                                    <line x1="107" y1="0" x2="107" y2="-10" stroke="#D46A6A" stroke-width="2" stroke-dasharray="3,2"/>
                                    <text x="107" y="-20" font-size="10" text-anchor="middle" fill="#D46A6A">Ï‰â‚=Ï€/3 æ»¤é™¤</text>
                                    <line x1="80" y1="0" x2="80" y2="10" stroke="#856404" stroke-width="2"/>
                                    <text x="80" y="25" font-size="9" text-anchor="middle" fill="#856404">Ï‰c</text>
                                </g>
                            </svg>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ç»ƒä¹ äºŒ -->
            <section id="exercise2">
                <h2><span class="badge badge-practice">å®è·µ</span>ç»ƒä¹ äºŒï¼šè¯­éŸ³ä¿¡å·æ»¤æ³¢ç»¼åˆå®éªŒ</h2>
                <div class="exercise-box">
                    <h3>èƒŒæ™¯</h3>
                    <p>æœ¬é¢˜æ—¨åœ¨æ£€éªŒä½ å¯¹ FIR æ»¤æ³¢å™¨è®¾è®¡å’Œåº”ç”¨çš„ç»¼åˆç†è§£ã€‚æˆ‘ä»¬å°†å¯¹å®é™…è¯­éŸ³ä¿¡å·è¿›è¡Œæ»¤æ³¢å¤„ç†ï¼Œå¹¶åˆ†ææ»¤æ³¢å™¨çš„å¹…åº¦å’Œç›¸ä½ç‰¹æ€§å¯¹è¯­éŸ³è´¨é‡çš„å½±å“ã€‚</p>
                    
                    <div class="tip-box">
                        <strong>ğŸ’¡ çŸ¥è¯†æç¤ºï¼š</strong>åœ¨è¯­éŸ³ä¿¡å·å¤„ç†ä¸­ï¼Œç›¸ä½å¤±çœŸå¾€å¾€æ¯”å¹…åº¦å¤±çœŸæ›´å®¹æ˜“è¢«äººè€³å¯Ÿè§‰ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨è¯­éŸ³å¤„ç†åº”ç”¨ä¸­ï¼Œçº¿æ€§ç›¸ä½FIRæ»¤æ³¢å™¨å¾€å¾€æ¯”éçº¿æ€§ç›¸ä½IIRæ»¤æ³¢å™¨æ›´å—é’çã€‚
                    </div>

                    <p><strong>å®éªŒæ•°æ®ï¼š</strong>ç»™å®š <code>phdist.mat</code> æ–‡ä»¶ï¼ŒåŒ…å«ä¸‰ç»„æ»¤æ³¢å™¨ç³»æ•°ï¼ˆ<code>a1, a2, a3, b1, b2, b3</code>ï¼‰å’Œä¸€ä¸ªåŠ å™ªè¯­éŸ³ä¿¡å· <code>xnoise</code>ã€‚å¦æœ‰ <code>orig.mat</code> æ–‡ä»¶åŒ…å«åŸå§‹è¯­éŸ³ä¿¡å· <code>x</code> å’Œé‡‡æ ·ç‡ <code>Fs</code>ã€‚</p>

                    <div class="question-item">
                        <h4>ä»»åŠ¡ä¸€ï¼šå¹…åº¦å“åº”å¯¹æ¯”</h4>
                        <p>ä½¿ç”¨ <code>freqz</code> è®¡ç®—ä¸‰ä¸ªæ»¤æ³¢å™¨çš„ 1024 ç‚¹é¢‘ç‡å“åº”ï¼Œåœ¨åŒä¸€å¼ å›¾ä¸Šç»˜åˆ¶å¹…åº¦è°±ï¼ˆdBï¼‰ã€‚</p>
                        <p><strong>æ€è€ƒï¼š</strong>ä»å¹…åº¦ç‰¹æ€§è§’åº¦ï¼Œå“ªä¸¤ä¸ªæ»¤æ³¢å™¨å¯èƒ½å¾—åˆ°ç›¸ä¼¼çš„æ»¤æ³¢ç»“æœï¼Ÿ</p>
                    </div>

                    <div class="question-item">
                        <h4>ä»»åŠ¡äºŒï¼šç›¸ä½å“åº”å¯¹æ¯”</h4>
                        <p>åœ¨åŒä¸€å¼ å›¾ä¸Šç»˜åˆ¶ä¸‰ä¸ªæ»¤æ³¢å™¨çš„ç›¸ä½å“åº”ã€‚ä½¿ç”¨ <code>unwrap(angle(H))</code> é¿å…ç›¸ä½æŠ˜å ã€‚</p>
                        <p><strong>æ€è€ƒï¼š</strong>ä»ç›¸ä½ç‰¹æ€§è§’åº¦ï¼Œå“ªä¸¤ä¸ªæ»¤æ³¢å™¨å¯èƒ½å¾—åˆ°ç›¸ä¼¼çš„æ»¤æ³¢ç»“æœï¼Ÿ</p>
                    </div>

                    <div class="question-item">
                        <h4>ä»»åŠ¡ä¸‰ï¼šä¸»è§‚å¬è§‰æµ‹è¯•</h4>
                        <p>ç”¨ä¸‰ä¸ªæ»¤æ³¢å™¨åˆ†åˆ«å¯¹åŸå§‹è¯­éŸ³ <code>x</code> è¿›è¡Œæ»¤æ³¢ï¼Œä½¿ç”¨ <code>soundsc</code> æ’­æ”¾å¹¶å¯¹æ¯”ï¼š</p>
                        <ul>
                            <li>è¯­éŸ³å†…å®¹æ˜¯å¦ä»ç„¶å¯ç†è§£ï¼Ÿ</li>
                            <li>å“ªä¸¤ä¸ªæ»¤æ³¢åçš„è¯­éŸ³å¬èµ·æ¥æœ€ç›¸ä¼¼ï¼Ÿ</li>
                            <li>è¿™ä¸ªç»“æœä¸ä»»åŠ¡ä¸€å’Œä»»åŠ¡äºŒçš„åˆ†ææ˜¯å¦ä¸€è‡´ï¼Ÿ</li>
                        </ul>
                        <div class="code-block"><code>
<span class="code-line">y1 = <span class="code-keyword">filter</span>(b1, a1, x);   <span class="code-comment">% æ»¤æ³¢å™¨1</span></span>
<span class="code-line">y2 = <span class="code-keyword">filter</span>(b2, a2, x);   <span class="code-comment">% æ»¤æ³¢å™¨2</span></span>
<span class="code-line">y3 = <span class="code-keyword">filter</span>(b3, a3, x);   <span class="code-comment">% æ»¤æ³¢å™¨3</span></span>
<span class="code-line"><span class="code-keyword">soundsc</span>(y1, Fs);         <span class="code-comment">% æ’­æ”¾æ»¤æ³¢åè¯­éŸ³</span></span>
                        </code></div>
                    </div>

                    <div class="question-item">
                        <h4>ä»»åŠ¡å››ï¼šå™ªå£°åˆ†æä¸å»å™ª</h4>
                        <p>æ’­æ”¾ <code>xnoise</code>ï¼Œå¯¹æ¯”åŸå§‹ä¿¡å· <code>x</code>ã€‚å¯¹ä¸¤è€…åˆ†åˆ«åš 8192 ç‚¹ FFTï¼Œç»˜åˆ¶é¢‘è°±ã€‚</p>
                        <ul>
                            <li>ä½ èƒ½ä»é¢‘è°±ä¸­è¯†åˆ«å‡ºå™ªå£°çš„ç‰¹å¾å—ï¼Ÿ</li>
                            <li>ç”¨ä¸‰ä¸ªæ»¤æ³¢å™¨åˆ†åˆ«å¯¹ <code>xnoise</code> å»å™ªï¼Œå“ªä¸ªæ»¤æ³¢å™¨æ•ˆæœæœ€å¥½ï¼Ÿ</li>
                        </ul>
                    </div>
                    
                    <div class="analysis-box">
                        <h4>ğŸ“Š ç»¼åˆæ€è€ƒé¢˜</h4>
                        <ol>
                            <li>æ»¤æ³¢å™¨çš„<strong>å¹…åº¦ç‰¹æ€§</strong>å’Œ<strong>ç›¸ä½ç‰¹æ€§</strong>å“ªä¸ªå¯¹è¯­éŸ³è´¨é‡æ›´é‡è¦ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</li>
                            <li>å¦‚æœä¸¤ä¸ªæ»¤æ³¢å™¨çš„å¹…åº¦å“åº”å®Œå…¨ç›¸åŒï¼Œä½†ç›¸ä½å“åº”ä¸åŒï¼Œæ»¤æ³¢åçš„è¯­éŸ³ä¼šæœ‰ä»€ä¹ˆå·®åˆ«ï¼Ÿ</li>
                            <li>ä¸ºä»€ä¹ˆçº¿æ€§ç›¸ä½åœ¨è¯­éŸ³å¤„ç†ä¸­å¦‚æ­¤é‡è¦ï¼Ÿä¸¾ä¾‹è¯´æ˜ã€‚</li>
                        </ol>
                    </div>
                </div>
            </section>
            <!-- ç»ƒä¹ ä¸‰ -->
            <section id="exercise3">
                <h2><span class="badge badge-practice">å®è·µ</span>ç»ƒä¹ ä¸‰ï¼šçª—å‡½æ•°é•¿åº¦å¯¹æ»¤æ³¢å™¨æ€§èƒ½çš„å½±å“</h2>
                <div class="exercise-box">
                    <h3>ä»»åŠ¡</h3>
                    <p>åˆ†æçª—å‡½æ•°é•¿åº¦å¯¹çŸ©å½¢çª—é¢‘è°±å’ŒFIRæ»¤æ³¢å™¨æ€§èƒ½çš„å½±å“ã€‚</p>

                    <div class="question-item">
                        <h4>ä»»åŠ¡ä¸€ï¼šçŸ©å½¢çª—é¢‘è°±åˆ†æ</h4>
                        <p>ç”Ÿæˆä¸¤ç§é•¿åº¦çš„çŸ©å½¢çª—ï¼ˆ$N_1=31$, $N_2=121$ï¼‰ï¼Œè®¡ç®— 4096 ç‚¹ FFT é¢‘è°±å¹¶å¯¹æ¯”ã€‚</p>
                        <ul>
                            <li>éªŒè¯ä¸»ç“£å®½åº¦å…¬å¼ï¼š$\Delta\omega = 4\pi/N$</li>
                            <li>è§‚å¯Ÿç¬¬ä¸€æ—ç“£ç›¸å¯¹ä¸»ç“£çš„è¡°å‡ï¼ˆåº”ä¸º -13.3 dBï¼Œä¸ N æ— å…³ï¼‰</li>
                        </ul>
                        <div class="formula-box">
                            <p><strong>çŸ©å½¢çª—çš„é¢‘è°±ï¼ˆDirichletæ ¸ï¼‰ï¼š</strong></p>
                            $$W(e^{j\omega}) = \frac{\sin(\omega N/2)}{\sin(\omega/2)}$$
                        </div>
                    </div>

                    <div class="question-item">
                        <h4>ä»»åŠ¡äºŒï¼šFIRæ»¤æ³¢å™¨æ€§èƒ½å¯¹æ¯”</h4>
                        <p>è®¾è®¡ä¸¤ç§é˜¶æ•°çš„æ±‰æ˜çª—FIRä½é€šæ»¤æ³¢å™¨ï¼ˆ$M_1=30$, $M_2=120$ï¼‰ï¼Œæˆªæ­¢é¢‘ç‡ $\omega_c=0.4\pi$ã€‚</p>
                        <ol>
                            <li>ç»˜åˆ¶å¹…åº¦å“åº”å¯¹æ¯”å›¾</li>
                            <li>æµ‹é‡è¿‡æ¸¡å¸¦å®½åº¦ï¼ˆ-3dB åˆ° -40dBï¼‰</li>
                            <li>éªŒè¯è¿‡æ¸¡å¸¦å®½åº¦æ¯”å€¼æ˜¯å¦æ¥è¿‘é˜¶æ•°æ¯”å€¼ï¼ˆ4:1ï¼‰</li>
                        </ol>
                        <div class="tip-box">
                            <strong>ğŸ’¡ ç†è®ºé¢„æµ‹ï¼š</strong>æ±‰æ˜çª—çš„è¿‡æ¸¡å¸¦å®½åº¦çº¦ä¸º $8\pi/N$ï¼Œé˜¶æ•°å¢åŠ 4å€ï¼Œè¿‡æ¸¡å¸¦å®½åº¦åº”å‡å°ä¸ºåŸæ¥çš„1/4ã€‚
                        </div>
                    </div>

                    <div class="question-item">
                        <h4>ä»»åŠ¡ä¸‰ï¼šè®¡ç®—å¤æ‚åº¦åˆ†æ</h4>
                        <p>å‡è®¾é‡‡æ ·ç‡ $F_s = 48000$ Hzï¼ŒCPUæ—¶é’Ÿ $f_{cpu} = 100$ MHzã€‚åˆ†æå®æ—¶å¤„ç†èƒ½åŠ›ï¼š</p>
                        <ul>
                            <li>æ¯æ ·æœ¬éœ€è¦çš„ MACï¼ˆä¹˜ç´¯åŠ ï¼‰æ“ä½œæ•°ï¼š$M+1$</li>
                            <li>é‡‡æ ·å‘¨æœŸï¼š$T_s = 1/F_s$</li>
                            <li>CPUåˆ©ç”¨ç‡ï¼š$(M+1) \cdot T_{clk} / T_s$</li>
                            <li>åˆ¤æ–­ä¸¤ç§é˜¶æ•°çš„æ»¤æ³¢å™¨æ˜¯å¦èƒ½å®æ—¶å¤„ç†</li>
                        </ul>
                    </div>

                    <div class="analysis-box">
                        <h4>ğŸ“Š è®¾è®¡æƒè¡¡æ€»ç»“</h4>
                        <table>
                            <tr><th>é˜¶æ•°å¢åŠ çš„ä¼˜åŠ¿</th><th>é˜¶æ•°å¢åŠ çš„ä»£ä»·</th></tr>
                            <tr><td>è¿‡æ¸¡å¸¦æ›´çª„</td><td>è®¡ç®—é‡å¢åŠ </td></tr>
                            <tr><td>æ›´æ¥è¿‘ç†æƒ³æ»¤æ³¢å™¨</td><td>ç¾¤å»¶è¿Ÿå¢åŠ </td></tr>
                            <tr><td>é€šå¸¦æ›´å¹³å¦</td><td>å­˜å‚¨éœ€æ±‚å¢åŠ </td></tr>
                        </table>
                    </div>
                </div>
            </section>

            <!-- ç»ƒä¹ å›› -->
            <section id="exercise4">
                <h2><span class="badge badge-practice">å®è·µ</span>ç»ƒä¹ å››ï¼šçª—å‡½æ•°æ€§èƒ½å¯¹æ¯”ä¸ä¼˜åŒ–è®¾è®¡</h2>
                <div class="exercise-box">
                    <div class="question-item">
                        <h4>ä»»åŠ¡ä¸€ï¼šä¸åŒçª—å‡½æ•°å¯¹æ¯”å®éªŒ</h4>
                        <p>è®¾è®¡ 4 ä¸ª 31 é˜¶ä½é€šæ»¤æ³¢å™¨ï¼Œæˆªæ­¢é¢‘ç‡ $\omega_c = 0.4\pi$ï¼Œåˆ†åˆ«ä½¿ç”¨çŸ©å½¢çª—ã€æ±‰å®çª—ã€æ±‰æ˜çª—å’Œå¸ƒè±å…‹æ›¼çª—ã€‚</p>
                        <ol>
                            <li>åœ¨åŒä¸€å›¾ä¸Šç»˜åˆ¶æ‰€æœ‰æ»¤æ³¢å™¨çš„å¹…åº¦å“åº”ï¼ˆdBï¼‰</li>
                            <li>æµ‹é‡å¹¶è®°å½•å„çª—å‡½æ•°çš„é˜»å¸¦è¡°å‡</li>
                            <li>è§‚å¯Ÿè¿‡æ¸¡å¸¦å®½åº¦çš„å·®å¼‚</li>
                        </ol>
                    </div>

                    <div class="question-item">
                        <h4>ä»»åŠ¡äºŒï¼šå‡¯æ³½çª—çš„å‚æ•°ä¼˜åŒ–</h4>
                        <p>å‡¯æ³½çª—é€šè¿‡ $\beta$ å‚æ•°åœ¨è¿‡æ¸¡å¸¦å®½åº¦å’Œé˜»å¸¦è¡°å‡ä¹‹é—´æƒè¡¡ã€‚ä½¿ç”¨ $\beta = 3, 5, 7, 9$ è®¾è®¡æ»¤æ³¢å™¨ï¼Œè§‚å¯Ÿæ€§èƒ½å˜åŒ–ã€‚</p>
                        <div class="code-block"><code>
<span class="code-line"><span class="code-keyword">for</span> beta = [<span class="code-number">3</span>, <span class="code-number">5</span>, <span class="code-number">7</span>, <span class="code-number">9</span>]</span>
<span class="code-line">    h = <span class="code-keyword">fir1</span>(<span class="code-number">31</span>, <span class="code-number">0.4</span>, <span class="code-keyword">kaiser</span>(<span class="code-number">32</span>, beta));</span>
<span class="code-line">    [H, w] = <span class="code-keyword">freqz</span>(h, <span class="code-number">1</span>, <span class="code-number">1024</span>);</span>
<span class="code-line">    <span class="code-keyword">plot</span>(w/pi, <span class="code-number">20</span>*<span class="code-keyword">log10</span>(<span class="code-keyword">abs</span>(H))); <span class="code-keyword">hold</span> on;</span>
<span class="code-line"><span class="code-keyword">end</span></span>
                        </code></div>
                    </div>

                    <div class="question-item">
                        <h4>ä»»åŠ¡ä¸‰ï¼šæ»¤æ³¢å™¨é˜¶æ•°çš„å½±å“</h4>
                        <p>å›ºå®šä½¿ç”¨æ±‰æ˜çª—ï¼Œæ”¹å˜æ»¤æ³¢å™¨é˜¶æ•° $M = 15, 31, 63, 127$ï¼Œè§‚å¯Ÿé¢‘ç‡å“åº”å˜åŒ–ã€‚</p>
                    </div>

                    <div class="question-item">
                        <h4>ä»»åŠ¡å››ï¼šå®é™…åº”ç”¨è®¾è®¡æŒ‘æˆ˜</h4>
                        <p><strong>è®¾è®¡è¦æ±‚ï¼š</strong></p>
                        <ul>
                            <li>é€šå¸¦è¾¹ç•Œï¼š$\omega_p = 0.3\pi$</li>
                            <li>é˜»å¸¦è¾¹ç•Œï¼š$\omega_s = 0.5\pi$</li>
                            <li>é€šå¸¦æ³¢çº¹ï¼š$\delta_p \leq 0.01$ï¼ˆçº¦ 0.086 dBï¼‰</li>
                            <li>é˜»å¸¦è¡°å‡ï¼š$\delta_s \leq 0.001$ï¼ˆçº¦ -60 dBï¼‰</li>
                        </ul>
                        <p><strong>è®¾è®¡æ­¥éª¤ï¼š</strong></p>
                        <ol>
                            <li>æ ¹æ®é˜»å¸¦è¡°å‡è¦æ±‚é€‰æ‹©åˆé€‚çš„çª—å‡½æ•°ï¼ˆæç¤ºï¼šéœ€è¦ -60 dBï¼Œåº”é€‰å¸ƒè±å…‹æ›¼çª—ï¼‰</li>
                            <li>ä¼°ç®—é˜¶æ•°ï¼š$N \approx \frac{A_s - 8}{2.285 \Delta\omega}$</li>
                            <li>è®¾è®¡æ»¤æ³¢å™¨å¹¶éªŒè¯æ˜¯å¦æ»¡è¶³è§„æ ¼</li>
                        </ol>
                    </div>

                    <h4>é¢„æœŸå›¾åƒ</h4>
                    <div class="plot-container">
                        <h4>ä¸åŒçª—å‡½æ•°çš„å¹…åº¦å“åº”å¯¹æ¯”</h4>
                        <svg width="700" height="350" viewBox="0 0 700 350">
                            <rect width="700" height="350" fill="#fdfdfd"/>
                            <g transform="translate(70, 300)">
                                <line x1="0" y1="0" x2="580" y2="0" stroke="#333" stroke-width="2"/>
                                <line x1="0" y1="0" x2="0" y2="-260" stroke="#333" stroke-width="2"/>
                                <text x="590" y="5" font-size="12">Ï‰/Ï€</text>
                                <text x="-10" y="-260" font-size="12" text-anchor="end">dB</text>
                                
                                <path d="M 0,-5 L 180,-5 Q 200,-20 220,-60 L 580,-60" stroke="#D46A6A" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
                                <path d="M 0,-5 L 170,-5 Q 200,-40 230,-130 L 580,-130" stroke="#FFA500" stroke-width="2" fill="none"/>
                                <path d="M 0,-5 L 170,-5 Q 200,-50 230,-175 L 580,-175" stroke="#2d57a4" stroke-width="2.5" fill="none"/>
                                <path d="M 0,-5 L 160,-5 Q 200,-70 240,-230 L 580,-230" stroke="#5ca353" stroke-width="2" fill="none"/>
                                
                                <text x="0" y="15" font-size="10">0</text>
                                <text x="232" y="15" font-size="10">0.4</text>
                                <text x="580" y="15" font-size="10">1</text>
                                <text x="-5" y="0" font-size="10" text-anchor="end">0</text>
                                <text x="-5" y="-60" font-size="10" text-anchor="end">-20</text>
                                <text x="-5" y="-130" font-size="10" text-anchor="end">-43</text>
                                <text x="-5" y="-175" font-size="10" text-anchor="end">-58</text>
                                
                                <g transform="translate(400, -220)">
                                    <line x1="0" y1="0" x2="20" y2="0" stroke="#D46A6A" stroke-width="2" stroke-dasharray="5,3"/>
                                    <text x="25" y="4" font-size="11">çŸ©å½¢çª— (-13dB)</text>
                                    <line x1="0" y1="18" x2="20" y2="18" stroke="#FFA500" stroke-width="2"/>
                                    <text x="25" y="22" font-size="11">æ±‰å®çª— (-32dB)</text>
                                    <line x1="0" y1="36" x2="20" y2="36" stroke="#2d57a4" stroke-width="2.5"/>
                                    <text x="25" y="40" font-size="11" font-weight="bold">æ±‰æ˜çª— (-43dB)</text>
                                    <line x1="0" y1="54" x2="20" y2="54" stroke="#5ca353" stroke-width="2"/>
                                    <text x="25" y="58" font-size="11">å¸ƒè±å…‹æ›¼ (-58dB)</text>
                                </g>
                            </g>
                        </svg>
                    </div>

                    <div class="analysis-box">
                        <h4>ğŸ“Š ç»¼åˆåˆ†æ</h4>
                        <ol>
                            <li>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¦‚ä½•æ ¹æ®è®¾è®¡è¦æ±‚é€‰æ‹©åˆé€‚çš„çª—å‡½æ•°ï¼Ÿ</li>
                            <li>å¦‚æœè¦æ±‚é˜»å¸¦è¡°å‡è‡³å°‘ -60 dBï¼Œåº”è¯¥é€‰æ‹©å“ªç§çª—å‡½æ•°ï¼Ÿ</li>
                            <li>å¦‚æœè®¡ç®—èµ„æºæœ‰é™ä½†åˆéœ€è¦è¾ƒå¥½çš„é˜»å¸¦è¡°å‡ï¼Œåº”è¯¥å¦‚ä½•æƒè¡¡ï¼Ÿ</li>
                            <li>çº¿æ€§ç›¸ä½ç‰¹æ€§åœ¨ä»€ä¹ˆåº”ç”¨åœºæ™¯ä¸‹æœ€é‡è¦ï¼Ÿ</li>
                        </ol>
                    </div>
                </div>
            </section>
        </div>

        <footer>
            <p>&copy; 2025 å—äº¬å·¥ä¸šå¤§å­¦æµ¦æ±Ÿå­¦é™¢ è®¡ç®—æœºä¸é€šä¿¡å·¥ç¨‹å­¦é™¢</p>
            <p>æ•°å­—ä¿¡å·å¤„ç†è¯¾ç¨‹ | Digital Signal Processing Laboratory Experiments</p>
        </footer>
    </div>
</body>
</html>
