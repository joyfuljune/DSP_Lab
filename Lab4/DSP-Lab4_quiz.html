<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DSP-Lab4 æ™ºèƒ½ç»ƒä¹ ç³»ç»Ÿ</title>
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$','$'], ['\\(','\\)']],
                displayMath: [['$$','$$'], ['\\[','\\]']],
                processEscapes: true
            },
            CommonHTML: { scale: 110 },
            "HTML-CSS": { scale: 110 }
        });
    </script>
    
    <style>
        .mathjax-status {
            position: fixed; top: 10px; right: 15px; padding: 8px 15px; border-radius: 5px;
            background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb;
            font-size: 14px; z-index: 10000; font-family: 'Microsoft YaHei', sans-serif;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        .mathjax-status.loading { background-color: #fff3cd; color: #856404; border-color: #ffeeba; }
        .mathjax-status.success {
            background-color: #d4edda; color: #155724; border-color: #c3e6cb;
            transition: opacity 0.5s ease-out 1.5s; opacity: 0;
        }
    </style>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Microsoft YaHei', 'SimSun', Arial, sans-serif;
            background: linear-gradient(135deg, #2d57a4 0%, #608de0 50%, #5ca353 100%);
            min-height: 100vh; padding: 20px;
        }
        .container {
            max-width: 900px; margin: 0 auto; background: white; border-radius: 20px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.25); padding: 40px;
        }
        h1 { color: #2d57a4; text-align: center; margin-bottom: 30px; font-size: 2em; }
        h2 { color: #608de0; margin: 25px 0 15px 0; }
        
        .login-section, .quiz-section, .result-section { display: none; }
        .login-section.active, .quiz-section.active, .result-section.active { display: block; }
        
        .form-group { margin-bottom: 20px; }
        label { display: block; color: #2d57a4; font-weight: bold; margin-bottom: 8px; }
        input[type="text"] { 
            width: 100%; padding: 12px; border: 2px solid #7dadff; border-radius: 8px; 
            font-size: 16px; transition: border-color 0.3s;
        }
        input[type="text"]:focus { border-color: #2d57a4; outline: none; }
        
        button {
            background: linear-gradient(135deg, #2d57a4 0%, #608de0 100%); color: white; border: none;
            padding: 12px 30px; border-radius: 25px; cursor: pointer; font-size: 16px;
            font-weight: bold; transition: all 0.3s; box-shadow: 0 3px 10px rgba(45, 87, 164, 0.3);
        }
        button:hover {
            background: linear-gradient(135deg, #1e3d7a 0%, #2d57a4 100%);
            transform: translateY(-2px); box-shadow: 0 5px 15px rgba(45, 87, 164, 0.5);
        }
        button:disabled { background: #ccc; cursor: not-allowed; transform: none; }
        
        .question-box { 
            background: #f8f9fa; border-left: 5px solid #2d57a4; padding: 25px; 
            margin: 20px 0; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .question-title { color: #2d57a4; font-weight: bold; font-size: 1.2em; margin-bottom: 15px; }
        .question-number { 
            display: inline-block; background: #2d57a4; color: white; padding: 4px 12px; 
            border-radius: 15px; font-size: 0.9em; margin-right: 10px;
        }
        
        .options { margin: 15px 0; }
        .option, .checkbox-option {
            display: block; background: white; padding: 12px; margin: 8px 0; 
            border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; 
            transition: all 0.3s; position: relative;
        }
        .option:hover, .checkbox-option:hover { background: #e8f5ff; border-color: #608de0; }
        .option.selected { background: #608de0; color: white; border-color: #2d57a4; }
        .option.correct, .checkbox-option.correct { 
            background: #5ca353; color: white; border-color: #4a8842; 
            animation: correctPulse 0.5s ease-in-out;
        }
        .option.incorrect, .checkbox-option.incorrect { 
            background: #D46A6A; color: white; border-color: #912d32;
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        
        .feedback { margin: 15px 0; padding: 15px; border-radius: 8px; font-weight: bold; }
        .feedback.correct { background: #e8f5e9; color: #5ca353; border-left: 5px solid #5ca353; }
        .feedback.incorrect { background: #ffebee; color: #912d32; border-left: 5px solid #912d32; }
        
        .progress-bar { 
            width: 100%; height: 30px; background: #e0e0e0; border-radius: 15px; 
            overflow: hidden; margin: 20px 0; position: relative;
        }
        .progress-fill {
            height: 100%; background: linear-gradient(90deg, #2d57a4 0%, #5ca353 100%);
            transition: width 0.5s; display: flex; align-items: center; justify-content: center;
            color: white; font-weight: bold;
        }
        
        .topic-indicator {
            background: linear-gradient(135deg, #e3f2fd 0%, #f0f9ff 100%);
            border-left: 5px solid #2d57a4; padding: 15px; margin: 20px 0; 
            border-radius: 8px; text-align: center;
        }
        .topic-name { color: #2d57a4; font-size: 1.3em; font-weight: bold; }
        .topic-progress { color: #666; font-size: 0.9em; margin-top: 8px; }
        
        .stats-table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        .stats-table th, .stats-table td { padding: 12px; text-align: left; border: 1px solid #e0e0e0; }
        .stats-table th { background: linear-gradient(135deg, #2d57a4 0%, #608de0 100%); color: white; }
        .stats-table tr:nth-child(even) { background: #f8f9fa; }
        
        .mastery-excellent { color: #5ca353; font-weight: bold; }
        .mastery-good { color: #608de0; font-weight: bold; }
        .mastery-fair { color: #D46A6A; font-weight: bold; }
        .mastery-poor { color: #912d32; font-weight: bold; }
        
        .info-box { 
            background: linear-gradient(135deg, #e8f5ff 0%, #f0f9ff 100%);
            border-left: 5px solid #2d57a4; padding: 15px; margin: 15px 0; border-radius: 8px; 
        }
        .warning-box {
            background: linear-gradient(135deg, #fff8e1 0%, #fffbf0 100%);
            border-left: 5px solid #D46A6A; padding: 15px; margin: 15px 0; border-radius: 8px;
        }
        
        .student-info-display {
            background: #f8f9fa; padding: 12px; border-radius: 8px; margin-bottom: 20px;
            text-align: center; color: #2d57a4; font-weight: bold;
        }
        
        .explanation-detail {
            margin-top: 10px; padding: 10px; background: rgba(255,255,255,0.5);
            border-radius: 5px; font-size: 0.95em; font-weight: normal;
        }
        
        code {
            background: #f0f0f0; padding: 2px 6px; border-radius: 4px; 
            font-family: Consolas, monospace; font-size: 0.95em;
        }
    </style>
</head>
<body>
    <div id="mathjaxStatus" class="mathjax-status loading">æ­£åœ¨åŠ è½½æ•°å­¦å…¬å¼...</div>
    
    <div class="container">
        <!-- ç™»å½•ç•Œé¢ -->
        <div class="login-section active">
            <h1>ğŸ“ DSP-Lab4 æ™ºèƒ½ç»ƒä¹ ç³»ç»Ÿ</h1>
            <div class="info-box">
                <strong>ğŸ“Œ ç³»ç»Ÿç‰¹è‰²</strong>
                <ul style="margin: 10px 0 0 20px; line-height: 1.8;">
                    <li><strong>çŸ¥è¯†ç‚¹å…¨è¦†ç›–</strong>ï¼šæ¶µç›–é¢‘ç‡é¢„ç¿˜æ›²ã€Butterworthã€Chebyshevã€Ellipticæ»¤æ³¢å™¨ã€åŒçº¿æ€§å˜æ¢ã€IIMä¸BLTå¯¹æ¯”ç­‰7å¤§æ ¸å¿ƒçŸ¥è¯†ç‚¹</li>
                    <li><strong>é¢˜ç›®éšæœºåŒ–</strong>ï¼šæ¯æ¬¡ç»ƒä¹ æ•°å€¼ã€é€‰é¡¹é¡ºåºéƒ½ä¸åŒï¼Œé¿å…æ­»è®°ç¡¬èƒŒ</li>
                    <li><strong>æ™ºèƒ½å¾ªç¯</strong>ï¼šç­”é”™è‡ªåŠ¨å‡ºæ–°é¢˜å·©å›ºï¼Œç­”å¯¹æ‰è¿›å…¥ä¸‹ä¸€çŸ¥è¯†ç‚¹</li>
                    <li><strong>è¯¦ç»†åé¦ˆ</strong>ï¼šæ¯é¢˜éƒ½æœ‰è¯¦ç»†è§£æï¼Œå¸®åŠ©ç†è§£IIRæ»¤æ³¢å™¨è®¾è®¡åŠæ–¹æ³•é€‰æ‹©</li>
                </ul>
            </div>
            <div class="form-group">
                <label>å­¦å·:</label>
                <input type="text" id="studentId" placeholder="è¯·è¾“å…¥å­¦å·">
            </div>
            <div class="form-group">
                <label>å§“å:</label>
                <input type="text" id="studentName" placeholder="è¯·è¾“å…¥å§“å">
            </div>
            <button onclick="startQuiz()">å¼€å§‹ç»ƒä¹ </button>
        </div>

        <!-- æµ‹éªŒç•Œé¢ -->
        <div class="quiz-section">
            <h1>DSP-Lab4 æ™ºèƒ½ç»ƒä¹ </h1>
            <div id="studentInfo" class="student-info-display"></div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar">0%</div>
            </div>
            
            <div id="currentTopic" class="topic-indicator"></div>
            
            <div class="question-box">
                <div class="question-title" id="questionTitle"></div>
                <div id="questionContent"></div>
                <div id="options" class="options"></div>
                <div id="feedback"></div>
                <button id="submitBtn" onclick="submitAnswer()">æäº¤ç­”æ¡ˆ</button>
                <button id="nextBtn" onclick="nextQuestion()" style="display:none;">ä¸‹ä¸€é¢˜</button>
            </div>
        </div>

        <!-- ç»“æœç•Œé¢ -->
        <div class="result-section">
            <h1>ğŸ“Š ç»ƒä¹ ç»“æœæŠ¥å‘Š</h1>
            <div id="finalReport"></div>
            <button onclick="saveScreenshot()" id="saveBtn">ğŸ’¾ ä¿å­˜æŠ¥å‘Š</button>
            <button onclick="location.reload()" style="margin-left: 10px;">ğŸ”„ é‡æ–°ç»ƒä¹ </button>
        </div>
    </div>

    <script>
        // ==================== çŸ¥è¯†ç‚¹é¢˜åº“å®šä¹‰ ====================
        const knowledgeBase = {
            // çŸ¥è¯†ç‚¹1: é¢‘ç‡é¢„ç¿˜æ›²
            prewarping: {
                id: 'prewarping',
                name: 'é¢‘ç‡é¢„ç¿˜æ›² (Frequency Pre-warping)',
                description: 'ç†è§£åŒçº¿æ€§å˜æ¢çš„é¢‘ç‡ç•¸å˜åŠå…¶è¡¥å¿æ–¹æ³•',
                questionGenerators: [
                    // é¢˜å‹1: é¢„ç¿˜æ›²å…¬å¼
                    {
                        type: 'single',
                        generate: () => {
                            const Fs = [40000, 48000, 80000, 96000][Math.floor(Math.random() * 4)];
                            const Fp = Math.floor(Math.random() * 5000) + 2000;
                            return {
                                question: `é‡‡æ ·é¢‘ç‡ $F_s = ${Fs}$ Hzï¼Œé€šå¸¦è¾¹ç•Œ $F_p = ${Fp}$ Hzã€‚é¢„ç¿˜æ›²åçš„æ¨¡æ‹Ÿè§’é¢‘ç‡ $\\Omega_p$ çš„è®¡ç®—å…¬å¼æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: `$\\Omega_p = 2F_s \\cdot \\tan\\left(\\frac{\\pi F_p}{F_s}\\right)$`, correct: true },
                                    { text: `$\\Omega_p = 2\\pi F_p$`, correct: false },
                                    { text: `$\\Omega_p = \\frac{2\\pi F_p}{F_s}$`, correct: false },
                                    { text: `$\\Omega_p = F_s \\cdot \\tan\\left(\\frac{2\\pi F_p}{F_s}\\right)$`, correct: false }
                                ]),
                                explanation: `é¢‘ç‡é¢„ç¿˜æ›²å…¬å¼ï¼š$\\Omega = 2F_s \\cdot \\tan(\\omega/2)$ï¼Œå…¶ä¸­ $\\omega = 2\\pi F/F_s$ã€‚ä»£å…¥å¾— $\\Omega_p = 2F_s \\cdot \\tan(\\pi F_p/F_s)$ã€‚è¿™æ˜¯åŒçº¿æ€§å˜æ¢è®¾è®¡çš„å…³é”®æ­¥éª¤ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹2: ä¸ºä»€ä¹ˆéœ€è¦é¢„ç¿˜æ›²
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `é¢‘ç‡é¢„ç¿˜æ›²çš„ç›®çš„æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'è¡¥å¿åŒçº¿æ€§å˜æ¢å¼•èµ·çš„é¢‘ç‡ç•¸å˜', correct: true },
                                    { text: 'æé«˜æ»¤æ³¢å™¨çš„é˜¶æ•°', correct: false },
                                    { text: 'å‡å°é€šå¸¦æ³¢çº¹', correct: false },
                                    { text: 'å¢åŠ é˜»å¸¦è¡°å‡', correct: false }
                                ]),
                                explanation: `åŒçº¿æ€§å˜æ¢ $s = \\frac{2}{T}\\frac{z-1}{z+1}$ ä¼šå¼•èµ·é¢‘ç‡çš„éçº¿æ€§æ˜ å°„ï¼š$\\Omega = \\frac{2}{T}\\tan(\\omega/2)$ã€‚ä¸ºäº†è®©è®¾è®¡çš„æ•°å­—æ»¤æ³¢å™¨åœ¨ç›®æ ‡é¢‘ç‡ç‚¹æ»¡è¶³æŒ‡æ ‡ï¼Œéœ€è¦å…ˆå¯¹æ¨¡æ‹Ÿé¢‘ç‡è¿›è¡Œé¢„ç¿˜æ›²ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹3: é¢‘ç‡æ˜ å°„å…³ç³»
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `åŒçº¿æ€§å˜æ¢ä¸­ï¼Œæ¨¡æ‹Ÿé¢‘ç‡ $\\Omega$ å’Œæ•°å­—é¢‘ç‡ $\\omega$ çš„å…³ç³»æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: `$\\omega = 2\\arctan\\left(\\frac{\\Omega T}{2}\\right)$`, correct: true },
                                    { text: `$\\omega = \\Omega T$`, correct: false },
                                    { text: `$\\omega = \\Omega / F_s$`, correct: false },
                                    { text: `$\\omega = 2\\pi\\Omega$`, correct: false }
                                ]),
                                explanation: `åŒçº¿æ€§å˜æ¢çš„é¢‘ç‡æ˜ å°„ï¼š$\\Omega = \\frac{2}{T}\\tan(\\omega/2)$ï¼Œåè¿‡æ¥ $\\omega = 2\\arctan(\\Omega T/2)$ã€‚è¿™æ˜¯éçº¿æ€§æ˜ å°„ï¼Œä½é¢‘è¿‘ä¼¼çº¿æ€§ï¼Œé«˜é¢‘å‹ç¼©åˆ° $\\pi$ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹4: MATLABä¸­çš„å®ç°
                    {
                        type: 'single',
                        generate: () => {
                            const Fs = 80000;
                            const Fp = 4000;
                            return {
                                question: `åœ¨MATLABä¸­ï¼Œå·²çŸ¥ <code>Fs = ${Fs}</code>ï¼Œ<code>Fp = ${Fp}</code>ï¼Œè®¡ç®—é¢„ç¿˜æ›²é¢‘ç‡çš„æ­£ç¡®ä»£ç æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: `<code>wp = 2*pi*Fp/Fs; Omega_p = (2*Fs)*tan(wp/2);</code>`, correct: true },
                                    { text: `<code>Omega_p = 2*pi*Fp;</code>`, correct: false },
                                    { text: `<code>wp = Fp/Fs; Omega_p = tan(wp);</code>`, correct: false },
                                    { text: `<code>Omega_p = Fs*tan(2*pi*Fp);</code>`, correct: false }
                                ]),
                                explanation: `æ­£ç¡®æ­¥éª¤ï¼š1) è®¡ç®—æ•°å­—è§’é¢‘ç‡ wp = 2Ï€Fp/Fsï¼›2) é¢„ç¿˜æ›² Î©p = 2FsÂ·tan(wp/2)ã€‚è¿™ä¿è¯äº†åŒçº¿æ€§å˜æ¢åæ•°å­—æ»¤æ³¢å™¨åœ¨Fpå¤„æ»¡è¶³è®¾è®¡æŒ‡æ ‡ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹5: é¢„ç¿˜æ›²å¯¹é«˜é¢‘çš„å½±å“
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `å½“è®¾è®¡é¢‘ç‡æ¥è¿‘å¥ˆå¥æ–¯ç‰¹é¢‘ç‡ ($F_s/2$) æ—¶ï¼Œé¢„ç¿˜æ›²çš„å½±å“æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'é¢„ç¿˜æ›²åçš„æ¨¡æ‹Ÿé¢‘ç‡è¶‹å‘æ— ç©·å¤§', correct: true },
                                    { text: 'é¢„ç¿˜æ›²åçš„æ¨¡æ‹Ÿé¢‘ç‡è¶‹å‘é›¶', correct: false },
                                    { text: 'é¢„ç¿˜æ›²åçš„æ¨¡æ‹Ÿé¢‘ç‡ä¸å˜', correct: false },
                                    { text: 'é¢„ç¿˜æ›²æ— æ³•è®¡ç®—', correct: false }
                                ]),
                                explanation: `å½“ $\\omega \\to \\pi$ æ—¶ï¼Œ$\\tan(\\omega/2) \\to \\infty$ï¼Œå› æ­¤ $\\Omega \\to \\infty$ã€‚è¿™æ„å‘³ç€æ•´ä¸ªæ¨¡æ‹Ÿé¢‘ç‡è½´ $(-\\infty, +\\infty)$ è¢«æ˜ å°„åˆ°æ•°å­—é¢‘ç‡ $(-\\pi, \\pi)$ï¼ŒåŒçº¿æ€§å˜æ¢ä¸ä¼šäº§ç”Ÿé¢‘ç‡æ··å ã€‚`
                            };
                        }
                    }
                ]
            },

            // çŸ¥è¯†ç‚¹2: Butterworthæ»¤æ³¢å™¨
            butterworth: {
                id: 'butterworth',
                name: 'Butterworthæ»¤æ³¢å™¨è®¾è®¡',
                description: 'ç†è§£Butterworthæ»¤æ³¢å™¨çš„æœ€å¤§å¹³å¦ç‰¹æ€§åŠè®¾è®¡æ–¹æ³•',
                questionGenerators: [
                    // é¢˜å‹1: æ ¸å¿ƒç‰¹æ€§
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `Butterworthæ»¤æ³¢å™¨çš„æ ¸å¿ƒç‰¹æ€§æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'é€šå¸¦æœ€å¤§å¹³å¦ï¼ˆMaximally Flatï¼‰', correct: true },
                                    { text: 'é€šå¸¦ç­‰æ³¢çº¹', correct: false },
                                    { text: 'æœ€çª„è¿‡æ¸¡å¸¦', correct: false },
                                    { text: 'é˜»å¸¦ç­‰æ³¢çº¹', correct: false }
                                ]),
                                explanation: `Butterworthæ»¤æ³¢å™¨åœ¨é€šå¸¦å†…å…·æœ‰æœ€å¤§å¹³å¦çš„å¹…åº¦å“åº”ï¼Œå³åœ¨ $\\omega=0$ å¤„ï¼Œå‰ $2N-1$ é˜¶å¯¼æ•°ä¸ºé›¶ã€‚ä»£ä»·æ˜¯è¿‡æ¸¡å¸¦æ¯”å…¶ä»–ç±»å‹å®½ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹2: buttordå‡½æ•°
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `MATLABå‡½æ•° <code>[N, Wn] = buttord(Wp, Ws, Rp, Rs, 's')</code> ä¸­ï¼Œæœ€åçš„ <code>'s'</code> å‚æ•°è¡¨ç¤ºï¼š`,
                                options: shuffleOptions([
                                    { text: 'è®¾è®¡æ¨¡æ‹Ÿæ»¤æ³¢å™¨ï¼ˆsåŸŸï¼‰', correct: true },
                                    { text: 'è®¾è®¡æ•°å­—æ»¤æ³¢å™¨ï¼ˆzåŸŸï¼‰', correct: false },
                                    { text: 'ä½¿ç”¨å½’ä¸€åŒ–é¢‘ç‡', correct: false },
                                    { text: 'å¯ç”¨å¿«é€Ÿç®—æ³•', correct: false }
                                ]),
                                explanation: `åŠ  's' å‚æ•°è¡¨ç¤ºåœ¨æ¨¡æ‹ŸåŸŸ(såŸŸ)è®¾è®¡æ»¤æ³¢å™¨ï¼Œæ­¤æ—¶Wpã€Wsçš„å•ä½æ˜¯rad/sã€‚ä¸åŠ 's'åˆ™é»˜è®¤è®¾è®¡æ•°å­—æ»¤æ³¢å™¨ï¼Œé¢‘ç‡éœ€å½’ä¸€åŒ–åˆ°0~1ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹3: é˜¶æ¬¡ä¸è¿‡æ¸¡å¸¦
                    {
                        type: 'single',
                        generate: () => {
                            const N1 = Math.floor(Math.random() * 3) + 3;
                            const N2 = N1 + 2;
                            return {
                                question: `ä¸¤ä¸ªButterworthæ»¤æ³¢å™¨ï¼Œé˜¶æ•°åˆ†åˆ«ä¸º $N_1=${N1}$ å’Œ $N_2=${N2}$ï¼Œåœ¨ç›¸åŒè®¾è®¡æŒ‡æ ‡ä¸‹ï¼š`,
                                options: shuffleOptions([
                                    { text: `$N_2=${N2}$é˜¶çš„è¿‡æ¸¡å¸¦æ›´çª„ï¼ˆæ›´é™¡å³­ï¼‰`, correct: true },
                                    { text: `$N_1=${N1}$é˜¶çš„è¿‡æ¸¡å¸¦æ›´çª„`, correct: false },
                                    { text: 'ä¸¤è€…è¿‡æ¸¡å¸¦å®½åº¦ç›¸åŒ', correct: false },
                                    { text: 'æ— æ³•æ¯”è¾ƒ', correct: false }
                                ]),
                                explanation: `Butterworthæ»¤æ³¢å™¨é˜¶æ•°è¶Šé«˜ï¼Œè¿‡æ¸¡å¸¦è¶Šçª„ï¼ˆè¡°å‡è¶Šé™¡å³­ï¼‰ï¼Œä½†è®¡ç®—å¤æ‚åº¦ä¹Ÿè¶Šé«˜ã€‚è¿™æ˜¯æ»¤æ³¢å™¨è®¾è®¡ä¸­çš„åŸºæœ¬æƒè¡¡ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹4: butterå‡½æ•°è¾“å‡º
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `<code>[num, den] = butter(N, Wn, 's')</code> è¿”å›çš„æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'æ¨¡æ‹Ÿæ»¤æ³¢å™¨çš„ä¼ é€’å‡½æ•°ç³»æ•°ï¼ˆåˆ†å­numï¼Œåˆ†æ¯denï¼‰', correct: true },
                                    { text: 'æ•°å­—æ»¤æ³¢å™¨çš„å·®åˆ†æ–¹ç¨‹ç³»æ•°', correct: false },
                                    { text: 'æ»¤æ³¢å™¨çš„é›¶æç‚¹', correct: false },
                                    { text: 'é¢‘ç‡å“åº”æ•°æ®', correct: false }
                                ]),
                                explanation: `butterå‡½æ•°è¿”å›ä¼ é€’å‡½æ•° $H(s) = \\frac{num(s)}{den(s)}$ çš„ç³»æ•°ã€‚åŠ 's'å¾—åˆ°æ¨¡æ‹Ÿæ»¤æ³¢å™¨ï¼Œéœ€è¦å†ç”¨bilinearè½¬æ¢ä¸ºæ•°å­—æ»¤æ³¢å™¨ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹5: ä¸å…¶ä»–æ»¤æ³¢å™¨æ¯”è¾ƒ
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `åœ¨ç›¸åŒè®¾è®¡æŒ‡æ ‡ä¸‹ï¼ŒButterworthæ»¤æ³¢å™¨ä¸Chebyshev Iæ»¤æ³¢å™¨ç›¸æ¯”ï¼š`,
                                options: shuffleOptions([
                                    { text: 'Butterworthéœ€è¦æ›´é«˜çš„é˜¶æ•°', correct: true },
                                    { text: 'Butterworthéœ€è¦æ›´ä½çš„é˜¶æ•°', correct: false },
                                    { text: 'ä¸¤è€…é˜¶æ•°ç›¸åŒ', correct: false },
                                    { text: 'Butterworthæœ‰é€šå¸¦æ³¢çº¹', correct: false }
                                ]),
                                explanation: `ä¸ºè¾¾åˆ°ç›¸åŒçš„é˜»å¸¦è¡°å‡ï¼ŒButterworthå› ä¸ºé€šå¸¦æœ€å¹³å¦ï¼Œéœ€è¦æ¯”Chebyshevæ›´é«˜çš„é˜¶æ•°ã€‚Chebyshevç”¨é€šå¸¦æ³¢çº¹æ¢å–äº†æ›´çª„çš„è¿‡æ¸¡å¸¦ã€‚`
                            };
                        }
                    }
                ]
            },

            // çŸ¥è¯†ç‚¹3: Chebyshev Iå‹æ»¤æ³¢å™¨
            chebyshev: {
                id: 'chebyshev',
                name: 'Chebyshev Iå‹æ»¤æ³¢å™¨è®¾è®¡',
                description: 'ç†è§£Chebyshev Iå‹æ»¤æ³¢å™¨çš„ç­‰æ³¢çº¹é€šå¸¦ç‰¹æ€§',
                questionGenerators: [
                    // é¢˜å‹1: æ ¸å¿ƒç‰¹æ€§
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `Chebyshev Iå‹æ»¤æ³¢å™¨çš„æ ¸å¿ƒç‰¹æ€§æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'é€šå¸¦ç­‰æ³¢çº¹ï¼Œé˜»å¸¦å•è°ƒä¸‹é™', correct: true },
                                    { text: 'é€šå¸¦å’Œé˜»å¸¦éƒ½æ˜¯ç­‰æ³¢çº¹', correct: false },
                                    { text: 'é€šå¸¦æœ€å¤§å¹³å¦', correct: false },
                                    { text: 'é˜»å¸¦ç­‰æ³¢çº¹ï¼Œé€šå¸¦å•è°ƒ', correct: false }
                                ]),
                                explanation: `Chebyshev Iå‹åœ¨é€šå¸¦å†…æœ‰ç­‰æ³¢çº¹ï¼ˆæ³¢åŠ¨å¹…åº¦ç”±Rpå‚æ•°æ§åˆ¶ï¼‰ï¼Œåœ¨é˜»å¸¦å•è°ƒä¸‹é™ã€‚ä¸ä¹‹å¯¹åº”ï¼ŒChebyshev IIå‹æ˜¯é€šå¸¦å¹³å¦ã€é˜»å¸¦ç­‰æ³¢çº¹ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹2: Rpå‚æ•°å«ä¹‰
                    {
                        type: 'single',
                        generate: () => {
                            const Rp = (Math.random() * 0.9 + 0.1).toFixed(1);
                            return {
                                question: `åœ¨ <code>cheby1(N, Rp, Wn, 's')</code> ä¸­ï¼Œ<code>Rp = ${Rp}</code> è¡¨ç¤ºï¼š`,
                                options: shuffleOptions([
                                    { text: `é€šå¸¦å†…æœ€å¤§è¡°å‡ä¸º ${Rp} dB`, correct: true },
                                    { text: `é˜»å¸¦æœ€å°è¡°å‡ä¸º ${Rp} dB`, correct: false },
                                    { text: `é€šå¸¦å¢ç›Šä¸º ${Rp} dB`, correct: false },
                                    { text: `è¿‡æ¸¡å¸¦å®½åº¦ä¸º ${Rp} Hz`, correct: false }
                                ]),
                                explanation: `Rpæ˜¯é€šå¸¦æ³¢çº¹å‚æ•°ï¼Œè¡¨ç¤ºé€šå¸¦å†…å¹…åº¦å“åº”çš„æœ€å¤§è¡°å‡ï¼ˆä»¥dBä¸ºå•ä½ï¼‰ã€‚ä¾‹å¦‚Rp=0.5è¡¨ç¤ºé€šå¸¦å†…å¹…åº¦æ³¢åŠ¨ä¸è¶…è¿‡0.5dBã€‚`
                            };
                        }
                    },
                    // é¢˜å‹3: ä¸Butterworthé˜¶æ¬¡æ¯”è¾ƒ
                    {
                        type: 'single',
                        generate: () => {
                            const N_butt = Math.floor(Math.random() * 3) + 4;
                            const N_cheb = N_butt - 1;
                            return {
                                question: `æŸè®¾è®¡æŒ‡æ ‡ä¸‹ï¼ŒButterworthéœ€è¦ ${N_butt} é˜¶ï¼Œè€ŒChebyshev Iå‹åªéœ€è¦ ${N_cheb} é˜¶ã€‚è¿™æ˜¯å› ä¸ºï¼š`,
                                options: shuffleOptions([
                                    { text: 'Chebyshev Iç”¨é€šå¸¦æ³¢çº¹æ¢å–äº†æ›´çª„çš„è¿‡æ¸¡å¸¦', correct: true },
                                    { text: 'Chebyshev Içš„ç®—æ³•æ›´å…ˆè¿›', correct: false },
                                    { text: 'Butterworthè®¾è®¡æœ‰è¯¯', correct: false },
                                    { text: 'éšæœºçš„ï¼Œæ²¡æœ‰è§„å¾‹', correct: false }
                                ]),
                                explanation: `Chebyshev Iå…è®¸é€šå¸¦æœ‰ç­‰æ³¢çº¹ï¼ˆç‰ºç‰²å¹³å¦æ€§ï¼‰ï¼Œä½œä¸ºä»£ä»·è·å¾—äº†æ›´é™¡å³­çš„è¿‡æ¸¡å¸¦ï¼Œå› æ­¤è¾¾åˆ°ç›¸åŒæŒ‡æ ‡éœ€è¦æ›´ä½çš„é˜¶æ•°ã€‚è¿™æ˜¯æ»¤æ³¢å™¨è®¾è®¡çš„ç»å…¸æƒè¡¡ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹4: cheb1ordå‡½æ•°
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `<code>cheb1ord</code> å’Œ <code>buttord</code> å‡½æ•°çš„è¾“å…¥å‚æ•°ç›¸åŒï¼Œä½†è¿”å›çš„é˜¶æ•° N é€šå¸¸ï¼š`,
                                options: shuffleOptions([
                                    { text: 'cheb1ord è¿”å›çš„é˜¶æ•°æ›´ä½', correct: true },
                                    { text: 'buttord è¿”å›çš„é˜¶æ•°æ›´ä½', correct: false },
                                    { text: 'ä¸¤è€…è¿”å›ç›¸åŒçš„é˜¶æ•°', correct: false },
                                    { text: 'æ— æ³•ç¡®å®š', correct: false }
                                ]),
                                explanation: `å› ä¸ºChebyshev Iå…è®¸é€šå¸¦æ³¢çº¹ï¼Œæ‰€ä»¥åœ¨ç›¸åŒçš„é€šå¸¦/é˜»å¸¦æŒ‡æ ‡ä¸‹ï¼Œcheb1ordè¿”å›çš„é˜¶æ•°æ¯”buttordä½ã€‚è¿™æ˜¯ç”¨æ³¢çº¹æ¢æ•ˆç‡çš„ä½“ç°ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹5: æ³¢çº¹çš„å·¥ç¨‹æ„ä¹‰
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `åœ¨éŸ³é¢‘å¤„ç†ä¸­ï¼Œé€šå¸¸ä¸é€‰æ‹©Chebyshev Iæ»¤æ³¢å™¨çš„ä¸»è¦åŸå› æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'é€šå¸¦æ³¢çº¹ä¼šå¯¼è‡´éŸ³é¢‘ä¿¡å·çš„é¢‘ç‡æˆåˆ†è¢«ä¸å‡åŒ€æ”¾å¤§/è¡°å‡', correct: true },
                                    { text: 'Chebyshev Iè®¡ç®—é‡å¤ªå¤§', correct: false },
                                    { text: 'Chebyshev Iä¸èƒ½è®¾è®¡ä½é€šæ»¤æ³¢å™¨', correct: false },
                                    { text: 'Chebyshev Iåªèƒ½ç”¨äºæ¨¡æ‹Ÿç”µè·¯', correct: false }
                                ]),
                                explanation: `éŸ³é¢‘åº”ç”¨å¯¹é€šå¸¦å¹³å¦åº¦è¦æ±‚é«˜ï¼Œæ³¢çº¹ä¼šé€ æˆéŸ³è‰²å¤±çœŸã€‚å› æ­¤éŸ³é¢‘å¤„ç†é€šå¸¸é€‰æ‹©Butterworthï¼ˆæœ€å¤§å¹³å¦ï¼‰è€ŒéChebyshevã€‚ä½†åœ¨é€šä¿¡ç­‰å¯¹æ³¢çº¹ä¸æ•æ„Ÿçš„é¢†åŸŸï¼ŒChebyshevæ›´å—æ¬¢è¿ã€‚`
                            };
                        }
                    }
                ]
            },

            // çŸ¥è¯†ç‚¹4: Ellipticæ»¤æ³¢å™¨
            elliptic: {
                id: 'elliptic',
                name: 'Ellipticï¼ˆæ¤­åœ†ï¼‰æ»¤æ³¢å™¨è®¾è®¡',
                description: 'ç†è§£Ellipticæ»¤æ³¢å™¨çš„åŒç­‰æ³¢çº¹ç‰¹æ€§å’Œæœ€çª„è¿‡æ¸¡å¸¦',
                questionGenerators: [
                    // é¢˜å‹1: æ ¸å¿ƒç‰¹æ€§
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `Ellipticï¼ˆæ¤­åœ†ï¼‰æ»¤æ³¢å™¨çš„æ ¸å¿ƒç‰¹æ€§æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'é€šå¸¦å’Œé˜»å¸¦éƒ½æ˜¯ç­‰æ³¢çº¹ï¼Œè¿‡æ¸¡å¸¦æœ€çª„', correct: true },
                                    { text: 'é€šå¸¦æœ€å¤§å¹³å¦', correct: false },
                                    { text: 'åªæœ‰é€šå¸¦ç­‰æ³¢çº¹', correct: false },
                                    { text: 'åªæœ‰é˜»å¸¦ç­‰æ³¢çº¹', correct: false }
                                ]),
                                explanation: `Ellipticæ»¤æ³¢å™¨åœ¨é€šå¸¦å’Œé˜»å¸¦éƒ½æœ‰ç­‰æ³¢çº¹ï¼Œä½œä¸ºä»£ä»·ï¼Œå®ƒèƒ½åœ¨ç›¸åŒé˜¶æ•°ä¸‹å®ç°æœ€çª„çš„è¿‡æ¸¡å¸¦ï¼ˆæœ€é™¡å³­çš„è¡°å‡ï¼‰ã€‚è¿™æ˜¯"å…¨é¢å¦¥å"æ¢å–æœ€é«˜æ•ˆç‡çš„è®¾è®¡ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹2: ellipå‡½æ•°å‚æ•°
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `<code>ellip(N, Rp, Rs, Wn, 's')</code> æ¯” <code>cheby1</code> å¤šäº†å“ªä¸ªå‚æ•°ï¼Ÿ`,
                                options: shuffleOptions([
                                    { text: 'Rsï¼ˆé˜»å¸¦æ³¢çº¹/è¡°å‡å‚æ•°ï¼‰', correct: true },
                                    { text: 'Nï¼ˆé˜¶æ•°ï¼‰', correct: false },
                                    { text: 'Wnï¼ˆæˆªæ­¢é¢‘ç‡ï¼‰', correct: false },
                                    { text: 'æ»¤æ³¢å™¨ç±»å‹', correct: false }
                                ]),
                                explanation: `å› ä¸ºEllipticæ»¤æ³¢å™¨çš„é˜»å¸¦ä¹Ÿæœ‰ç­‰æ³¢çº¹ï¼Œæ‰€ä»¥éœ€è¦æŒ‡å®šRså‚æ•°æ¥æ§åˆ¶é˜»å¸¦æ³¢çº¹å¹…åº¦ã€‚Chebyshev Ié˜»å¸¦å•è°ƒä¸‹é™ï¼Œä¸éœ€è¦Rså‚æ•°ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹3: é˜¶æ•°ä¼˜åŠ¿
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `åœ¨ä¸‰ç§ç»å…¸IIRæ»¤æ³¢å™¨ä¸­ï¼Œè¾¾åˆ°ç›¸åŒè®¾è®¡æŒ‡æ ‡æ‰€éœ€é˜¶æ•°æœ€ä½çš„æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'Ellipticï¼ˆæ¤­åœ†ï¼‰æ»¤æ³¢å™¨', correct: true },
                                    { text: 'Butterworthæ»¤æ³¢å™¨', correct: false },
                                    { text: 'Chebyshev Iå‹æ»¤æ³¢å™¨', correct: false },
                                    { text: 'ä¸‰è€…ç›¸åŒ', correct: false }
                                ]),
                                explanation: `é˜¶æ•°æ’åºï¼šButterworth > Chebyshev I â‰¥ Ellipticã€‚Ellipticç”¨åŒç­‰æ³¢çº¹æ¢å–äº†æœ€é«˜æ•ˆç‡ï¼ˆæœ€ä½é˜¶æ•°ï¼‰ï¼Œä½†ç›¸ä½å“åº”æœ€éçº¿æ€§ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹4: åº”ç”¨åœºæ™¯
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `é€šä¿¡ç³»ç»Ÿä¸­çš„ä¿¡é“é€‰æ‹©æ»¤æ³¢å™¨ï¼ˆéœ€è¦å¼ºçƒˆæŠ‘åˆ¶ç›¸é‚»ä¿¡é“ï¼‰æœ€é€‚åˆä½¿ç”¨ï¼š`,
                                options: shuffleOptions([
                                    { text: 'Ellipticæ»¤æ³¢å™¨', correct: true },
                                    { text: 'Butterworthæ»¤æ³¢å™¨', correct: false },
                                    { text: 'FIRæ»¤æ³¢å™¨', correct: false },
                                    { text: 'ä»¥ä¸Šéƒ½ä¸é€‚åˆ', correct: false }
                                ]),
                                explanation: `é€šä¿¡ç³»ç»Ÿè¦æ±‚çª„è¿‡æ¸¡å¸¦ä»¥æœ€å¤§é™åº¦æŠ‘åˆ¶ç›¸é‚»ä¿¡é“å¹²æ‰°ï¼Œä¸”å¯¹æ³¢çº¹ä¸æ•æ„Ÿï¼ˆæ•°å­—è°ƒåˆ¶å¯å®¹å¿ï¼‰ã€‚Ellipticçš„æœ€çª„è¿‡æ¸¡å¸¦æ­£å¥½æ»¡è¶³éœ€æ±‚ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹5: é˜»å¸¦ç‰¹æ€§
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `è§‚å¯ŸEllipticæ»¤æ³¢å™¨çš„å¹…åº¦å“åº”ï¼Œå…¶é˜»å¸¦ç‰¹ç‚¹æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'æœ‰æ˜æ˜¾çš„æ³¢çº¹ï¼ˆä¸Šä¸‹æ³¢åŠ¨ï¼‰ï¼Œä½†ä¸è¶…è¿‡RsæŒ‡å®šçš„è¡°å‡', correct: true },
                                    { text: 'å•è°ƒä¸‹é™åˆ°è´Ÿæ— ç©·', correct: false },
                                    { text: 'æ’å®šåœ¨-Rs dB', correct: false },
                                    { text: 'ä¸Butterworthç›¸åŒ', correct: false }
                                ]),
                                explanation: `Ellipticæ»¤æ³¢å™¨çš„é˜»å¸¦æœ‰ç­‰æ³¢çº¹ç‰¹æ€§ï¼Œè¡°å‡åœ¨Rsé™„è¿‘æ³¢åŠ¨ï¼Œå½¢æˆå¤šä¸ª"è°·"ã€‚è¿™ä¸Butterworth/Chebyshev Içš„å•è°ƒä¸‹é™é˜»å¸¦ä¸åŒã€‚`
                            };
                        }
                    }
                ]
            },

            // çŸ¥è¯†ç‚¹5: åŒçº¿æ€§å˜æ¢
            bilinear: {
                id: 'bilinear',
                name: 'åŒçº¿æ€§å˜æ¢ (Bilinear Transform)',
                description: 'ç†è§£såŸŸåˆ°zåŸŸçš„æ˜ å°„åŠMATLABå®ç°',
                questionGenerators: [
                    // é¢˜å‹1: å˜æ¢å…¬å¼
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `åŒçº¿æ€§å˜æ¢çš„æ ¸å¿ƒæ˜ å°„å…³ç³»æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: `$s = \\frac{2}{T}\\frac{z-1}{z+1}$ æˆ– $s = 2F_s\\frac{z-1}{z+1}$`, correct: true },
                                    { text: `$s = z$`, correct: false },
                                    { text: `$s = e^{zT}$`, correct: false },
                                    { text: `$s = \\frac{z}{T}$`, correct: false }
                                ]),
                                explanation: `åŒçº¿æ€§å˜æ¢ç”¨æœ‰ç†å‡½æ•°é€¼è¿‘ $z = e^{sT}$ï¼Œå¾—åˆ° $s = \\frac{2}{T}\\frac{z-1}{z+1}$ã€‚å…¶ä¸­T=1/Fsä¸ºé‡‡æ ·å‘¨æœŸã€‚è¿™ä¿è¯äº†så¹³é¢å·¦åŠéƒ¨æ˜ å°„åˆ°zå¹³é¢å•ä½åœ†å†…ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹2: bilinearå‡½æ•°ç”¨æ³•
                    {
                        type: 'single',
                        generate: () => {
                            const Fs = [44100, 48000, 80000, 96000][Math.floor(Math.random() * 4)];
                            return {
                                question: `å·²æœ‰æ¨¡æ‹Ÿæ»¤æ³¢å™¨ç³»æ•° num_a, den_aï¼Œé‡‡æ ·ç‡ Fs=${Fs} Hzï¼Œè½¬æ¢ä¸ºæ•°å­—æ»¤æ³¢å™¨çš„MATLABä»£ç æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: `<code>[num_d, den_d] = bilinear(num_a, den_a, ${Fs});</code>`, correct: true },
                                    { text: `<code>[num_d, den_d] = bilinear(num_a, den_a);</code>`, correct: false },
                                    { text: `<code>[num_d, den_d] = tf2zp(num_a, den_a, ${Fs});</code>`, correct: false },
                                    { text: `<code>[num_d, den_d] = butter(num_a, den_a, ${Fs});</code>`, correct: false }
                                ]),
                                explanation: `bilinearå‡½æ•°éœ€è¦ä¸‰ä¸ªè¾“å…¥ï¼šæ¨¡æ‹Ÿæ»¤æ³¢å™¨çš„åˆ†å­ç³»æ•°ã€åˆ†æ¯ç³»æ•°ã€é‡‡æ ·é¢‘ç‡ã€‚è¿”å›æ•°å­—æ»¤æ³¢å™¨çš„åˆ†å­åˆ†æ¯ç³»æ•°ï¼Œå¯ç›´æ¥ç”¨äºfilteræˆ–freqzã€‚`
                            };
                        }
                    },
                    // é¢˜å‹3: ç¨³å®šæ€§ä¿æŒ
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `åŒçº¿æ€§å˜æ¢çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'å°†så¹³é¢çš„å·¦åŠéƒ¨ï¼ˆç¨³å®šåŒºåŸŸï¼‰æ˜ å°„åˆ°zå¹³é¢çš„å•ä½åœ†å†…', correct: true },
                                    { text: 'å°†så¹³é¢æ˜ å°„åˆ°zå¹³é¢çš„å³åŠéƒ¨', correct: false },
                                    { text: 'å¯èƒ½å°†ç¨³å®šçš„æ¨¡æ‹Ÿæ»¤æ³¢å™¨å˜æˆä¸ç¨³å®šçš„æ•°å­—æ»¤æ³¢å™¨', correct: false },
                                    { text: 'åªé€‚ç”¨äºFIRæ»¤æ³¢å™¨', correct: false }
                                ]),
                                explanation: `åŒçº¿æ€§å˜æ¢ä¿æŒç¨³å®šæ€§ï¼šså¹³é¢å·¦åŠéƒ¨ â†’ zå¹³é¢å•ä½åœ†å†…ï¼Œè™šè½´ â†’ å•ä½åœ†ï¼Œå³åŠéƒ¨ â†’ å•ä½åœ†å¤–ã€‚å› æ­¤ç¨³å®šçš„æ¨¡æ‹Ÿæ»¤æ³¢å™¨å¿…ç„¶è½¬æ¢ä¸ºç¨³å®šçš„æ•°å­—æ»¤æ³¢å™¨ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹4: ä¸å†²æ¿€ä¸å˜æ³•æ¯”è¾ƒ
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `ä¸å†²æ¿€ä¸å˜æ³•ç›¸æ¯”ï¼ŒåŒçº¿æ€§å˜æ¢çš„ä¸»è¦ä¼˜ç‚¹æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'ä¸ä¼šäº§ç”Ÿé¢‘ç‡æ··å ', correct: true },
                                    { text: 'è®¡ç®—æ›´ç®€å•', correct: false },
                                    { text: 'é¢‘ç‡æ˜ å°„æ˜¯çº¿æ€§çš„', correct: false },
                                    { text: 'ä¸éœ€è¦é¢„ç¿˜æ›²', correct: false }
                                ]),
                                explanation: `å†²æ¿€ä¸å˜æ³•ä¼šäº§ç”Ÿé¢‘ç‡æ··å ï¼ˆé«˜é¢‘æ¨¡æ‹Ÿä¿¡å·æŠ˜å åˆ°ä½é¢‘ï¼‰ï¼Œè€ŒåŒçº¿æ€§å˜æ¢å°†æ•´ä¸ªæ¨¡æ‹Ÿé¢‘ç‡è½´å‹ç¼©åˆ° $(-\\pi, \\pi)$ï¼Œé¿å…äº†æ··å ã€‚ä»£ä»·æ˜¯éœ€è¦é¢„ç¿˜æ›²è¡¥å¿é¢‘ç‡ç•¸å˜ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹5: è®¾è®¡æµç¨‹
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `ä½¿ç”¨åŒçº¿æ€§å˜æ¢æ³•è®¾è®¡IIRæ•°å­—æ»¤æ³¢å™¨çš„æ­£ç¡®é¡ºåºæ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'æ•°å­—æŒ‡æ ‡ â†’ é¢„ç¿˜æ›² â†’ è®¾è®¡æ¨¡æ‹Ÿæ»¤æ³¢å™¨ â†’ åŒçº¿æ€§å˜æ¢', correct: true },
                                    { text: 'è®¾è®¡æ¨¡æ‹Ÿæ»¤æ³¢å™¨ â†’ åŒçº¿æ€§å˜æ¢ â†’ é¢„ç¿˜æ›²', correct: false },
                                    { text: 'ç›´æ¥è®¾è®¡æ•°å­—æ»¤æ³¢å™¨ï¼Œä¸éœ€è¦æ¨¡æ‹ŸåŸå‹', correct: false },
                                    { text: 'åŒçº¿æ€§å˜æ¢ â†’ è®¾è®¡æ¨¡æ‹Ÿæ»¤æ³¢å™¨ â†’ é¢„ç¿˜æ›²', correct: false }
                                ]),
                                explanation: `æ ‡å‡†æµç¨‹ï¼š1)ä»æ•°å­—æŒ‡æ ‡å‡ºå‘ï¼›2)é¢„ç¿˜æ›²å¾—åˆ°æ¨¡æ‹ŸæŒ‡æ ‡ï¼›3)è®¾è®¡æ¨¡æ‹ŸåŸå‹ï¼ˆButterworth/Chebyshev/Ellipticï¼‰ï¼›4)åŒçº¿æ€§å˜æ¢å›æ•°å­—åŸŸã€‚`
                            };
                        }
                    }
                ]
            },

            // çŸ¥è¯†ç‚¹6: æ»¤æ³¢å™¨æ€§èƒ½å¯¹æ¯”ä¸é€‰æ‹©
            filterComparison: {
                id: 'filterComparison',
                name: 'æ»¤æ³¢å™¨æ€§èƒ½å¯¹æ¯”ä¸åº”ç”¨é€‰æ‹©',
                description: 'ç†è§£ä¸‰ç§æ»¤æ³¢å™¨çš„æƒè¡¡åŠå·¥ç¨‹åº”ç”¨åœºæ™¯',
                questionGenerators: [
                    // é¢˜å‹1: ç»¼åˆå¯¹æ¯”è¡¨
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `å…³äºä¸‰ç§æ»¤æ³¢å™¨çš„å¯¹æ¯”ï¼Œä»¥ä¸‹å“ªä¸ªæè¿°æ˜¯<strong>é”™è¯¯</strong>çš„ï¼Ÿ`,
                                options: shuffleOptions([
                                    { text: 'Butterworthçš„è¿‡æ¸¡å¸¦æœ€çª„', correct: true },
                                    { text: 'Butterworthçš„é€šå¸¦æœ€å¹³å¦', correct: false },
                                    { text: 'Ellipticåœ¨ç›¸åŒæŒ‡æ ‡ä¸‹é˜¶æ•°æœ€ä½', correct: false },
                                    { text: 'Chebyshev Içš„é€šå¸¦æœ‰ç­‰æ³¢çº¹', correct: false }
                                ]),
                                explanation: `é”™è¯¯ï¼Butterworthçš„è¿‡æ¸¡å¸¦æœ€å®½ï¼ˆæœ€å¹³ç¼“ï¼‰ï¼ŒEllipticæœ€çª„ã€‚æ­£ç¡®æ’åºï¼šè¿‡æ¸¡å¸¦å®½åº¦ Butterworth > Chebyshev I > Ellipticã€‚`
                            };
                        }
                    },
                    // é¢˜å‹2: è®¡ç®—å¤æ‚åº¦
                    {
                        type: 'single',
                        generate: () => {
                            const N = Math.floor(Math.random() * 4) + 4;
                            return {
                                question: `ä¸€ä¸ª ${N} é˜¶IIRæ»¤æ³¢å™¨ï¼Œæ¯å¤„ç†ä¸€ä¸ªè¾“å…¥æ ·æœ¬å¤§çº¦éœ€è¦å¤šå°‘æ¬¡ä¹˜æ³•è¿ç®—ï¼Ÿ`,
                                options: shuffleOptions([
                                    { text: `çº¦ ${2*N} æ¬¡`, correct: true },
                                    { text: `çº¦ ${N} æ¬¡`, correct: false },
                                    { text: `çº¦ ${N*N} æ¬¡`, correct: false },
                                    { text: 'å–å†³äºè¾“å…¥ä¿¡å·é•¿åº¦', correct: false }
                                ]),
                                explanation: `Né˜¶IIRæ»¤æ³¢å™¨çš„å·®åˆ†æ–¹ç¨‹æœ‰N+1ä¸ªbç³»æ•°å’ŒNä¸ªaç³»æ•°ï¼ˆé™¤a[0]=1å¤–ï¼‰ï¼Œæ¯ä¸ªæ ·æœ¬éœ€è¦çº¦2Næ¬¡ä¹˜æ³•å’Œ2Næ¬¡åŠ æ³•ã€‚è¿™æ˜¯æ»¤æ³¢å™¨é˜¶æ•°ä¸è®¡ç®—é‡çš„ç›´æ¥å…³ç³»ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹3: å®æ—¶ç³»ç»Ÿé€‰æ‹©
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `åœ¨åµŒå…¥å¼å®æ—¶ç³»ç»Ÿä¸­ï¼ˆèµ„æºæœ‰é™ï¼‰ï¼Œå¦‚æœå¿…é¡»ä½¿ç”¨IIRæ»¤æ³¢å™¨ä¸”å¯ä»¥æ¥å—æ³¢çº¹ï¼Œåº”è¯¥ä¼˜å…ˆè€ƒè™‘ï¼š`,
                                options: shuffleOptions([
                                    { text: 'Ellipticï¼Œå› ä¸ºé˜¶æ•°æœ€ä½ã€è®¡ç®—é‡æœ€å°', correct: true },
                                    { text: 'Butterworthï¼Œå› ä¸ºè®¾è®¡æœ€ç®€å•', correct: false },
                                    { text: 'Chebyshev Iï¼Œå› ä¸ºåªæœ‰é€šå¸¦æ³¢çº¹', correct: false },
                                    { text: 'ä¸‰è€…è®¡ç®—é‡ç›¸åŒï¼Œéšæ„é€‰æ‹©', correct: false }
                                ]),
                                explanation: `åµŒå…¥å¼ç³»ç»Ÿèµ„æºå—é™ï¼Œåº”é€‰æ‹©é˜¶æ•°æœ€ä½çš„æ»¤æ³¢å™¨ä»¥å‡å°‘è®¡ç®—é‡ã€åŠŸè€—å’Œå»¶è¿Ÿã€‚Ellipticé˜¶æ•°æœ€ä½ï¼Œæ˜¯èµ„æºå—é™åœºæ™¯çš„æœ€ä½³é€‰æ‹©ï¼ˆå¦‚æœæ³¢çº¹å¯æ¥å—ï¼‰ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹4: éŸ³é¢‘åº”ç”¨
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `è®¾è®¡é«˜ä¿çœŸéŸ³é¢‘ç³»ç»Ÿçš„æŠ—æ··å ä½é€šæ»¤æ³¢å™¨ï¼Œæœ€åˆé€‚çš„é€‰æ‹©æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'Butterworthï¼Œå› ä¸ºé€šå¸¦æœ€å¹³å¦ï¼Œä¸ä¼šé€ æˆéŸ³è‰²å¤±çœŸ', correct: true },
                                    { text: 'Ellipticï¼Œå› ä¸ºæ•ˆç‡æœ€é«˜', correct: false },
                                    { text: 'Chebyshev Iï¼Œå› ä¸ºè¿‡æ¸¡å¸¦è¾ƒçª„', correct: false },
                                    { text: 'ä¸‰è€…éƒ½ä¸é€‚åˆéŸ³é¢‘åº”ç”¨', correct: false }
                                ]),
                                explanation: `éŸ³é¢‘åº”ç”¨å¯¹é€šå¸¦å¹³å¦åº¦è¦æ±‚é«˜ï¼ˆäººè€³å¯¹å¹…åº¦å˜åŒ–æ•æ„Ÿï¼‰ï¼Œæ³¢çº¹ä¼šé€ æˆéŸ³è‰²å¤±çœŸã€‚Butterworthçš„æœ€å¤§å¹³å¦ç‰¹æ€§æœ€é€‚åˆéŸ³é¢‘ã€‚è¿‡æ¸¡å¸¦å®½å¯æ¥å—ï¼Œå› ä¸º18kHzä»¥ä¸Šå·²æ¥è¿‘å¬è§‰ä¸Šé™ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹5: é˜¶æ•°å‡åŠçš„å·¥ç¨‹æ„ä¹‰
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `æ»¤æ³¢å™¨é˜¶æ•°ä»12é˜¶é™ä½åˆ°6é˜¶ï¼Œå¯¹å®æ—¶ç³»ç»Ÿçš„ä¸»è¦å¥½å¤„æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'è®¡ç®—é‡å‡åŠï¼ŒåŠŸè€—é™ä½ï¼Œå»¶è¿Ÿå‡å°', correct: true },
                                    { text: 'æ»¤æ³¢æ•ˆæœå˜å¥½', correct: false },
                                    { text: 'é€šå¸¦å˜å¾—æ›´å¹³å¦', correct: false },
                                    { text: 'æ²¡æœ‰æ˜æ˜¾å¥½å¤„', correct: false }
                                ]),
                                explanation: `é˜¶æ•°å‡åŠæ„å‘³ç€ï¼š1)è®¡ç®—é‡å‡å°‘çº¦50%ï¼›2)åŠŸè€—é™ä½ï¼ˆé‡è¦ï¼ï¼‰ï¼›3)ç¾¤å»¶è¿Ÿå‡å°ï¼›4)å†…å­˜å ç”¨å‡å°‘ï¼›5)æ•°å€¼ç¨³å®šæ€§æé«˜ã€‚è¿™æ˜¯é€‰æ‹©é«˜æ•ˆç‡æ»¤æ³¢å™¨çš„æ ¸å¿ƒåŠ¨æœºã€‚`
                            };
                        }
                    }
                ]
            },

            // çŸ¥è¯†ç‚¹7: è„‰å†²å“åº”ä¸å˜æ³• (IIM) ä¸ BLT å¯¹æ¯”
            impulseInvariant: {
                id: 'impulseInvariant',
                name: 'è„‰å†²å“åº”ä¸å˜æ³• (IIM) ä¸ BLT å¯¹æ¯”',
                description: 'ç†è§£IIMçš„åŸç†ã€å±€é™æ€§ï¼Œä»¥åŠä¸ºä»€ä¹ˆå®éªŒé€‰æ‹©BLT',
                questionGenerators: [
                    // é¢˜å‹1: IIMåŸºæœ¬åŸç†
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `è„‰å†²å“åº”ä¸å˜æ³•ï¼ˆImpulse Invariant Methodï¼‰çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'è®©æ•°å­—æ»¤æ³¢å™¨çš„è„‰å†²å“åº”ç­‰äºæ¨¡æ‹Ÿæ»¤æ³¢å™¨è„‰å†²å“åº”çš„é‡‡æ ·å€¼ï¼š$h[n] = T \\cdot h_a(nT)$', correct: true },
                                    { text: 'è®©æ•°å­—æ»¤æ³¢å™¨çš„é¢‘ç‡å“åº”ä¸æ¨¡æ‹Ÿæ»¤æ³¢å™¨å®Œå…¨ç›¸åŒ', correct: false },
                                    { text: 'ç”¨æœ‰ç†å‡½æ•°é€¼è¿‘ $z = e^{sT}$', correct: false },
                                    { text: 'åœ¨så¹³é¢å’Œzå¹³é¢ä¹‹é—´å»ºç«‹åŒçº¿æ€§æ˜ å°„', correct: false }
                                ]),
                                explanation: `IIMçš„æ ¸å¿ƒï¼šä¿æŒæ—¶åŸŸè„‰å†²å“åº”çš„å¯¹åº”å…³ç³»ã€‚æ•°å­—æ»¤æ³¢å™¨çš„è„‰å†²å“åº” h[n] æ˜¯æ¨¡æ‹Ÿæ»¤æ³¢å™¨è„‰å†²å“åº” ha(t) åœ¨ t=nT å¤„çš„é‡‡æ ·å€¼ï¼ˆä¹˜ä»¥é‡‡æ ·å‘¨æœŸTï¼‰ã€‚è¿™æ˜¯ä¸€ç§ç›´è§‚çš„æ—¶åŸŸè®¾è®¡æ–¹æ³•ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹2: IIMçš„é¢‘ç‡æ··å é—®é¢˜
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `è„‰å†²å“åº”ä¸å˜æ³•çš„ä¸»è¦ç¼ºé™·æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'ä¼šäº§ç”Ÿé¢‘ç‡æ··å ï¼ˆaliasingï¼‰ï¼Œé«˜é¢‘åˆ†é‡æŠ˜å åˆ°ä½é¢‘', correct: true },
                                    { text: 'è®¡ç®—è¿‡ç¨‹å¤ªå¤æ‚', correct: false },
                                    { text: 'åªèƒ½è®¾è®¡Butterworthæ»¤æ³¢å™¨', correct: false },
                                    { text: 'éœ€è¦é¢„ç¿˜æ›²è¡¥å¿', correct: false }
                                ]),
                                explanation: `IIMå¯¹æ¨¡æ‹Ÿè„‰å†²å“åº”é‡‡æ ·ï¼Œæ ¹æ®é‡‡æ ·å®šç†ï¼Œå½“æ¨¡æ‹Ÿæ»¤æ³¢å™¨å¸¦å®½è¶…è¿‡Fs/2æ—¶ä¼šäº§ç”Ÿé¢‘ç‡æ··å ã€‚è¿™æ˜¯IIMçš„è‡´å‘½ç¼ºé™·ï¼š$H(e^{j\\omega}) = \\sum_{k=-\\infty}^{\\infty} H_a(j\\frac{\\omega-2\\pi k}{T})$ï¼Œæ±‚å’Œé¡¹è¡¨ç¤ºæ··å ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹3: ä¸ºä»€ä¹ˆå®éªŒé€‰æ‹©BLT
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `æœ¬å®éªŒé€‰æ‹©åŒçº¿æ€§å˜æ¢æ³•ï¼ˆBLTï¼‰è€Œéè„‰å†²å“åº”ä¸å˜æ³•ï¼ˆIIMï¼‰çš„ä¸»è¦åŸå› æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'BLTä¸ä¼šäº§ç”Ÿé¢‘ç‡æ··å ï¼Œé€‚ç”¨äºæ‰€æœ‰æ»¤æ³¢å™¨ç±»å‹', correct: true },
                                    { text: 'BLTè®¡ç®—æ›´ç®€å•', correct: false },
                                    { text: 'IIMåªèƒ½åœ¨MATLABä¸­ä½¿ç”¨', correct: false },
                                    { text: 'BLTçš„é¢‘ç‡æ˜ å°„æ˜¯çº¿æ€§çš„', correct: false }
                                ]),
                                explanation: `BLTå°†æ•´ä¸ªæ¨¡æ‹Ÿé¢‘ç‡è½´æ˜ å°„åˆ°æ•°å­—é¢‘ç‡ $(-\\pi, \\pi)$ï¼Œä¸ä¼šæ··å ã€‚IIMåªé€‚åˆå¸¦é™çš„ä½é€š/å¸¦é€šæ»¤æ³¢å™¨ï¼ˆé«˜é€šå’Œå¸¦é˜»ä¼šä¸¥é‡æ··å ï¼‰ã€‚BLTçš„éçº¿æ€§é¢‘ç‡æ˜ å°„å¯ä»¥é€šè¿‡é¢„ç¿˜æ›²è¡¥å¿ï¼Œå› æ­¤æ˜¯å·¥ç¨‹ä¸­çš„ä¸»æµæ–¹æ³•ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹4: IIM vs BLT é¢‘ç‡æ˜ å°„å¯¹æ¯”
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `å…³äºIIMå’ŒBLTçš„é¢‘ç‡æ˜ å°„ï¼Œä»¥ä¸‹è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'IIMæ˜¯çº¿æ€§æ˜ å°„ $\\omega = \\Omega T$ï¼›BLTæ˜¯éçº¿æ€§æ˜ å°„ $\\omega = 2\\arctan(\\Omega T/2)$', correct: true },
                                    { text: 'ä¸¤è€…çš„é¢‘ç‡æ˜ å°„éƒ½æ˜¯çº¿æ€§çš„', correct: false },
                                    { text: 'ä¸¤è€…çš„é¢‘ç‡æ˜ å°„éƒ½æ˜¯éçº¿æ€§çš„', correct: false },
                                    { text: 'BLTæ˜¯çº¿æ€§æ˜ å°„ï¼ŒIIMæ˜¯éçº¿æ€§æ˜ å°„', correct: false }
                                ]),
                                explanation: `IIMçš„ä¼˜ç‚¹æ˜¯é¢‘ç‡æ˜ å°„çº¿æ€§ï¼ˆ$\\omega = \\Omega T$ï¼‰ï¼Œä½é¢‘å¤„ä¿æŒè‰¯å¥½å¯¹åº”ï¼›ç¼ºç‚¹æ˜¯é«˜é¢‘æ··å ã€‚BLTçš„é¢‘ç‡æ˜ å°„éçº¿æ€§ï¼Œéœ€è¦é¢„ç¿˜æ›²è¡¥å¿ï¼Œä½†ä¸ä¼šæ··å ã€‚è¿™æ˜¯ä¸¤ç§æ–¹æ³•çš„æ ¸å¿ƒæƒè¡¡ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹5: IIMé€‚ç”¨åœºæ™¯
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `è„‰å†²å“åº”ä¸å˜æ³•ï¼ˆIIMï¼‰é€‚åˆç”¨äºè®¾è®¡ï¼š`,
                                options: shuffleOptions([
                                    { text: 'å¸¦é™çš„ä½é€šæˆ–å¸¦é€šæ»¤æ³¢å™¨ï¼Œä¸”é‡‡æ ·ç‡è¶³å¤Ÿé«˜', correct: true },
                                    { text: 'é«˜é€šæ»¤æ³¢å™¨', correct: false },
                                    { text: 'å¸¦é˜»ï¼ˆé™·æ³¢ï¼‰æ»¤æ³¢å™¨', correct: false },
                                    { text: 'ä»»æ„ç±»å‹çš„æ»¤æ³¢å™¨', correct: false }
                                ]),
                                explanation: `IIMåªé€‚åˆå¸¦é™æ»¤æ³¢å™¨ï¼ˆä½é€šã€å¸¦é€šï¼‰ï¼Œå› ä¸ºå®ƒä»¬çš„é«˜é¢‘å“åº”è‡ªç„¶è¡°å‡ï¼Œæ··å å½±å“è¾ƒå°ã€‚é«˜é€šå’Œå¸¦é˜»æ»¤æ³¢å™¨åœ¨é«˜é¢‘æœ‰å“åº”ï¼ŒIIMä¼šå¯¼è‡´ä¸¥é‡æ··å ï¼Œä¸å¯ä½¿ç”¨ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹6: MATLABä¸­çš„impinvarå‡½æ•°
                    {
                        type: 'single',
                        generate: () => {
                            const Fs = [44100, 48000, 80000][Math.floor(Math.random() * 3)];
                            return {
                                question: `MATLABä¸­ä½¿ç”¨è„‰å†²å“åº”ä¸å˜æ³•çš„å‡½æ•°æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: `<code>impinvar(num_a, den_a, Fs)</code>`, correct: true },
                                    { text: `<code>bilinear(num_a, den_a, Fs)</code>`, correct: false },
                                    { text: `<code>impulse(num_a, den_a, Fs)</code>`, correct: false },
                                    { text: `<code>iim(num_a, den_a, Fs)</code>`, correct: false }
                                ]),
                                explanation: `impinvarå‡½æ•°å®ç°è„‰å†²å“åº”ä¸å˜æ³•ï¼šè¾“å…¥æ¨¡æ‹Ÿæ»¤æ³¢å™¨ç³»æ•°å’Œé‡‡æ ·é¢‘ç‡ï¼Œè¿”å›æ•°å­—æ»¤æ³¢å™¨ç³»æ•°ã€‚ä½†ç”±äºæ··å é—®é¢˜ï¼Œå®é™…å·¥ç¨‹ä¸­æ›´å¸¸ç”¨bilinearï¼ˆåŒçº¿æ€§å˜æ¢ï¼‰ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹7: IIMçš„æ—¶åŸŸç‰¹æ€§ä¿æŒ
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `ä¸åŒçº¿æ€§å˜æ¢ç›¸æ¯”ï¼Œè„‰å†²å“åº”ä¸å˜æ³•çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'ç²¾ç¡®ä¿æŒæ¨¡æ‹Ÿæ»¤æ³¢å™¨çš„æ—¶åŸŸè„‰å†²å“åº”ç‰¹æ€§', correct: true },
                                    { text: 'ä¸ä¼šäº§ç”Ÿé¢‘ç‡æ··å ', correct: false },
                                    { text: 'é€‚ç”¨äºæ‰€æœ‰æ»¤æ³¢å™¨ç±»å‹', correct: false },
                                    { text: 'é¢‘ç‡å“åº”å®Œå…¨ä¸€è‡´', correct: false }
                                ]),
                                explanation: `IIMçš„è®¾è®¡ç›®æ ‡å°±æ˜¯ä¿æŒæ—¶åŸŸè„‰å†²å“åº”ã€‚å½“éœ€è¦ç²¾ç¡®æ¨¡æ‹ŸæŸä¸ªæ¨¡æ‹Ÿç³»ç»Ÿçš„æ—¶åŸŸè¡Œä¸ºæ—¶ï¼ˆå¦‚ä»¿çœŸï¼‰ï¼ŒIIMå¯èƒ½æ›´åˆé€‚ã€‚ä½†åœ¨å¤§å¤šæ•°é¢‘åŸŸæŒ‡æ ‡è®¾è®¡åœºæ™¯ä¸­ï¼ŒBLTå› æ— æ··å è€Œæ›´å—æ¬¢è¿ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹8: æ··å äº§ç”Ÿçš„æœºç†
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `IIMäº§ç”Ÿé¢‘ç‡æ··å çš„æ ¹æœ¬åŸå› æ˜¯ï¼š`,
                                options: shuffleOptions([
                                    { text: 'å¯¹æ¨¡æ‹Ÿè„‰å†²å“åº”é‡‡æ ·ï¼Œè¿åäº†é‡‡æ ·å®šç†ï¼ˆå½“å¸¦å®½è¶…è¿‡Fs/2æ—¶ï¼‰', correct: true },
                                    { text: 'ä½¿ç”¨äº†éçº¿æ€§å˜æ¢', correct: false },
                                    { text: 'MATLABå®ç°æœ‰bug', correct: false },
                                    { text: 'é¢„ç¿˜æ›²å…¬å¼é”™è¯¯', correct: false }
                                ]),
                                explanation: `IIMæœ¬è´¨æ˜¯å¯¹è¿ç»­ä¿¡å·ha(t)é‡‡æ ·å¾—åˆ°h[n]ã€‚æ ¹æ®é‡‡æ ·å®šç†ï¼Œå¦‚æœha(t)çš„é¢‘è°±è¶…è¿‡Fs/2ï¼Œé‡‡æ ·åå¿…ç„¶äº§ç”Ÿé¢‘ç‡æ··å ã€‚BLTé€šè¿‡ä»£æ•°å˜æ¢é¿å…äº†é‡‡æ ·è¿‡ç¨‹ï¼Œå› æ­¤ä¸ä¼šæ··å ã€‚`
                            };
                        }
                    },
                    // é¢˜å‹9: å·¥ç¨‹åº”ç”¨ä¸­çš„é€‰æ‹©
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `åœ¨å·¥ç¨‹å®è·µä¸­ï¼Œè®¾è®¡IIRæ•°å­—æ»¤æ³¢å™¨æ—¶ï¼š`,
                                options: shuffleOptions([
                                    { text: 'åŒçº¿æ€§å˜æ¢æ³•æ˜¯ä¸»æµæ–¹æ³•ï¼Œè„‰å†²å“åº”ä¸å˜æ³•è¾ƒå°‘ä½¿ç”¨', correct: true },
                                    { text: 'è„‰å†²å“åº”ä¸å˜æ³•æ˜¯ä¸»æµæ–¹æ³•', correct: false },
                                    { text: 'ä¸¤ç§æ–¹æ³•ä½¿ç”¨é¢‘ç‡ç›¸å½“', correct: false },
                                    { text: 'éƒ½ä¸å¸¸ç”¨ï¼Œç›´æ¥è®¾è®¡æ•°å­—æ»¤æ³¢å™¨', correct: false }
                                ]),
                                explanation: `ç”±äºBLTæ— æ··å ã€é€‚ç”¨æ€§å¹¿ï¼Œå®ƒæ˜¯å·¥ä¸šç•Œè®¾è®¡IIRæ»¤æ³¢å™¨çš„ä¸»æµæ–¹æ³•ã€‚IIMä»…åœ¨ç‰¹æ®Šåœºæ™¯ï¼ˆå¦‚ç²¾ç¡®æ—¶åŸŸä»¿çœŸã€çª„å¸¦ä½é€šï¼‰ä¸‹ä½¿ç”¨ã€‚MATLABçš„butter/cheby1/ellipç­‰å‡½æ•°é»˜è®¤éƒ½åŸºäºBLTã€‚`
                            };
                        }
                    },
                    // é¢˜å‹10: é«˜é€šæ»¤æ³¢å™¨ä¸IIM
                    {
                        type: 'single',
                        generate: () => {
                            return {
                                question: `ä¸ºä»€ä¹ˆä¸èƒ½ç”¨è„‰å†²å“åº”ä¸å˜æ³•è®¾è®¡é«˜é€šæ»¤æ³¢å™¨ï¼Ÿ`,
                                options: shuffleOptions([
                                    { text: 'é«˜é€šæ»¤æ³¢å™¨åœ¨é«˜é¢‘æœ‰å“åº”ï¼Œé‡‡æ ·åä¼šä¸¥é‡æ··å åˆ°ä½é¢‘', correct: true },
                                    { text: 'MATLABçš„impinvarå‡½æ•°ä¸æ”¯æŒé«˜é€š', correct: false },
                                    { text: 'é«˜é€šæ»¤æ³¢å™¨æ²¡æœ‰æ¨¡æ‹ŸåŸå‹', correct: false },
                                    { text: 'é«˜é€šæ»¤æ³¢å™¨çš„è„‰å†²å“åº”æ˜¯æ— é™é•¿çš„', correct: false }
                                ]),
                                explanation: `ç†æƒ³é«˜é€šæ»¤æ³¢å™¨åœ¨é«˜é¢‘ï¼ˆFs/2ä»¥ä¸Šï¼‰æœ‰å“åº”ï¼ŒIIMé‡‡æ ·æ—¶è¿™äº›é«˜é¢‘åˆ†é‡å¿…ç„¶æŠ˜å åˆ°ä½é¢‘åŒºåŸŸï¼Œç ´åæ»¤æ³¢å™¨çš„é«˜é€šç‰¹æ€§ã€‚å› æ­¤é«˜é€šå’Œå¸¦é˜»æ»¤æ³¢å™¨å¿…é¡»ç”¨BLTè®¾è®¡ã€‚`
                            };
                        }
                    }
                ]
            }
        };

        // ==================== å·¥å…·å‡½æ•° ====================
        function shuffleArray(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function shuffleOptions(options) {
            const shuffled = shuffleArray(options);
            const correctIndex = shuffled.findIndex(opt => opt.correct);
            return {
                options: shuffled,
                correctIndex: correctIndex
            };
        }

        // ==================== å­¦ç”Ÿæ•°æ®ç®¡ç† ====================
        let studentData = {
            id: '',
            name: '',
            currentTopicIndex: 0,
            topicStats: {},
            startTime: null
        };

        const topics = Object.values(knowledgeBase);

        function initializeStats() {
            topics.forEach(topic => {
                studentData.topicStats[topic.id] = {
                    attempts: 0,
                    correct: 0,
                    questions: []
                };
            });
        }

        // ==================== ä¸»æµç¨‹å‡½æ•° ====================
        function startQuiz() {
            const id = document.getElementById('studentId').value.trim();
            const name = document.getElementById('studentName').value.trim();
            
            if (!id || !name) {
                alert('è¯·å¡«å†™å­¦å·å’Œå§“åï¼');
                return;
            }

            studentData.id = id;
            studentData.name = name;
            studentData.startTime = new Date();
            initializeStats();

            document.querySelector('.login-section').classList.remove('active');
            document.querySelector('.quiz-section').classList.add('active');
            
            document.getElementById('studentInfo').innerHTML = 
                `<strong>å­¦å·ï¼š</strong>${id} &nbsp;&nbsp; <strong>å§“åï¼š</strong>${name}`;
            
            loadQuestion();
        }

        function loadQuestion() {
            if (studentData.currentTopicIndex >= topics.length) {
                showResults();
                return;
            }

            const currentTopic = topics[studentData.currentTopicIndex];
            const stats = studentData.topicStats[currentTopic.id];
            
            // éšæœºé€‰æ‹©ä¸€ä¸ªé¢˜ç›®ç”Ÿæˆå™¨
            const generator = currentTopic.questionGenerators[
                Math.floor(Math.random() * currentTopic.questionGenerators.length)
            ];
            
            // ç”Ÿæˆé¢˜ç›®
            const questionData = generator.generate();
            
            // ä¿å­˜é¢˜ç›®æ•°æ®
            const question = {
                type: generator.type,
                question: questionData.question,
                options: questionData.options.options,
                correct: questionData.options.correctIndex,
                explanation: questionData.explanation,
                answered: false,
                isCorrect: false
            };
            
            stats.questions.push(question);

            // æ›´æ–°è¿›åº¦
            const progress = ((studentData.currentTopicIndex / topics.length) * 100).toFixed(0);
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressBar').textContent = progress + '%';

            // æ˜¾ç¤ºå½“å‰çŸ¥è¯†ç‚¹
            document.getElementById('currentTopic').innerHTML = `
                <div class="topic-name">ğŸ“š ${currentTopic.name}</div>
                <div class="topic-progress">çŸ¥è¯†ç‚¹ ${studentData.currentTopicIndex + 1} / ${topics.length} Â· æœ¬çŸ¥è¯†ç‚¹ç¬¬ ${stats.attempts + 1} æ¬¡å°è¯•</div>
            `;

            // æ˜¾ç¤ºé¢˜ç›®
            document.getElementById('questionTitle').innerHTML = `
                <span class="question-number">ç¬¬ ${stats.attempts + 1} é¢˜</span>
                ${question.question}
            `;

            // æ˜¾ç¤ºé€‰é¡¹
            const optionsHTML = question.options.map((opt, index) => `
                <div class="option" data-index="${index}" onclick="selectOption(this)">
                    <strong>${String.fromCharCode(65 + index)}.</strong> ${opt.text}
                </div>
            `).join('');
            document.getElementById('options').innerHTML = optionsHTML;

            // é‡ç½®æŒ‰é’®çŠ¶æ€
            document.getElementById('feedback').innerHTML = '';
            document.getElementById('submitBtn').style.display = 'inline-block';
            document.getElementById('nextBtn').style.display = 'none';

            // æ¸²æŸ“æ•°å­¦å…¬å¼
            if (typeof MathJax !== 'undefined') {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            }
        }

        let selectedOptionIndex = null;

        function selectOption(element) {
            document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            selectedOptionIndex = parseInt(element.dataset.index);
        }

        function submitAnswer() {
            if (selectedOptionIndex === null) {
                alert('è¯·é€‰æ‹©ä¸€ä¸ªç­”æ¡ˆï¼');
                return;
            }

            const currentTopic = topics[studentData.currentTopicIndex];
            const stats = studentData.topicStats[currentTopic.id];
            const currentQuestion = stats.questions[stats.questions.length - 1];
            
            stats.attempts++;
            currentQuestion.answered = true;

            const options = document.querySelectorAll('.option');
            const isCorrect = selectedOptionIndex === currentQuestion.correct;
            currentQuestion.isCorrect = isCorrect;

            // æ˜¾ç¤ºæ­£ç¡®/é”™è¯¯çŠ¶æ€
            options.forEach((opt, index) => {
                opt.style.pointerEvents = 'none';
                if (index === currentQuestion.correct) {
                    opt.classList.add('correct');
                } else if (index === selectedOptionIndex && !isCorrect) {
                    opt.classList.add('incorrect');
                }
            });

            // æ˜¾ç¤ºåé¦ˆ
            const feedbackDiv = document.getElementById('feedback');
            if (isCorrect) {
                stats.correct++;
                feedbackDiv.className = 'feedback correct';
                feedbackDiv.innerHTML = `
                    <strong>âœ… å›ç­”æ­£ç¡®ï¼</strong>
                    <div class="explanation-detail">${currentQuestion.explanation}</div>
                `;
            } else {
                feedbackDiv.className = 'feedback incorrect';
                feedbackDiv.innerHTML = `
                    <strong>âŒ å›ç­”é”™è¯¯</strong>
                    <div class="explanation-detail">
                        æ­£ç¡®ç­”æ¡ˆæ˜¯ <strong>${String.fromCharCode(65 + currentQuestion.correct)}</strong>ã€‚
                        <br><br>${currentQuestion.explanation}
                    </div>
                `;
            }

            // æ¸²æŸ“æ•°å­¦å…¬å¼
            if (typeof MathJax !== 'undefined') {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            }

            // åˆ‡æ¢æŒ‰é’®
            document.getElementById('submitBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'inline-block';
            document.getElementById('nextBtn').textContent = isCorrect ? 'è¿›å…¥ä¸‹ä¸€çŸ¥è¯†ç‚¹ â†’' : 'å†åšä¸€é¢˜å·©å›º â†’';

            selectedOptionIndex = null;
        }

        function nextQuestion() {
            const currentTopic = topics[studentData.currentTopicIndex];
            const stats = studentData.topicStats[currentTopic.id];
            const lastQuestion = stats.questions[stats.questions.length - 1];

            if (lastQuestion.isCorrect) {
                // ç­”å¯¹äº†ï¼Œè¿›å…¥ä¸‹ä¸€çŸ¥è¯†ç‚¹
                studentData.currentTopicIndex++;
                loadQuestion();
            } else {
                // ç­”é”™äº†ï¼Œç»§ç»­å½“å‰çŸ¥è¯†ç‚¹
                loadQuestion();
            }
        }

        function showResults() {
            document.querySelector('.quiz-section').classList.remove('active');
            document.querySelector('.result-section').classList.add('active');

            const endTime = new Date();
            const duration = Math.round((endTime - studentData.startTime) / 1000 / 60);

            let reportHTML = `
                <div style="text-align: center; margin-bottom: 30px; padding: 20px; background: linear-gradient(135deg, #e8f5ff 0%, #f0f9ff 100%); border-radius: 10px;">
                    <h2 style="color: #2d57a4;">ğŸ‰ ${studentData.name} åŒå­¦</h2>
                    <p style="color: #666; font-size: 1.1em; margin: 10px 0;">å­¦å·ï¼š${studentData.id}</p>
                    <p style="color: #666;">ç”¨æ—¶ï¼š${duration} åˆ†é’Ÿ</p>
                </div>

                <table class="stats-table">
                    <tr>
                        <th>çŸ¥è¯†ç‚¹</th>
                        <th>ç­”é¢˜æ¬¡æ•°</th>
                        <th>æŒæ¡ç¨‹åº¦</th>
                    </tr>
            `;

            let excellentTopics = [], goodTopics = [], fairTopics = [], poorTopics = [];

            topics.forEach(topic => {
                const stats = studentData.topicStats[topic.id];
                let mastery, masteryClass;

                if (stats.attempts === 1) {
                    mastery = 'ä¼˜ç§€ â­â­â­â­';
                    masteryClass = 'mastery-excellent';
                    excellentTopics.push(topic.name);
                } else if (stats.attempts === 2) {
                    mastery = 'è‰¯å¥½ â­â­â­';
                    masteryClass = 'mastery-good';
                    goodTopics.push(topic.name);
                } else if (stats.attempts <= 4) {
                    mastery = 'ä¸€èˆ¬ â­â­';
                    masteryClass = 'mastery-fair';
                    fairTopics.push(topic.name);
                } else {
                    mastery = 'éœ€åŠ å¼º â­';
                    masteryClass = 'mastery-poor';
                    poorTopics.push(topic.name);
                }

                reportHTML += `
                    <tr>
                        <td><strong>${topic.name}</strong></td>
                        <td>${stats.attempts} æ¬¡</td>
                        <td class="${masteryClass}">${mastery}</td>
                    </tr>
                `;
            });

            reportHTML += '</table>';

            // çŸ¥è¯†æŒæ¡åˆ†æ
            reportHTML += '<div style="margin-top: 30px;"><h3 style="color: #2d57a4;">ğŸ“Š çŸ¥è¯†æŒæ¡åˆ†æ</h3>';

            if (excellentTopics.length > 0) {
                reportHTML += `
                    <div style="background: #e8f5e9; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 5px solid #5ca353;">
                        <strong style="color: #5ca353;">âœ… æŒæ¡ä¼˜ç§€ï¼ˆä¸€æ¬¡é€šè¿‡ï¼‰ï¼š</strong><br>
                        ${excellentTopics.join('ã€')}
                    </div>
                `;
            }

            if (goodTopics.length > 0) {
                reportHTML += `
                    <div style="background: #e8f5ff; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 5px solid #608de0;">
                        <strong style="color: #608de0;">ğŸ‘ æŒæ¡è‰¯å¥½ï¼ˆä¸¤æ¬¡é€šè¿‡ï¼‰ï¼š</strong><br>
                        ${goodTopics.join('ã€')}
                    </div>
                `;
            }

            if (fairTopics.length > 0) {
                reportHTML += `
                    <div style="background: #fff8e1; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 5px solid #D46A6A;">
                        <strong style="color: #D46A6A;">âš ï¸ éœ€è¦å·©å›ºï¼ˆ3-4æ¬¡é€šè¿‡ï¼‰ï¼š</strong><br>
                        ${fairTopics.join('ã€')}
                    </div>
                `;
            }

            if (poorTopics.length > 0) {
                reportHTML += `
                    <div style="background: #ffebee; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 5px solid #912d32;">
                        <strong style="color: #912d32;">âŒ é‡ç‚¹åŠ å¼ºï¼ˆ5æ¬¡ä»¥ä¸Šï¼‰ï¼š</strong><br>
                        ${poorTopics.join('ã€')}
                        <p style="margin-top: 10px; font-size: 0.9em;">å»ºè®®ï¼šé‡æ–°å­¦ä¹ IIRæ»¤æ³¢å™¨è®¾è®¡ç†è®ºï¼Œç‰¹åˆ«æ˜¯é¢„ç¿˜æ›²åŸç†ã€åŒçº¿æ€§å˜æ¢ä¸è„‰å†²å“åº”ä¸å˜æ³•çš„åŒºåˆ«ã€‚</p>
                    </div>
                `;
            }

            reportHTML += '</div>';

            document.getElementById('finalReport').innerHTML = reportHTML;
        }

        function saveScreenshot() {
            const button = document.getElementById('saveBtn');
            button.disabled = true;
            button.textContent = 'â³ æ­£åœ¨ç”Ÿæˆ...';

            html2canvas(document.body, {
                backgroundColor: '#ffffff',
                scale: 2,
                logging: false
            }).then(canvas => {
                canvas.toBlob(blob => {
                    const cleanId = studentData.id.replace(/[^a-zA-Z0-9_\u4e00-\u9fa5-]/g, '_');
                    const cleanName = studentData.name.replace(/[^a-zA-Z0-9_\u4e00-\u9fa5-]/g, '_');
                    const timestamp = new Date().toISOString().slice(0, 10);
                    const filename = `DSP_Lab4_${cleanId}_${cleanName}_${timestamp}.png`;

                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);

                    button.disabled = false;
                    button.textContent = 'âœ… ä¿å­˜æˆåŠŸ';
                    setTimeout(() => {
                        button.textContent = 'ğŸ’¾ å†æ¬¡ä¿å­˜';
                    }, 2000);
                }, 'image/png');
            }).catch(error => {
                console.error('æˆªå›¾å¤±è´¥:', error);
                alert('æˆªå›¾å¤±è´¥ï¼Œè¯·å°è¯•ä½¿ç”¨æµè§ˆå™¨çš„æˆªå›¾åŠŸèƒ½');
                button.disabled = false;
                button.textContent = 'ğŸ’¾ ä¿å­˜æŠ¥å‘Š';
            });
        }
    </script>

    <!-- MathJax åŠ è½½è„šæœ¬ -->
    <script>
        (function() {
            const statusDiv = document.getElementById('mathjaxStatus');
            const primaryCDN = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
            const backupCDN = 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML';

            function loadScript(src, onload, onerror) {
                const script = document.createElement('script');
                script.src = src;
                script.async = true;
                script.onload = onload;
                script.onerror = onerror;
                document.head.appendChild(script);
            }

            function onMathJaxLoad() {
                statusDiv.textContent = 'âœ“ æ•°å­¦å…¬å¼åŠ è½½æˆåŠŸ';
                statusDiv.className = 'mathjax-status success';
            }

            loadScript(primaryCDN, onMathJaxLoad, function() {
                statusDiv.textContent = 'ä¸»CDNåŠ è½½å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨...';
                loadScript(backupCDN, onMathJaxLoad, function() {
                    statusDiv.textContent = 'âŒ å…¬å¼åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ';
                    statusDiv.className = 'mathjax-status';
                });
            });
        })();
    </script>
</body>
</html>
