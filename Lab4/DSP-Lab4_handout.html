<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 4 - IIRæ»¤æ³¢å™¨è®¾è®¡ (2025å¹´ä¿®è®¢ç‰ˆ)</title>
    
    <!-- MathJax for mathematical formulas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$','$'], ['\\(','\\)']],
                displayMath: [['$$','$$'], ['\\[','\\]']],
                processEscapes: true
            },
            CommonHTML: { scale: 110 },
            "HTML-CSS": { scale: 110 }
        });
    </script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Microsoft YaHei', 'SimSun', Arial, sans-serif;
            line-height: 1.8;
            color: #2c3e50;
            background: linear-gradient(135deg, #608de0 0%, #7dadff 50%, #5ca353 100%);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.25);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #2d57a4 0%, #608de0 100%);
            color: white;
            padding: 50px 40px;
            text-align: center;
            border-bottom: 5px solid #7dadff;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            font-weight: bold;
        }

        header .subtitle {
            font-size: 1.1em;
            opacity: 0.95;
            margin-top: 10px;
        }

        header .institution {
            font-size: 0.95em;
            margin-top: 15px;
            opacity: 0.9;
            border-top: 2px solid rgba(255,255,255,0.3);
            padding-top: 15px;
        }

        nav {
            background: #f5f7fa;
            padding: 20px 40px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            border-bottom: 3px solid #7dadff;
        }

        nav a {
            color: #2d57a4;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 25px;
            transition: all 0.3s;
            font-size: 0.95em;
            font-weight: 500;
            background: white;
            border: 2px solid #7dadff;
        }

        nav a:hover {
            background: #7dadff;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(125, 173, 255, 0.4);
        }

        .content { padding: 50px; }

        section {
            margin-bottom: 60px;
            animation: fadeIn 0.6s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h2 {
            color: #2d57a4;
            font-size: 2em;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 4px solid #7dadff;
            font-weight: bold;
        }

        h3 {
            color: #608de0;
            font-size: 1.6em;
            margin: 30px 0 20px 0;
            font-weight: bold;
        }

        h4 {
            color: #2d57a4;
            font-size: 1.3em;
            margin: 25px 0 15px 0;
            font-weight: 600;
        }

        p {
            margin-bottom: 15px;
            text-align: justify;
            line-height: 1.9;
        }
        
        code {
            background-color: #e8eef8;
            color: #2d57a4;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.95em;
        }
        
        .question-item h4 {
            color: #608de0;
            font-size: 1.2em;
            margin-top: 20px;
            border-left: 4px solid #7dadff;
            padding-left: 10px;
        }
        
        .analysis-box {
            background: #fff8e1;
            border-left: 5px solid #fbc02d;
            padding: 20px;
            margin: 25px 0;
            border-radius: 8px;
        }

        .analysis-box h4 {
            color: #c77700;
            margin-top: 0;
            font-size: 1.2em;
        }

        .formula-box {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-left: 5px solid #608de0;
            padding: 18px 25px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .formula-box p {
            margin-bottom: 8px;
            color: #555;
        }

        .tip-box {
            background: linear-gradient(135deg, #e8f5e9 0%, #f1f8f4 100%);
            border-left: 5px solid #5ca353;
            padding: 18px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .warning-box {
            background: linear-gradient(135deg, #ffebee 0%, #fff5f7 100%);
            border-left: 5px solid #912d32;
            padding: 18px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .prereq-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #f0f7ff 100%);
            border-left: 5px solid #1976d2;
            padding: 20px;
            margin: 25px 0;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .prereq-box h4 {
            color: #1565c0;
            margin-top: 0;
        }
        
        .case-study-box {
            background: linear-gradient(135deg, #fce4ec 0%, #fff5f7 100%);
            border: 2px solid #ec407a;
            padding: 25px;
            margin: 25px 0;
            border-radius: 12px;
            box-shadow: 0 3px 15px rgba(236, 64, 122, 0.15);
        }
        
        .case-study-box h4 {
            color: #c2185b;
            margin-top: 0;
            font-size: 1.3em;
        }

        .code-block {
            background: #2b2b2b;
            color: #d4d4d4;
            padding: 25px;
            border-radius: 10px;
            margin: 25px 0;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            line-height: 1.7;
            position: relative;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            border: 2px solid #608de0;
        }
        
        .code-block code {
            background: none;
            color: inherit;
            padding: 0;
            font-size: inherit;
        }

        .code-block::before {
            content: 'MATLAB';
            position: absolute;
            top: 8px;
            right: 15px;
            color: #7dadff;
            font-size: 0.85em;
            font-weight: bold;
            font-family: Arial, sans-serif;
        }

        .code-line { display: block; }
        .code-comment { color: #6a9955; }
        .code-keyword { color: #569cd6; }
        .code-function { color: #dcdcaa; }
        .code-string { color: #ce9178; }
        .code-number { color: #b5cea8; }

        .exercise-box {
            background: linear-gradient(135deg, #f0f7ff 0%, #f5f9ff 100%);
            border: 3px solid #7dadff;
            border-radius: 12px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 3px 15px rgba(125, 173, 255, 0.2);
        }

        .exercise-box h3 { color: #2d57a4; margin-top: 0; margin-bottom: 25px; }
        
        .plot-container {
            background: #fdfdfd;
            border-radius: 10px;
            padding: 20px;
            margin: 25px 0;
            box-shadow: 0 3px 12px rgba(0,0,0,0.1);
            border: 1px solid #e0e6f0;
            text-align: center;
        }
        
        .figure-container {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: #fafafa;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }

        .figure-container img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.15);
        }

        .figure-caption {
            margin-top: 15px;
            color: #666;
            font-style: italic;
            font-size: 0.95em;
        }
        
        svg { max-width: 100%; height: auto; }

        .plot-container h4 { margin-top: 0; margin-bottom: 15px; text-align: center; color: #2d57a4; }
        .plot-container svg { max-width: 100%; height: auto; }

        .question-item { margin: 20px 0; padding-left: 15px; }
        .question-number {
            display: inline-block; background: #608de0; color: white;
            padding: 4px 12px; border-radius: 15px; font-weight: bold;
            margin-right: 8px; font-size: 0.9em; min-width: 30px; text-align: center;
        }

        .interactive-demo {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%); border: 3px dashed #5ca353;
            border-radius: 15px; padding: 30px; margin: 30px 0; text-align: center;
        }

        .canvas-container {
            background: white; border-radius: 10px; padding: 15px; margin: 20px 0;
            box-shadow: 0 3px 12px rgba(0,0,0,0.1); border: 2px solid #7dadff; display: inline-block;
        }

        canvas { max-width: 100%; height: auto; border: 1px solid #e0e0e0; border-radius: 8px; }

        .control-panel { display: flex; flex-wrap: wrap; justify-content: center; align-items: center; margin: 20px 0; gap: 30px; }
        .control-group { display: flex; flex-direction: column; gap: 8px; align-items: center; }
        label { font-weight: bold; color: #2d57a4; font-size: 0.95em; }
        input[type="range"] { width: 200px; accent-color: #608de0; }
        select {
            padding: 10px; border-radius: 5px; border: 2px solid #ddd;
            font-size: 14px; font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: white; cursor: pointer;
        }

        button {
            background: linear-gradient(135deg, #608de0 0%, #7dadff 100%); color: white; border: none;
            padding: 12px 25px; border-radius: 25px; cursor: pointer; font-size: 1em;
            font-weight: bold; transition: all 0.3s; box-shadow: 0 3px 10px rgba(96, 141, 224, 0.3);
        }

        button:hover {
            background: linear-gradient(135deg, #2d57a4 0%, #608de0 100%);
            transform: translateY(-2px); box-shadow: 0 5px 15px rgba(96, 141, 224, 0.5);
        }

        footer {
            background: linear-gradient(135deg, #2d57a4 0%, #113a85 100%); color: white;
            text-align: center; padding: 30px; font-size: 0.95em;
        }
        
        footer p { margin: 5px 0; }

        .badge {
            display: inline-block; padding: 6px 14px; border-radius: 20px;
            font-size: 0.85em; font-weight: bold; margin-right: 10px;
        }
        .badge-theory { background: #608de0; color: white; }
        .badge-practice { background: #5ca353; color: white; }
        .badge-review { background: #9c27b0; color: white; }
        strong { color: #2d57a4; font-weight: 600; }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            background: white;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        th {
            background: linear-gradient(135deg, #2d57a4 0%, #608de0 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        tr:hover { background: #f5f7fa; }
        tr:last-child td { border-bottom: none; }
        
        ul, ol {
            margin: 20px 0 20px 30px;
            line-height: 2;
        }

        li { margin-bottom: 10px; }
        
        .appendix-section {
            background: linear-gradient(135deg, #f3e5f5 0%, #faf5fc 100%);
            border: 2px solid #9c27b0;
            border-radius: 12px;
            padding: 30px;
            margin: 40px 0;
        }
        
        .appendix-section h3 {
            color: #7b1fa2;
        }
        
        .comparison-highlight {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        
        .comparison-card {
            flex: 1;
            min-width: 280px;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            border-top: 4px solid #608de0;
        }
        
        .comparison-card.iim { border-top-color: #f57c00; }
        .comparison-card.blt { border-top-color: #2e7d32; }
        
        .comparison-card h5 {
            margin: 0 0 15px 0;
            font-size: 1.1em;
        }
        
        @media (max-width: 768px) {
            .content { padding: 30px 20px; }
            input[type="range"] { width: 100%; }
            .canvas-container { width: 100%; }
        }

        .mjx-chtml { font-size: 115% !important; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Lab 4 - IIRæ»¤æ³¢å™¨è®¾è®¡</h1>
            <div class="subtitle">æ•°å­—ä¿¡å·å¤„ç†å®éªŒ | 2025å¹´ä¿®è®¢ç‰ˆ</div>
            <div class="institution">å—äº¬å·¥ä¸šå¤§å­¦æµ¦æ±Ÿå­¦é™¢ è®¡ç®—æœºä¸é€šä¿¡å·¥ç¨‹å­¦é™¢ | é€šä¿¡å·¥ç¨‹ä¸“ä¸š</div>
        </header>

        <nav>
            <a href="#objective">å®éªŒç›®çš„</a>
            <a href="#review">çŸ¥è¯†è¡”æ¥</a>
            <a href="#theory">æ¨¡æ‹Ÿæ»¤æ³¢å™¨</a>
            <a href="#demo">äº¤äº’æ¼”ç¤º</a>
            <a href="#example">ç¤ºä¾‹è®²è§£</a>
            <a href="#exercise1">ç»ƒä¹ ä¸€</a>
            <a href="#exercise2">ç»ƒä¹ äºŒ</a>
            <a href="#exercise3">ç»ƒä¹ ä¸‰</a>
            <a href="#exercise4">ç»ƒä¹ å››</a>
            <a href="#appendix">é™„å½•</a>
        </nav>

        <div class="content">
            <!-- å®éªŒç›®çš„ -->
            <section id="objective">
                <h2><span class="badge badge-theory">ç†è®º</span>å®éªŒç›®çš„</h2>
                
                <div class="case-study-box">
                    <h4>ğŸµ ç”Ÿæ´»åœºæ™¯ï¼šä¸ºä»€ä¹ˆéœ€è¦å­¦ä¹ æ¨¡æ‹Ÿæ»¤æ³¢å™¨ï¼Ÿ</h4>
                    <p>æƒ³è±¡ä½ æ­£åœ¨å¼€å‘ä¸€æ¬¾éŸ³ä¹Appçš„å‡è¡¡å™¨åŠŸèƒ½ã€‚ç”¨æˆ·æ»‘åŠ¨ä¸€ä¸ªæ»‘å—ï¼Œå°±èƒ½å¢å¼ºä½éŸ³æˆ–é«˜éŸ³ã€‚ä½ åœ¨è¯¾å ‚ä¸Šå­¦åˆ°äº†<strong>è„‰å†²å“åº”ä¸å˜æ³•(IIM)</strong>å’Œ<strong>åŒçº¿æ€§å˜æ¢æ³•(BLT)</strong>å¯ä»¥è®¾è®¡IIRæ•°å­—æ»¤æ³¢å™¨ï¼Œä½†æ˜¯â€¦â€¦</p>
                    <ul>
                        <li><strong>é—®é¢˜æ¥äº†</strong>ï¼šè¿™ä¸¤ç§æ–¹æ³•çš„è¾“å…¥éƒ½æ˜¯ä¸€ä¸ª"æ¨¡æ‹Ÿæ»¤æ³¢å™¨ $H_a(s)$"ï¼Œå¯æ˜¯è¿™ä¸ªæ¨¡æ‹Ÿæ»¤æ³¢å™¨ä»å“ªé‡Œæ¥ï¼Ÿ</li>
                        <li><strong>è¯¾å ‚å›é¡¾</strong>ï¼šè¯¾å ‚è®²è¿‡ $s = \frac{2}{T}\frac{z-1}{z+1}$ (BLT) æˆ– $h[n] = Th_a(nT)$ (IIM)ï¼Œä½† $H_a(s)$ çš„è®¾è®¡å…¬å¼å¤ªå¤æ‚äº†</li>
                        <li><strong>æœ¬å®éªŒç›®æ ‡</strong>ï¼šå­¦ä¼šä½¿ç”¨MATLABå¿«é€Ÿè®¾è®¡æ¨¡æ‹Ÿæ»¤æ³¢å™¨ï¼Œå®ŒæˆIIRè®¾è®¡çš„"æœ€åä¸€å—æ‹¼å›¾"</li>
                    </ul>
                </div>
                
                <p>åœ¨æœ¬å®éªŒä¸­ï¼Œæˆ‘ä»¬å°†<strong>è¡¥å……è¯¾å ‚æœªè¯¦ç»†å±•å¼€çš„æ¨¡æ‹Ÿæ»¤æ³¢å™¨è®¾è®¡</strong>ï¼Œå¹¶ä½¿ç”¨MATLABå®Œæˆå®Œæ•´çš„IIRæ»¤æ³¢å™¨è®¾è®¡æµç¨‹ã€‚é€šè¿‡æœ¬å®éªŒï¼Œä½ å°†ï¼š</p>
                <ul>
                    <li><strong>ç†è§£ä¸ºä»€ä¹ˆè¦"å€Ÿç”¨"æ¨¡æ‹Ÿæ»¤æ³¢å™¨</strong>ï¼šç›´æ¥è®¾è®¡æ•°å­—IIRæ»¤æ³¢å™¨éœ€è¦è§£éçº¿æ€§æ–¹ç¨‹ï¼Œè€Œæ¨¡æ‹Ÿæ»¤æ³¢å™¨å·²æœ‰ç™¾å¹´æˆç†Ÿç†è®º</li>
                    <li><strong>æŒæ¡ä¸‰ç§ç»å…¸æ¨¡æ‹Ÿæ»¤æ³¢å™¨çš„ç‰¹æ€§</strong>ï¼šButterworthï¼ˆæœ€å¹³å¦ï¼‰ã€Chebyshevï¼ˆç­‰æ³¢çº¹ï¼‰ã€Ellipticï¼ˆæœ€é«˜æ•ˆï¼‰</li>
                    <li><strong>å­¦ä¼šä½¿ç”¨MATLABå‡½æ•°è®¾è®¡æ¨¡æ‹ŸåŸå‹</strong>ï¼š<code>buttord</code>ã€<code>butter</code>ã€<code>cheby1</code>ã€<code>ellip</code>ç­‰</li>
                    <li><strong>ç†Ÿç»ƒåº”ç”¨åŒçº¿æ€§å˜æ¢</strong>ï¼šå°†è¯¾å ‚å­¦åˆ°çš„BLTå…¬å¼ç”¨<code>bilinear</code>å‡½æ•°å®ç°</li>
                    <li><strong>æ·±å…¥ç†è§£é¢‘ç‡é¢„ç¿˜æ›²</strong>ï¼šè¿™æ˜¯è¯¾å ‚å…¬å¼èƒŒåçš„ç‰©ç†æ„ä¹‰</li>
                </ul>
            </section>

            <!-- çŸ¥è¯†è¡”æ¥ï¼šå¤ä¹ IIMå’ŒBLT -->
            <section id="review">
                <h2><span class="badge badge-review">å¤ä¹ </span>çŸ¥è¯†è¡”æ¥ï¼šä»è¯¾å ‚åˆ°å®éªŒ</h2>
                
                <h3>2.1 ä½ å·²ç»å­¦ä¼šçš„çŸ¥è¯†</h3>
                <div class="prereq-box">
                    <h4>ğŸ“š è¯¾å ‚çŸ¥è¯†å›é¡¾</h4>
                    <p>åœ¨ç†è®ºè¯¾ä¸Šï¼Œä½ å·²ç»å­¦ä¹ äº†ä¸¤ç§å°†æ¨¡æ‹Ÿæ»¤æ³¢å™¨è½¬æ¢ä¸ºæ•°å­—æ»¤æ³¢å™¨çš„æ–¹æ³•ï¼š</p>
                    
                    <div class="comparison-highlight">
                        <div class="comparison-card iim">
                            <h5 style="color: #e65100;">è„‰å†²å“åº”ä¸å˜æ³• (IIM)</h5>
                            <p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼šè®©æ•°å­—æ»¤æ³¢å™¨çš„è„‰å†²å“åº”ç­‰äºæ¨¡æ‹Ÿæ»¤æ³¢å™¨è„‰å†²å“åº”çš„é‡‡æ ·å€¼</p>
                            <div class="formula-box" style="margin: 10px 0;">
                                $$h[n] = T \cdot h_a(nT)$$
                            </div>
                            <p><strong>ä¼˜ç‚¹</strong>ï¼šæ—¶åŸŸç‰¹æ€§ä¿æŒè‰¯å¥½</p>
                            <p><strong>ç¼ºç‚¹</strong>ï¼š<span style="color: #d32f2f;">æœ‰é¢‘ç‡æ··å é—®é¢˜</span></p>
                        </div>
                        
                        <div class="comparison-card blt">
                            <h5 style="color: #2e7d32;">åŒçº¿æ€§å˜æ¢æ³• (BLT)</h5>
                            <p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼šç”¨ä»£æ•°å˜æ¢å°†så¹³é¢æ˜ å°„åˆ°zå¹³é¢</p>
                            <div class="formula-box" style="margin: 10px 0;">
                                $$s = \frac{2}{T} \cdot \frac{z-1}{z+1}$$
                            </div>
                            <p><strong>ä¼˜ç‚¹</strong>ï¼š<span style="color: #2e7d32;">æ— é¢‘ç‡æ··å </span></p>
                            <p><strong>ç¼ºç‚¹</strong>ï¼šæœ‰é¢‘ç‡ç¿˜æ›²ï¼ˆéœ€é¢„ç¿˜æ›²è¡¥å¿ï¼‰</p>
                        </div>
                    </div>
                </div>
                
                <h3>2.2 ä½ éœ€è¦è¡¥å……çš„çŸ¥è¯†</h3>
                <div class="warning-box">
                    <h4>â“ ç¼ºå¤±çš„ä¸€ç¯ï¼šæ¨¡æ‹Ÿæ»¤æ³¢å™¨ $H_a(s)$ ä»å“ªé‡Œæ¥ï¼Ÿ</h4>
                    <p>è¯¾å ‚ä¸Šï¼Œç›´æ¥ç»™å‡ºäº†æ¨¡æ‹Ÿæ»¤æ³¢å™¨çš„ä¼ é€’å‡½æ•°ï¼Œä¾‹å¦‚ï¼š</p>
                    <div class="formula-box">
                        $$H_a(s) = \frac{1}{s^2 + 1.414s + 1} \quad \text{ï¼ˆ2é˜¶Butterworthä½é€šï¼‰}$$
                    </div>
                    <p>ä½†å®é™…å·¥ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®<strong>è®¾è®¡æŒ‡æ ‡</strong>ï¼ˆé€šå¸¦ã€é˜»å¸¦ã€è¡°å‡è¦æ±‚ï¼‰æ¥<strong>è‡ªåŠ¨è®¡ç®—</strong>è¿™ä¸ª $H_a(s)$ã€‚</p>
                    <p><strong>é—®é¢˜</strong>ï¼šæ‰‹å·¥æ¨å¯¼ Butterworth/Chebyshev/Elliptic æ»¤æ³¢å™¨çš„ä¼ é€’å‡½æ•°éœ€è¦ï¼š</p>
                    <ul>
                        <li>å¤æ‚çš„æç‚¹åˆ†å¸ƒè®¡ç®—ï¼ˆæ¶‰åŠå¤æ•°è¿ç®—ï¼‰</li>
                        <li>åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼æˆ–æ¤­åœ†å‡½æ•°çš„æ±‚è§£</li>
                        <li>å¤§é‡çš„ä»£æ•°è¿ç®—ï¼Œå®¹æ˜“å‡ºé”™</li>
                    </ul>
                    <p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨MATLABçš„ <code>butter</code>ã€<code>cheby1</code>ã€<code>ellip</code> å‡½æ•°è‡ªåŠ¨å®Œæˆï¼</p>
                </div>
                
                <h3>2.3 æœ¬å®éªŒçš„å®Œæ•´æµç¨‹</h3>
                <div class="figure-container">
                    <svg width="900" height="280" viewBox="0 0 900 280">
                        <title>IIRæ»¤æ³¢å™¨è®¾è®¡å®Œæ•´æµç¨‹</title>
                        <rect width="900" height="280" fill="#fafafa"/>
                        
                        <!-- æ ‡é¢˜ -->
                        <text x="450" y="30" text-anchor="middle" font-size="18" font-weight="bold" fill="#2d57a4">
                            IIRæ»¤æ³¢å™¨è®¾è®¡å®Œæ•´æµç¨‹ï¼ˆè¯¾å ‚ + æœ¬å®éªŒï¼‰
                        </text>
                        
                        <!-- æµç¨‹å›¾ -->
                        <g transform="translate(30, 60)">
                            <!-- æ­¥éª¤1 -->
                            <rect x="0" y="40" width="130" height="90" rx="10" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
                            <text x="65" y="70" text-anchor="middle" font-size="13" font-weight="bold" fill="#1565c0">Step 1</text>
                            <text x="65" y="90" text-anchor="middle" font-size="12" fill="#333">è®¾è®¡æŒ‡æ ‡</text>
                            <text x="65" y="108" text-anchor="middle" font-size="11" fill="#666">Fp, Fst, Rp, Rs</text>
                            
                            <!-- ç®­å¤´1 -->
                            <path d="M 130 85 L 160 85" stroke="#608de0" stroke-width="2" marker-end="url(#arrowblue)"/>
                            
                            <!-- æ­¥éª¤2 (æœ¬å®éªŒé‡ç‚¹) -->
                            <rect x="160" y="20" width="160" height="130" rx="10" fill="#fff3e0" stroke="#f57c00" stroke-width="3"/>
                            <text x="240" y="45" text-anchor="middle" font-size="11" fill="#e65100" font-weight="bold">â­ æœ¬å®éªŒé‡ç‚¹</text>
                            <text x="240" y="70" text-anchor="middle" font-size="13" font-weight="bold" fill="#e65100">Step 2: æ¨¡æ‹ŸåŸå‹</text>
                            <text x="240" y="92" text-anchor="middle" font-size="11" fill="#333">â€¢ é¢„ç¿˜æ›²é¢‘ç‡</text>
                            <text x="240" y="110" text-anchor="middle" font-size="11" fill="#333">â€¢ è®¡ç®—é˜¶æ¬¡N</text>
                            <text x="240" y="128" text-anchor="middle" font-size="11" fill="#333">â€¢ è®¾è®¡Ha(s)</text>
                            
                            <!-- ç®­å¤´2 -->
                            <path d="M 320 85 L 350 85" stroke="#608de0" stroke-width="2" marker-end="url(#arrowblue)"/>
                            
                            <!-- æ­¥éª¤3 (è¯¾å ‚å·²å­¦) -->
                            <rect x="350" y="40" width="150" height="90" rx="10" fill="#e8f5e9" stroke="#43a047" stroke-width="2"/>
                            <text x="425" y="60" text-anchor="middle" font-size="11" fill="#2e7d32" font-weight="bold">è¯¾å ‚å·²å­¦ âœ“</text>
                            <text x="425" y="82" text-anchor="middle" font-size="13" font-weight="bold" fill="#2e7d32">Step 3: BLT</text>
                            <text x="425" y="105" text-anchor="middle" font-size="11" fill="#333">s â†’ z å˜æ¢</text>
                            <text x="425" y="120" text-anchor="middle" font-size="10" fill="#666">bilinear()</text>
                            
                            <!-- ç®­å¤´3 -->
                            <path d="M 500 85 L 530 85" stroke="#608de0" stroke-width="2" marker-end="url(#arrowblue)"/>
                            
                            <!-- æ­¥éª¤4 -->
                            <rect x="530" y="40" width="130" height="90" rx="10" fill="#f3e5f5" stroke="#8e24aa" stroke-width="2"/>
                            <text x="595" y="70" text-anchor="middle" font-size="13" font-weight="bold" fill="#7b1fa2">Step 4</text>
                            <text x="595" y="90" text-anchor="middle" font-size="12" fill="#333">æ•°å­—æ»¤æ³¢å™¨</text>
                            <text x="595" y="108" text-anchor="middle" font-size="11" fill="#666">H(z)</text>
                            
                            <!-- ç®­å¤´4 -->
                            <path d="M 660 85 L 690 85" stroke="#608de0" stroke-width="2" marker-end="url(#arrowblue)"/>
                            
                            <!-- æ­¥éª¤5 -->
                            <rect x="690" y="40" width="130" height="90" rx="10" fill="#e0f7fa" stroke="#00acc1" stroke-width="2"/>
                            <text x="755" y="70" text-anchor="middle" font-size="13" font-weight="bold" fill="#00838f">Step 5</text>
                            <text x="755" y="90" text-anchor="middle" font-size="12" fill="#333">éªŒè¯ä¸åˆ†æ</text>
                            <text x="755" y="108" text-anchor="middle" font-size="11" fill="#666">freqz(), filter()</text>
                        </g>
                        
                        <!-- ç®­å¤´æ ‡è®°å®šä¹‰ -->
                        <defs>
                            <marker id="arrowblue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#608de0"/>
                            </marker>
                        </defs>
                        
                        <!-- åº•éƒ¨è¯´æ˜ -->
                        <g transform="translate(50, 210)">
                            <rect x="0" y="0" width="800" height="50" rx="8" fill="#f5f5f5" stroke="#ddd"/>
                            <text x="400" y="20" text-anchor="middle" font-size="13" fill="#333">
                                <tspan font-weight="bold" fill="#e65100">æœ¬å®éªŒæ ¸å¿ƒä»»åŠ¡ï¼š</tspan>
                                å­¦ä¼šä½¿ç”¨ MATLAB å‡½æ•°ï¼ˆbuttord, butter, cheby1, ellipï¼‰è‡ªåŠ¨è®¾è®¡æ¨¡æ‹ŸåŸå‹æ»¤æ³¢å™¨
                            </text>
                            <text x="400" y="40" text-anchor="middle" font-size="12" fill="#666">
                                è¿™æ˜¯è¯¾å ‚ç†è®ºçŸ¥è¯†çš„å®è·µè¡¥å……ï¼Œè§£å†³"æ¨¡æ‹Ÿæ»¤æ³¢å™¨ä»å“ªé‡Œæ¥"çš„é—®é¢˜
                            </text>
                        </g>
                    </svg>
                    <p class="figure-caption">å›¾1: IIRæ»¤æ³¢å™¨è®¾è®¡å®Œæ•´æµç¨‹ï¼ˆæ©™è‰²æ¡†ä¸ºæœ¬å®éªŒé‡ç‚¹ï¼‰</p>
                </div>
            </section>

            <!-- æ¨¡æ‹Ÿæ»¤æ³¢å™¨ç†è®º -->
            <section id="theory">
                <h2><span class="badge badge-theory">ç†è®º</span>ç»å…¸æ¨¡æ‹Ÿæ»¤æ³¢å™¨</h2>
                
                <h3>3.1 ä¸ºä»€ä¹ˆè¦"å€Ÿç”¨"æ¨¡æ‹Ÿæ»¤æ³¢å™¨ï¼Ÿ</h3>
                
                <div class="case-study-box">
                    <h4>ğŸ“» å†å²èƒŒæ™¯ï¼šç«™åœ¨å·¨äººçš„è‚©è†€ä¸Š</h4>
                    <p>åœ¨æ•°å­—ä¿¡å·å¤„ç†è¯ç”Ÿä¹‹å‰çš„100å¤šå¹´é‡Œï¼Œç”µæ°”å·¥ç¨‹å¸ˆä»¬å·²ç»å‘å±•å‡ºäº†æˆç†Ÿçš„<strong>æ¨¡æ‹Ÿæ»¤æ³¢å™¨ç†è®º</strong>ï¼š</p>
                    <ul>
                        <li><strong>1930å¹´</strong>ï¼šStephen Butterworth å‘è¡¨æœ€å¤§å¹³å¦æ»¤æ³¢å™¨ç†è®º</li>
                        <li><strong>1931å¹´</strong>ï¼šPafnuty Chebyshev çš„ç­‰æ³¢çº¹é€¼è¿‘ç†è®ºè¢«åº”ç”¨äºæ»¤æ³¢å™¨</li>
                        <li><strong>1958å¹´</strong>ï¼šWilhelm Cauer å®Œå–„äº†æ¤­åœ†æ»¤æ³¢å™¨ç†è®º</li>
                    </ul>
                    <p>è¿™äº›ç†è®ºç»è¿‡å‡ åå¹´çš„æ‰“ç£¨ï¼Œå·²ç»æœ‰äº†<strong>å®Œæ•´çš„è®¾è®¡å…¬å¼å’ŒæŸ¥è¡¨æ³•</strong>ã€‚å½“æˆ‘ä»¬éœ€è¦è®¾è®¡æ•°å­—æ»¤æ³¢å™¨æ—¶ï¼Œæœ€èªæ˜çš„åšæ³•å°±æ˜¯ï¼š</p>
                    <ol>
                        <li>å…ˆç”¨æˆç†Ÿçš„ç†è®ºè®¾è®¡ä¸€ä¸ªæ»¡è¶³æŒ‡æ ‡çš„<strong>æ¨¡æ‹Ÿæ»¤æ³¢å™¨</strong></li>
                        <li>å†ç”¨IIMæˆ–BLTæ–¹æ³•<strong>è½¬æ¢</strong>æˆæ•°å­—æ»¤æ³¢å™¨</li>
                    </ol>
                    <p>è¿™å°±æ˜¯"å€Ÿç”¨"ç­–ç•¥â€”â€”å€Ÿç”¨å‰äººçš„æ™ºæ…§æˆæœï¼</p>
                </div>
                
                <h3>3.2 ä¸‰ç§ç»å…¸æ»¤æ³¢å™¨çš„ç‰¹æ€§å¯¹æ¯”</h3>
                
                <div class="tip-box">
                    <h4>ğŸ¯ ç”¨ç”Ÿæ´»åœºæ™¯ç†è§£ä¸‰ç§æ»¤æ³¢å™¨</h4>
                    <p>å‡è®¾ä½ åœ¨è®¾è®¡ä¸€ä¸ª<strong>å£°éŸ³è¿‡æ»¤ç³»ç»Ÿ</strong>ï¼Œè¦é˜»æŒ¡é«˜é¢‘å™ªå£°ï¼Œä¿ç•™äººå£°ï¼š</p>
                    
                    <p><strong>ğŸ”µ Butterworthï¼ˆå·´ç‰¹æ²ƒæ–¯ï¼‰- "è¿½æ±‚è‡ªç„¶çš„å®Œç¾ä¸»ä¹‰è€…"</strong></p>
                    <ul>
                        <li>å°±åƒé«˜æ¡£éŸ³å“è¿½æ±‚"åŸæ±åŸå‘³"ï¼Œé€šå¸¦å†…ç»å¯¹å¹³å¦ï¼Œä¸ä¼šæ”¹å˜ä»»ä½•ä¿ç•™çš„é¢‘ç‡æˆåˆ†</li>
                        <li>ä»£ä»·ï¼šè¿‡æ¸¡å¸¦è¾ƒå®½ï¼Œ"åˆ†ç•Œ"ä¸å¤Ÿå¹²è„†ï¼Œå¯èƒ½æ¼è¿‡ä¸€äº›ä¸æƒ³è¦çš„é¢‘ç‡</li>
                        <li>é€‚ç”¨ï¼š<strong>éŸ³é¢‘å¤„ç†</strong>ï¼ˆäººè€³å¯¹å¹…åº¦å˜åŒ–æ•æ„Ÿï¼‰ã€åŒ»ç–—ä¿¡å·å¤„ç†</li>
                    </ul>
                    
                    <p><strong>ğŸŸ¢ Chebyshev Iï¼ˆåˆ‡æ¯”é›ªå¤«Iå‹ï¼‰- "åŠ¡å®çš„æ•ˆç‡è¿½æ±‚è€…"</strong></p>
                    <ul>
                        <li>å…è®¸é€šå¸¦æœ‰è½»å¾®æ³¢åŠ¨ï¼ˆå¯æ§åˆ¶åœ¨0.5dBä»¥å†…ï¼‰ï¼Œæ¢æ¥æ›´é™¡å³­çš„è¿‡æ¸¡</li>
                        <li>å°±åƒæ¥å—"ç•¥æœ‰ç‘•ç–µä½†æ€§ä»·æ¯”æ›´é«˜"çš„äº§å“</li>
                        <li>é€‚ç”¨ï¼š<strong>é€šä¿¡ç³»ç»Ÿ</strong>ï¼ˆæ•°å­—è°ƒåˆ¶å¯¹å¹…åº¦æ³¢åŠ¨ä¸æ•æ„Ÿï¼‰</li>
                    </ul>
                    
                    <p><strong>ğŸ”´ Ellipticï¼ˆæ¤­åœ†ï¼‰- "æè‡´æ•ˆç‡çš„å·¥ç¨‹å¸ˆ"</strong></p>
                    <ul>
                        <li>é€šå¸¦å’Œé˜»å¸¦éƒ½å…è®¸æ³¢åŠ¨ï¼Œæ¢æ¥æœ€çª„çš„è¿‡æ¸¡å¸¦å’Œæœ€ä½çš„é˜¶æ•°</li>
                        <li>åŒæ ·æŒ‡æ ‡ï¼Œé˜¶æ•°å¯èƒ½åªæœ‰Butterworthçš„ä¸€åŠï¼</li>
                        <li>é€‚ç”¨ï¼š<strong>åµŒå…¥å¼/å®æ—¶ç³»ç»Ÿ</strong>ï¼ˆè®¡ç®—èµ„æºæœ‰é™ï¼Œéœ€è¦æœ€ä½å¤æ‚åº¦ï¼‰</li>
                    </ul>
                </div>
                
                <h4>ç‰¹æ€§å¯¹æ¯”è¡¨</h4>
                <table>
                    <thead>
                        <tr>
                            <th>æ»¤æ³¢å™¨ç±»å‹</th>
                            <th>é€šå¸¦ç‰¹æ€§</th>
                            <th>é˜»å¸¦ç‰¹æ€§</th>
                            <th>è¿‡æ¸¡å¸¦</th>
                            <th>é˜¶æ•°æ•ˆç‡</th>
                            <th>å…¸å‹åº”ç”¨</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong style="color:#2d57a4;">Butterworth</strong></td>
                            <td>æœ€å¤§å¹³å¦ âœ“</td>
                            <td>å•è°ƒä¸‹é™</td>
                            <td>æœ€å®½</td>
                            <td>æœ€ä½</td>
                            <td>éŸ³é¢‘ã€åŒ»ç–—</td>
                        </tr>
                        <tr>
                            <td><strong style="color:#5ca353;">Chebyshev I</strong></td>
                            <td>ç­‰æ³¢çº¹</td>
                            <td>å•è°ƒä¸‹é™</td>
                            <td>è¾ƒçª„</td>
                            <td>ä¸­ç­‰</td>
                            <td>é€šä¿¡ã€é›·è¾¾</td>
                        </tr>
                        <tr>
                            <td><strong style="color:#D46A6A;">Elliptic</strong></td>
                            <td>ç­‰æ³¢çº¹</td>
                            <td>ç­‰æ³¢çº¹</td>
                            <td>æœ€çª„ âœ“</td>
                            <td>æœ€é«˜ âœ“</td>
                            <td>åµŒå…¥å¼ã€å®æ—¶</td>
                        </tr>
                    </tbody>
                </table>
                
                <h3>3.3 å¹…åº¦å“åº”æ•°å­¦è¡¨è¾¾å¼</h3>
                
                <h4>Butterworth æ»¤æ³¢å™¨</h4>
                <div class="formula-box">
                    $$|H_a(j\Omega)|^2 = \frac{1}{1 + (\Omega/\Omega_c)^{2N}}$$
                    <p>ç‰¹ç‚¹ï¼š$\Omega=0$ å¤„å‰ $2N-1$ é˜¶å¯¼æ•°ä¸ºé›¶ â†’ "æœ€å¤§å¹³å¦"</p>
                </div>

                <h4>Chebyshev I å‹æ»¤æ³¢å™¨</h4>
                <div class="formula-box">
                    $$|H_a(j\Omega)|^2 = \frac{1}{1 + \epsilon^2 T_N^2(\Omega/\Omega_p)}$$
                    <p>å…¶ä¸­ $T_N(x)$ æ˜¯Né˜¶åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼ï¼Œ$\epsilon$ æ§åˆ¶é€šå¸¦æ³¢çº¹å¹…åº¦</p>
                </div>

                <h4>Elliptic æ»¤æ³¢å™¨</h4>
                <div class="formula-box">
                    $$|H_a(j\Omega)|^2 = \frac{1}{1 + \epsilon^2 R_N^2(\Omega/\Omega_p)}$$
                    <p>å…¶ä¸­ $R_N(x)$ æ˜¯Né˜¶æ¤­åœ†æœ‰ç†å‡½æ•°ï¼ˆé›…å¯æ¯”æ¤­åœ†å‡½æ•°ï¼‰</p>
                </div>
                
                <div class="warning-box">
                    <h4>ğŸ’¡ ä¸ºä»€ä¹ˆä¸ç”¨æ‰‹ç®—è¿™äº›å…¬å¼ï¼Ÿ</h4>
                    <p>ä»¥Butterworthä¸ºä¾‹ï¼Œè¦ä»å¹…åº¦å“åº”æ¨å¯¼ä¼ é€’å‡½æ•° $H_a(s)$ï¼Œéœ€è¦ï¼š</p>
                    <ol>
                        <li>è®¡ç®—æç‚¹ä½ç½®ï¼š$p_k = \Omega_c \cdot e^{j\frac{\pi}{2N}(2k+N-1)}$ï¼Œ$k=1,2,...,N$</li>
                        <li>é€‰æ‹©å·¦åŠå¹³é¢çš„æç‚¹ï¼ˆä¿è¯ç¨³å®šï¼‰</li>
                        <li>æ„é€ ä¼ é€’å‡½æ•°ï¼š$H_a(s) = \frac{\Omega_c^N}{\prod_{k}(s-p_k)}$</li>
                    </ol>
                    <p>Chebyshevå’ŒEllipticçš„è®¡ç®—æ›´åŠ å¤æ‚ï¼Œæ¶‰åŠåŒæ›²å‡½æ•°å’Œæ¤­åœ†ç§¯åˆ†ã€‚</p>
                    <p><strong>ç»“è®º</strong>ï¼šåœ¨å®éªŒä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨MATLABçš„ <code>butter</code>ã€<code>cheby1</code>ã€<code>ellip</code> å‡½æ•°è‡ªåŠ¨å®Œæˆè¿™äº›è®¡ç®—ï¼</p>
                </div>
                
                <div class="figure-container">
                    <svg width="800" height="380" viewBox="0 0 800 380">
                        <title>ä¸‰ç§æ»¤æ³¢å™¨å¹…åº¦å“åº”å¯¹æ¯”</title>
                        <rect width="800" height="380" fill="#fafafa"/>
                        
                        <!-- æ ‡é¢˜ -->
                        <text x="400" y="30" text-anchor="middle" font-size="18" font-weight="bold" fill="#2d57a4">
                            ä¸‰ç§IIRæ»¤æ³¢å™¨å¹…åº¦å“åº”å¯¹æ¯”ï¼ˆç›¸åŒè®¾è®¡æŒ‡æ ‡ï¼‰
                        </text>
                        
                        <!-- åæ ‡è½´ -->
                        <g transform="translate(80, 320)">
                            <line x1="0" y1="0" x2="680" y2="0" stroke="#333" stroke-width="2.5"/>
                            <line x1="0" y1="0" x2="0" y2="-250" stroke="#333" stroke-width="2.5"/>
                            
                            <!-- é¢‘ç‡è½´æ ‡è®° -->
                            <text x="340" y="35" text-anchor="middle" font-size="16" font-weight="bold" fill="#333">é¢‘ç‡ Î©</text>
                            <text x="200" y="20" text-anchor="middle" font-size="14" fill="#5ca353" font-weight="bold">Î©p (é€šå¸¦)</text>
                            <text x="350" y="20" text-anchor="middle" font-size="14" fill="#D46A6A" font-weight="bold">Î©s (é˜»å¸¦)</text>
                            <line x1="200" y1="8" x2="200" y2="-8" stroke="#5ca353" stroke-width="2.5"/>
                            <line x1="350" y1="8" x2="350" y2="-8" stroke="#D46A6A" stroke-width="2.5"/>
                            
                            <!-- å¹…åº¦è½´æ ‡è®° -->
                            <text x="-50" y="-125" text-anchor="middle" font-size="14" font-weight="bold" fill="#333" transform="rotate(-90, -50, -125)">
                                å¹…åº¦ |H(jÎ©)| (dB)
                            </text>
                            <text x="-15" y="-230" text-anchor="end" font-size="12" fill="#333">0</text>
                            <text x="-15" y="-10" text-anchor="end" font-size="12" fill="#666">-Rs</text>
                            <line x1="-8" y1="-230" x2="8" y2="-230" stroke="#333" stroke-width="2"/>
                            
                            <!-- é€šå¸¦é˜»å¸¦å‚è€ƒåŒºåŸŸ -->
                            <rect x="0" y="-250" width="200" height="30" fill="#e8f5e9" opacity="0.5"/>
                            <rect x="350" y="-30" width="330" height="30" fill="#ffebee" opacity="0.5"/>
                            <text x="100" y="-258" text-anchor="middle" font-size="11" fill="#5ca353">é€šå¸¦åŒºåŸŸ</text>
                            <text x="515" y="-38" text-anchor="middle" font-size="11" fill="#D46A6A">é˜»å¸¦åŒºåŸŸ</text>
                            
                            <!-- Butterworth å“åº” (è“è‰²) -->
                            <path d="M 0,-230 Q 150,-230 200,-210 Q 275,-120 350,-50 Q 450,-20 680,-10" 
                                  fill="none" stroke="#2d57a4" stroke-width="3.5" opacity="0.9"/>
                            
                            <!-- Chebyshev I å“åº” (ç»¿è‰²ï¼Œé€šå¸¦æ³¢çº¹) -->
                            <path d="M 0,-230 L 25,-220 L 50,-230 L 75,-222 L 100,-230 L 125,-224 L 150,-230 L 175,-226 L 200,-200 Q 260,-80 350,-35 Q 450,-15 680,-8" 
                                  fill="none" stroke="#5ca353" stroke-width="3.5" opacity="0.9"/>
                            
                            <!-- Elliptic å“åº” (çº¢è‰²ï¼Œé€šå¸¦é˜»å¸¦éƒ½æœ‰æ³¢çº¹) -->
                            <path d="M 0,-230 L 25,-220 L 50,-230 L 75,-222 L 100,-230 L 125,-224 L 150,-230 L 175,-228 L 200,-180 Q 240,-40 280,-25 L 310,-32 L 340,-25 L 370,-30 L 400,-25 Q 540,-25 680,-25" 
                                  fill="none" stroke="#D46A6A" stroke-width="3.5" opacity="0.9"/>
                        </g>
                        
                        <!-- å›¾ä¾‹ -->
                        <g transform="translate(580, 70)">
                            <rect x="0" y="0" width="180" height="120" fill="white" stroke="#ddd" stroke-width="2" rx="8"/>
                            <text x="90" y="20" text-anchor="middle" font-size="12" font-weight="bold" fill="#333">æ»¤æ³¢å™¨å¯¹æ¯”</text>
                            
                            <line x1="15" y1="45" x2="55" y2="45" stroke="#2d57a4" stroke-width="3.5"/>
                            <text x="65" y="50" font-size="12" font-weight="bold" fill="#2d57a4">Butterworth</text>
                            
                            <line x1="15" y1="70" x2="55" y2="70" stroke="#5ca353" stroke-width="3.5"/>
                            <text x="65" y="75" font-size="12" font-weight="bold" fill="#5ca353">Chebyshev I</text>
                            
                            <line x1="15" y1="95" x2="55" y2="95" stroke="#D46A6A" stroke-width="3.5"/>
                            <text x="65" y="100" font-size="12" font-weight="bold" fill="#D46A6A">Elliptic</text>
                        </g>
                        
                        <!-- æ³¨è§£ -->
                        <g transform="translate(100, 120)">
                            <text x="0" y="0" font-size="11" fill="#666">â† è¿‡æ¸¡å¸¦ï¼šEllipticæœ€çª„</text>
                        </g>
                    </svg>
                    <p class="figure-caption">å›¾2: ä¸‰ç§ç»å…¸IIRæ»¤æ³¢å™¨çš„å¹…åº¦å“åº”å¯¹æ¯”</p>
                </div>
                
                <h3>3.4 MATLABè®¾è®¡å‡½æ•°é€ŸæŸ¥</h3>
                
                <table>
                    <thead>
                        <tr>
                            <th>æ­¥éª¤</th>
                            <th>Butterworth</th>
                            <th>Chebyshev I</th>
                            <th>Elliptic</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>è®¡ç®—é˜¶æ¬¡</strong></td>
                            <td><code>[N,Wn] = buttord(Wp,Ws,Rp,Rs,'s')</code></td>
                            <td><code>[N,Wn] = cheb1ord(Wp,Ws,Rp,Rs,'s')</code></td>
                            <td><code>[N,Wn] = ellipord(Wp,Ws,Rp,Rs,'s')</code></td>
                        </tr>
                        <tr>
                            <td><strong>è®¾è®¡æ¨¡æ‹ŸåŸå‹</strong></td>
                            <td><code>[num,den] = butter(N,Wn,'s')</code></td>
                            <td><code>[num,den] = cheby1(N,Rp,Wn,'s')</code></td>
                            <td><code>[num,den] = ellip(N,Rp,Rs,Wn,'s')</code></td>
                        </tr>
                        <tr>
                            <td><strong>åŒçº¿æ€§å˜æ¢</strong></td>
                            <td colspan="3"><code>[numd,dend] = bilinear(num,den,Fs)</code></td>
                        </tr>
                        <tr>
                            <td><strong>é¢‘ç‡å“åº”</strong></td>
                            <td colspan="3"><code>[H,w] = freqz(numd,dend,N)</code></td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="tip-box">
                    <h4>ğŸ“Œ å‡½æ•°å‚æ•°è¯´æ˜</h4>
                    <ul>
                        <li><code>Wp</code>, <code>Ws</code>: é¢„ç¿˜æ›²åçš„é€šå¸¦/é˜»å¸¦è¾¹ç•Œé¢‘ç‡ (rad/s)</li>
                        <li><code>Rp</code>: é€šå¸¦æœ€å¤§è¡°å‡ (dB)ï¼Œå¦‚ 0.5 è¡¨ç¤ºé€šå¸¦å†…æœ€å¤šè¡°å‡ 0.5dB</li>
                        <li><code>Rs</code>: é˜»å¸¦æœ€å°è¡°å‡ (dB)ï¼Œå¦‚ 45 è¡¨ç¤ºé˜»å¸¦è‡³å°‘è¡°å‡ 45dB</li>
                        <li><code>'s'</code>: è¡¨ç¤ºè®¾è®¡<strong>æ¨¡æ‹Ÿ</strong>æ»¤æ³¢å™¨ï¼ˆsåŸŸï¼‰ï¼Œè¿™æ˜¯å…³é”®å‚æ•°ï¼</li>
                        <li><code>Fs</code>: é‡‡æ ·é¢‘ç‡ (Hz)</li>
                    </ul>
                </div>
            </section>

            <!-- é¢‘ç‡é¢„ç¿˜æ›²è¯¦è§£ -->
            <section id="prewarping">
                <h2><span class="badge badge-theory">ç†è®º</span>é¢‘ç‡é¢„ç¿˜æ›²ï¼šBLTçš„å…³é”®è¡¥å……</h2>
                
                <h3>4.1 é—®é¢˜çš„ç”±æ¥</h3>
                <p>åœ¨è¯¾å ‚ä¸Šå­¦ä¹ BLTæ—¶ï¼Œä½ å¯èƒ½æ³¨æ„åˆ°äº†ä¸€ä¸ªæ˜ å°„å…³ç³»ï¼š</p>
                
                <div class="formula-box">
                    $$\omega = 2\arctan\left(\frac{\Omega T}{2}\right)$$
                    <p>è¿™æ„å‘³ç€ï¼šæ¨¡æ‹Ÿé¢‘ç‡ $\Omega$ å’Œæ•°å­—é¢‘ç‡ $\omega$ <strong>ä¸æ˜¯çº¿æ€§å…³ç³»</strong>ï¼</p>
                </div>
                
                <div class="case-study-box">
                    <h4>ğŸ—ºï¸ ç”¨åœ°å›¾æŠ•å½±ç†è§£é¢‘ç‡ç¿˜æ›²</h4>
                    <p>æƒ³è±¡ä½ è¦æŠŠä¸€ä¸ªçƒé¢ï¼ˆåœ°çƒï¼‰å±•å¼€æˆä¸€ä¸ªå¹³é¢åœ°å›¾ï¼š</p>
                    <ul>
                        <li><strong>é è¿‘èµ¤é“</strong>çš„åŒºåŸŸï¼ˆä½é¢‘ï¼‰ï¼šå˜å½¢è¾ƒå°ï¼Œæ¯”è¾ƒå‡†ç¡®</li>
                        <li><strong>é è¿‘æç‚¹</strong>çš„åŒºåŸŸï¼ˆé«˜é¢‘ï¼‰ï¼šè¢«ä¸¥é‡æ‹‰ä¼¸æˆ–å‹ç¼©</li>
                        <li><strong>æç‚¹æœ¬èº«</strong>ï¼ˆ$\omega = \pi$ï¼‰ï¼šæ•´ä¸ªæ— é™çš„é«˜é¢‘åŒºåŸŸè¢«å‹ç¼©åˆ°ä¸€ä¸ªç‚¹ï¼</li>
                    </ul>
                    <p>BLTçš„é¢‘ç‡æ˜ å°„å°±åƒè¿™ç§æŠ•å½±ï¼šä½é¢‘åŒºåŸŸè¿‘ä¼¼çº¿æ€§ï¼Œé«˜é¢‘åŒºåŸŸä¸¥é‡"ç¿˜æ›²"ã€‚</p>
                </div>
                
                <h3>4.2 é¢„ç¿˜æ›²çš„è§£å†³æ–¹æ¡ˆ</h3>
                <p>æ—¢ç„¶BLTä¼šå¯¼è‡´é¢‘ç‡å¤±çœŸï¼Œæˆ‘ä»¬å°±åœ¨è®¾è®¡æ¨¡æ‹Ÿæ»¤æ³¢å™¨<strong>ä¹‹å‰</strong>ï¼Œå…ˆ"åå‘å˜å½¢"ä¸€ä¸‹é¢‘ç‡ï¼š</p>
                
                <div class="formula-box">
                    <p><strong>é¢„ç¿˜æ›²å…¬å¼ï¼š</strong></p>
                    $$\Omega_{prewarped} = \frac{2}{T}\tan\left(\frac{\omega}{2}\right) = 2F_s \cdot \tan\left(\frac{\pi F}{F_s}\right)$$
                    <p>å…¶ä¸­ï¼š$F$ æ˜¯ç›®æ ‡æ•°å­—é¢‘ç‡ (Hz)ï¼Œ$F_s$ æ˜¯é‡‡æ ·é¢‘ç‡ (Hz)</p>
                </div>
                
                <div class="tip-box">
                    <h4>âœ… MATLAB ä¸­çš„é¢„ç¿˜æ›²å®ç°</h4>
                    <div class="code-block"><code><span class="code-line"><span class="code-comment">% è®¾è®¡æŒ‡æ ‡ï¼ˆæ•°å­—åŸŸï¼‰</span></span>
<span class="code-line">Fs = 80000;           <span class="code-comment">% é‡‡æ ·é¢‘ç‡ (Hz)</span></span>
<span class="code-line">Fp = 4000;            <span class="code-comment">% é€šå¸¦è¾¹ç•Œ (Hz)</span></span>
<span class="code-line">Fst = 20000;          <span class="code-comment">% é˜»å¸¦è¾¹ç•Œ (Hz)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="code-comment">% Step 1: è½¬æ¢ä¸ºæ•°å­—è§’é¢‘ç‡</span></span>
<span class="code-line">wp = 2*pi*Fp/Fs;      <span class="code-comment">% é€šå¸¦æ•°å­—è§’é¢‘ç‡ (rad/sample)</span></span>
<span class="code-line">ws = 2*pi*Fst/Fs;     <span class="code-comment">% é˜»å¸¦æ•°å­—è§’é¢‘ç‡ (rad/sample)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="code-comment">% Step 2: é¢„ç¿˜æ›² â†’ æ¨¡æ‹Ÿè§’é¢‘ç‡</span></span>
<span class="code-line">Omega_p = (2*Fs) * tan(wp/2);  <span class="code-comment">% é€šå¸¦æ¨¡æ‹Ÿè§’é¢‘ç‡ (rad/s)</span></span>
<span class="code-line">Omega_s = (2*Fs) * tan(ws/2);  <span class="code-comment">% é˜»å¸¦æ¨¡æ‹Ÿè§’é¢‘ç‡ (rad/s)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="code-comment">% ç°åœ¨å¯ä»¥ç”¨ Omega_p å’Œ Omega_s è®¾è®¡æ¨¡æ‹Ÿæ»¤æ³¢å™¨äº†ï¼</span></span></code></div>
                </div>
                
                <div class="figure-container">
                    <svg width="800" height="350" viewBox="0 0 800 350">
                        <title>é¢‘ç‡ç¿˜æ›²ä¸é¢„ç¿˜æ›²</title>
                        <rect width="800" height="350" fill="#fafafa"/>
                        
                        <!-- æ ‡é¢˜ -->
                        <text x="400" y="30" text-anchor="middle" font-size="18" font-weight="bold" fill="#2d57a4">
                            åŒçº¿æ€§å˜æ¢çš„é¢‘ç‡ç¿˜æ›²ä¸é¢„ç¿˜æ›²è¡¥å¿
                        </text>
                        
                        <!-- å·¦å›¾ï¼šæ²¡æœ‰é¢„ç¿˜æ›² -->
                        <g transform="translate(80, 80)">
                            <text x="130" y="-10" text-anchor="middle" font-size="14" fill="#D46A6A" font-weight="bold">
                                âŒ æ²¡æœ‰é¢„ç¿˜æ›²
                            </text>
                            <rect x="0" y="0" width="260" height="200" fill="white" stroke="#ddd" stroke-width="2" rx="5"/>
                            
                            <!-- åæ ‡è½´ -->
                            <line x1="30" y1="170" x2="240" y2="170" stroke="#333" stroke-width="2"/>
                            <line x1="30" y1="170" x2="30" y2="30" stroke="#333" stroke-width="2"/>
                            
                            <!-- ç†æƒ³çº¿æ€§æ˜ å°„ (è™šçº¿) -->
                            <line x1="30" y1="170" x2="240" y2="30" stroke="#5ca353" stroke-width="2" stroke-dasharray="5,3" opacity="0.6"/>
                            
                            <!-- å®é™…BLTæ˜ å°„ (arctanæ›²çº¿) -->
                            <path d="M 30,170 Q 80,120 130,75 Q 180,45 240,32" fill="none" stroke="#D46A6A" stroke-width="3"/>
                            
                            <!-- æ ‡è®°ç›®æ ‡é¢‘ç‡ç‚¹ -->
                            <circle cx="100" cy="100" r="5" fill="#2d57a4"/>
                            <line x1="100" y1="100" x2="100" y2="170" stroke="#2d57a4" stroke-width="1" stroke-dasharray="3,2"/>
                            <text x="100" y="185" text-anchor="middle" font-size="10" fill="#2d57a4">è®¾è®¡é¢‘ç‡</text>
                            
                            <circle cx="100" cy="130" r="5" fill="#D46A6A"/>
                            <text x="115" y="135" font-size="10" fill="#D46A6A">å®é™…ä½ç½®â†“</text>
                            
                            <text x="135" y="195" text-anchor="middle" font-size="12" fill="#333">Î© (æ¨¡æ‹Ÿ)</text>
                            <text x="15" y="100" font-size="11" fill="#333" transform="rotate(-90,15,100)">Ï‰ (æ•°å­—)</text>
                        </g>
                        
                        <!-- å³å›¾ï¼šæœ‰é¢„ç¿˜æ›² -->
                        <g transform="translate(440, 80)">
                            <text x="130" y="-10" text-anchor="middle" font-size="14" fill="#5ca353" font-weight="bold">
                                âœ… ä½¿ç”¨é¢„ç¿˜æ›²
                            </text>
                            <rect x="0" y="0" width="260" height="200" fill="white" stroke="#ddd" stroke-width="2" rx="5"/>
                            
                            <!-- åæ ‡è½´ -->
                            <line x1="30" y1="170" x2="240" y2="170" stroke="#333" stroke-width="2"/>
                            <line x1="30" y1="170" x2="30" y2="30" stroke="#333" stroke-width="2"/>
                            
                            <!-- å®é™…BLTæ˜ å°„ -->
                            <path d="M 30,170 Q 80,120 130,75 Q 180,45 240,32" fill="none" stroke="#666" stroke-width="2" opacity="0.5"/>
                            
                            <!-- é¢„ç¿˜æ›²åçš„è®¾è®¡ç‚¹ -->
                            <circle cx="130" cy="75" r="5" fill="#5ca353"/>
                            <line x1="130" y1="75" x2="130" y2="170" stroke="#5ca353" stroke-width="1" stroke-dasharray="3,2"/>
                            <text x="130" y="185" text-anchor="middle" font-size="10" fill="#5ca353">é¢„ç¿˜æ›²å</text>
                            
                            <!-- æœ€ç»ˆæ­£ç¡®çš„æ•°å­—é¢‘ç‡ -->
                            <line x1="30" y1="100" x2="130" y2="100" stroke="#5ca353" stroke-width="1" stroke-dasharray="3,2"/>
                            <circle cx="30" cy="100" r="5" fill="#5ca353"/>
                            <text x="60" y="90" font-size="10" fill="#5ca353">ç›®æ ‡é¢‘ç‡ âœ“</text>
                            
                            <text x="135" y="195" text-anchor="middle" font-size="12" fill="#333">Î© (æ¨¡æ‹Ÿ)</text>
                            <text x="15" y="100" font-size="11" fill="#333" transform="rotate(-90,15,100)">Ï‰ (æ•°å­—)</text>
                        </g>
                        
                        <!-- åº•éƒ¨è¯´æ˜ -->
                        <g transform="translate(50, 310)">
                            <text x="350" y="0" text-anchor="middle" font-size="13" fill="#333">
                                <tspan font-weight="bold">é¢„ç¿˜æ›²åŸç†ï¼š</tspan>
                                å…ˆæŠŠç›®æ ‡é¢‘ç‡"åå‘å˜å½¢"ï¼Œç»è¿‡BLTçš„"æ­£å‘å˜å½¢"åï¼Œæ°å¥½å›åˆ°æ­£ç¡®ä½ç½®
                            </text>
                        </g>
                    </svg>
                    <p class="figure-caption">å›¾3: é¢‘ç‡ç¿˜æ›²é—®é¢˜åŠé¢„ç¿˜æ›²è§£å†³æ–¹æ¡ˆ</p>
                </div>
            </section>

            <!-- äº¤äº’æ¼”ç¤º -->
            <section id="demo">
                <h2><span class="badge badge-practice">å®è·µ</span>äº¤äº’æ¼”ç¤ºï¼šIIRæ»¤æ³¢å™¨é¢‘ç‡å“åº”</h2>
                
                <div class="interactive-demo">
                    <h3 style="color: #2d57a4; margin-top: 0;">ğŸ›ï¸ äº¤äº’å¼æ»¤æ³¢å™¨è®¾è®¡æ¼”ç¤º</h3>
                    <p>è°ƒæ•´ä¸‹é¢çš„å‚æ•°ï¼Œè§‚å¯Ÿä¸åŒIIRæ»¤æ³¢å™¨çš„é¢‘ç‡å“åº”ç‰¹æ€§ï¼š</p>
                    
                    <div class="control-panel">
                        <div class="control-group">
                            <label>æ»¤æ³¢å™¨ç±»å‹:</label>
                            <select id="filterType">
                                <option value="butterworth">Butterworth (æœ€å¹³å¦)</option>
                                <option value="chebyshev1">Chebyshev I (ç­‰æ³¢çº¹é€šå¸¦)</option>
                                <option value="elliptic">Elliptic (æœ€é«˜æ•ˆ)</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>æ»¤æ³¢å™¨é˜¶æ•° N: <span id="orderValue">4</span></label>
                            <input type="range" id="filterOrder" min="2" max="10" value="4">
                        </div>
                        <div class="control-group">
                            <label>å½’ä¸€åŒ–æˆªæ­¢é¢‘ç‡: <span id="cutoffValue">0.30</span>Ï€</label>
                            <input type="range" id="cutoffFreq" min="0.1" max="0.9" step="0.01" value="0.3">
                        </div>
                        <div class="control-group">
                            <label>é€šå¸¦æ³¢çº¹ (dB): <span id="rippleValue">1.0</span></label>
                            <input type="range" id="passRipple" min="0.1" max="3" step="0.1" value="1">
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: center; flex-wrap: wrap; gap: 20px;">
                        <div class="canvas-container">
                            <h4>å¹…åº¦å“åº”</h4>
                            <canvas id="magnitudeCanvas" width="400" height="300"></canvas>
                        </div>
                        <div class="canvas-container">
                            <h4>ç›¸ä½å“åº”</h4>
                            <canvas id="phaseCanvas" width="400" height="300"></canvas>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 15px; background: white; border-radius: 8px; text-align: left; max-width: 600px; margin-left: auto; margin-right: auto;">
                        <span id="infoText" style="font-size: 1em; line-height: 1.8;"></span>
                    </div>
                </div>
            </section>

            <!-- ç¤ºä¾‹è®²è§£ -->
            <section id="example">
                <h2><span class="badge badge-practice">å®è·µ</span>ç¤ºä¾‹è®²è§£</h2>
                
                <div class="exercise-box">
                    <h3>å®Œæ•´ç¤ºä¾‹ï¼šButterworth æ•°å­—ä½é€šæ»¤æ³¢å™¨è®¾è®¡</h3>
                    <p><strong>è®¾è®¡è¦æ±‚ï¼š</strong></p>
                    <ul>
                        <li>é‡‡æ ·é¢‘ç‡ï¼š$F_s = 80$ kHz</li>
                        <li>é€šå¸¦è¾¹ç•Œï¼š$F_p = 4$ kHzï¼Œæœ€å¤§è¡°å‡ $R_p = 0.5$ dB</li>
                        <li>é˜»å¸¦è¾¹ç•Œï¼š$F_{st} = 20$ kHzï¼Œæœ€å°è¡°å‡ $R_s = 45$ dB</li>
                    </ul>
                </div>

                <div class="code-block"><code><span class="code-line"><span class="code-comment">%% å®Œæ•´ç¤ºä¾‹ï¼šButterworth æ•°å­—ä½é€šæ»¤æ³¢å™¨è®¾è®¡</span></span>
<span class="code-line"><span class="code-comment">% è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†ä»è®¾è®¡æŒ‡æ ‡åˆ°æœ€ç»ˆæ•°å­—æ»¤æ³¢å™¨çš„å®Œæ•´æµç¨‹</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="code-comment">%% Step 1: å®šä¹‰è®¾è®¡æŒ‡æ ‡ï¼ˆæ•°å­—åŸŸï¼‰</span></span>
<span class="code-line">Fs = 80000;           <span class="code-comment">% é‡‡æ ·é¢‘ç‡ (Hz)</span></span>
<span class="code-line">Fp = 4000;            <span class="code-comment">% é€šå¸¦è¾¹ç•Œé¢‘ç‡ (Hz)</span></span>
<span class="code-line">Fst = 20000;          <span class="code-comment">% é˜»å¸¦è¾¹ç•Œé¢‘ç‡ (Hz)</span></span>
<span class="code-line">Rp = 0.5;             <span class="code-comment">% é€šå¸¦æœ€å¤§è¡°å‡ (dB)</span></span>
<span class="code-line">Rs = 45;              <span class="code-comment">% é˜»å¸¦æœ€å°è¡°å‡ (dB)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="code-comment">%% Step 2: é¢‘ç‡é¢„ç¿˜æ›²ï¼ˆè¯¾å ‚BLTå…¬å¼çš„å®è·µåº”ç”¨ï¼‰</span></span>
<span class="code-line"><span class="code-comment">% å°†æ•°å­—é¢‘ç‡è½¬æ¢ä¸ºæ¨¡æ‹Ÿé¢‘ç‡ï¼Œè¡¥å¿åŒçº¿æ€§å˜æ¢çš„é¢‘ç‡ç•¸å˜</span></span>
<span class="code-line">wp = 2*pi*Fp/Fs;                  <span class="code-comment">% é€šå¸¦æ•°å­—è§’é¢‘ç‡ (rad/sample)</span></span>
<span class="code-line">ws = 2*pi*Fst/Fs;                 <span class="code-comment">% é˜»å¸¦æ•°å­—è§’é¢‘ç‡ (rad/sample)</span></span>
<span class="code-line">Omega_p = (2*Fs) * tan(wp/2);     <span class="code-comment">% é¢„ç¿˜æ›²åçš„é€šå¸¦æ¨¡æ‹Ÿè§’é¢‘ç‡ (rad/s)</span></span>
<span class="code-line">Omega_s = (2*Fs) * tan(ws/2);     <span class="code-comment">% é¢„ç¿˜æ›²åçš„é˜»å¸¦æ¨¡æ‹Ÿè§’é¢‘ç‡ (rad/s)</span></span>
<span class="code-line"></span>
<span class="code-line">fprintf(<span class="code-string">'é¢„ç¿˜æ›²ç»“æœ:\n'</span>);</span>
<span class="code-line">fprintf(<span class="code-string">'  Omega_p = %.2f rad/s (åŸå§‹: %.2f)\n'</span>, Omega_p, 2*pi*Fp);</span>
<span class="code-line">fprintf(<span class="code-string">'  Omega_s = %.2f rad/s (åŸå§‹: %.2f)\n'</span>, Omega_s, 2*pi*Fst);</span>
<span class="code-line"></span>
<span class="code-line"><span class="code-comment">%% Step 3: è®¡ç®—æ»¤æ³¢å™¨é˜¶æ¬¡ï¼ˆæœ¬å®éªŒæ ¸å¿ƒ - æ¨¡æ‹Ÿæ»¤æ³¢å™¨è®¾è®¡ï¼‰</span></span>
<span class="code-line">[N, Wn] = buttord(Omega_p, Omega_s, Rp, Rs, <span class="code-string">'s'</span>);</span>
<span class="code-line">fprintf(<span class="code-string">'æ»¤æ³¢å™¨é˜¶æ¬¡: N = %d\n'</span>, N);</span>
<span class="code-line">fprintf(<span class="code-string">'æˆªæ­¢é¢‘ç‡: Wn = %.2f rad/s\n'</span>, Wn);</span>
<span class="code-line"></span>
<span class="code-line"><span class="code-comment">%% Step 4: è®¾è®¡æ¨¡æ‹ŸåŸå‹æ»¤æ³¢å™¨</span></span>
<span class="code-line">[num_a, den_a] = butter(N, Wn, <span class="code-string">'s'</span>);  <span class="code-comment">% 's' è¡¨ç¤ºæ¨¡æ‹Ÿæ»¤æ³¢å™¨</span></span>
<span class="code-line">fprintf(<span class="code-string">'æ¨¡æ‹Ÿæ»¤æ³¢å™¨ Ha(s) è®¾è®¡å®Œæˆ\n'</span>);</span>
<span class="code-line"></span>
<span class="code-line"><span class="code-comment">%% Step 5: åŒçº¿æ€§å˜æ¢ï¼ˆè¯¾å ‚å·²å­¦çš„BLTï¼‰</span></span>
<span class="code-line">[num_d, den_d] = bilinear(num_a, den_a, Fs);</span>
<span class="code-line">fprintf(<span class="code-string">'æ•°å­—æ»¤æ³¢å™¨ H(z) è®¾è®¡å®Œæˆ\n'</span>);</span>
<span class="code-line"></span>
<span class="code-line"><span class="code-comment">%% Step 6: éªŒè¯ä¸åˆ†æ</span></span>
<span class="code-line">[H, w] = freqz(num_d, den_d, 2048);</span>
<span class="code-line">f = w * Fs / (2*pi);  <span class="code-comment">% è½¬æ¢ä¸ºHz</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="code-comment">% ç»˜åˆ¶å¹…åº¦å“åº”</span></span>
<span class="code-line">figure(<span class="code-string">'Position'</span>, [100, 100, 900, 400]);</span>
<span class="code-line">plot(f, 20*log10(abs(H)), <span class="code-string">'b-'</span>, <span class="code-string">'LineWidth'</span>, 2);</span>
<span class="code-line"><span class="code-keyword">hold</span> on;</span>
<span class="code-line"></span>
<span class="code-line"><span class="code-comment">% æ ‡è®°è®¾è®¡æŒ‡æ ‡</span></span>
<span class="code-line">plot([Fp Fp], [-80 5], <span class="code-string">'g--'</span>, <span class="code-string">'LineWidth'</span>, 1.5);  <span class="code-comment">% é€šå¸¦è¾¹ç•Œ</span></span>
<span class="code-line">plot([Fst Fst], [-80 5], <span class="code-string">'r--'</span>, <span class="code-string">'LineWidth'</span>, 1.5); <span class="code-comment">% é˜»å¸¦è¾¹ç•Œ</span></span>
<span class="code-line">plot([0 Fp], [-Rp -Rp], <span class="code-string">'g:'</span>, <span class="code-string">'LineWidth'</span>, 1.5);   <span class="code-comment">% é€šå¸¦è¡°å‡é™</span></span>
<span class="code-line">plot([Fst Fs/2], [-Rs -Rs], <span class="code-string">'r:'</span>, <span class="code-string">'LineWidth'</span>, 1.5); <span class="code-comment">% é˜»å¸¦è¡°å‡é™</span></span>
<span class="code-line"></span>
<span class="code-line">grid on;</span>
<span class="code-line">xlabel(<span class="code-string">'é¢‘ç‡ (Hz)'</span>);</span>
<span class="code-line">ylabel(<span class="code-string">'å¹…åº¦ (dB)'</span>);</span>
<span class="code-line">title(sprintf(<span class="code-string">'Butterworth ä½é€šæ»¤æ³¢å™¨ (N=%d)'</span>, N));</span>
<span class="code-line">legend(<span class="code-string">'å¹…åº¦å“åº”'</span>, <span class="code-string">'é€šå¸¦è¾¹ç•Œ'</span>, <span class="code-string">'é˜»å¸¦è¾¹ç•Œ'</span>, <span class="code-string">'Location'</span>, <span class="code-string">'southwest'</span>);</span>
<span class="code-line">xlim([0 Fs/2]);</span>
<span class="code-line">ylim([-80 5]);</span></code></div>

                <div class="analysis-box">
                    <h4>ğŸ” ä»£ç è§£æï¼šå¯¹åº”è¯¾å ‚çŸ¥è¯†</h4>
                    <table>
                        <tr>
                            <th>ä»£ç æ­¥éª¤</th>
                            <th>å¯¹åº”è¯¾å ‚çŸ¥è¯†</th>
                            <th>è¯´æ˜</th>
                        </tr>
                        <tr>
                            <td>Step 2: é¢„ç¿˜æ›²</td>
                            <td>BLTçš„é¢‘ç‡æ˜ å°„ $\omega = 2\arctan(\Omega T/2)$</td>
                            <td>åå‘ä½¿ç”¨æ˜ å°„å…¬å¼ï¼Œè¡¥å¿ç•¸å˜</td>
                        </tr>
                        <tr>
                            <td>Step 3-4: æ¨¡æ‹Ÿæ»¤æ³¢å™¨</td>
                            <td><span style="color:#e65100;">æœ¬å®éªŒæ–°å­¦å†…å®¹</span></td>
                            <td>ä½¿ç”¨MATLABè‡ªåŠ¨è®¾è®¡ $H_a(s)$</td>
                        </tr>
                        <tr>
                            <td>Step 5: bilinear</td>
                            <td>BLTå…¬å¼ $s = \frac{2}{T}\frac{z-1}{z+1}$</td>
                            <td>MATLABè‡ªåŠ¨å®Œæˆå˜æ¢</td>
                        </tr>
                    </table>
                </div>
            </section>

            <!-- ç»ƒä¹ ä¸€ -->
            <section id="exercise1">
                <h2><span class="badge badge-practice">å®è·µ</span>ç»ƒä¹ ä¸€ï¼šButterworth æ•°å­—ä½é€šæ»¤æ³¢å™¨è®¾è®¡</h2>
                <div class="exercise-box">
                    <h3>ä»»åŠ¡</h3>
                    <div class="question-item">
                        <h4>ä»»åŠ¡æè¿°</h4>
                        <p>è®¾è®¡ä¸€ä¸ªButterworthæ•°å­—ä½é€šæ»¤æ³¢å™¨ï¼Œæ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š</p>
                        <ul>
                            <li>é‡‡æ ·é¢‘ç‡ï¼š$F_s = 80$ kHz</li>
                            <li>é€šå¸¦è¾¹ç•Œï¼š$F_p = 4$ kHzï¼Œæœ€å¤§è¡°å‡ $R_p = 0.5$ dB</li>
                            <li>é˜»å¸¦è¾¹ç•Œï¼š$F_{st} = 20$ kHzï¼Œæœ€å°è¡°å‡ $R_s = 45$ dB</li>
                            <li>ä½¿ç”¨åŒçº¿æ€§å˜æ¢æ–¹æ³•</li>
                        </ul>
                    </div>
                    
                    <div class="analysis-box">
                        <h4>ä»»åŠ¡è¦æ±‚</h4>
                        <ol>
                            <li>æŒ‰ç…§ç¤ºä¾‹çš„6ä¸ªæ­¥éª¤å®Œæˆè®¾è®¡</li>
                            <li>è®¡ç®—å¹¶è¾“å‡ºæ»¤æ³¢å™¨é˜¶æ¬¡ $N$ å’Œæˆªæ­¢é¢‘ç‡ $W_n$</li>
                            <li>ç»˜åˆ¶å¹…åº¦å“åº”å›¾ï¼Œæ ‡è®°é€šå¸¦è¾¹ç•Œã€é˜»å¸¦è¾¹ç•Œå’Œè®¾è®¡æŒ‡æ ‡çº¿</li>
                            <li>éªŒè¯è®¾è®¡ç»“æœæ˜¯å¦æ»¡è¶³æŒ‡æ ‡è¦æ±‚</li>
                        </ol>
                    </div>
                    
                    <h4>é¢„æœŸç»“æœ</h4>
                    <p>æ»¤æ³¢å™¨é˜¶æ¬¡ N = 4ï¼Œé€šå¸¦å¹³å¦ï¼ˆæœ€å¤§è¡°å‡ < 0.5dBï¼‰ï¼Œé˜»å¸¦è¡°å‡ > 45dB</p>
                </div>
            </section>

            <!-- ç»ƒä¹ äºŒ -->
            <section id="exercise2">
                <h2><span class="badge badge-practice">å®è·µ</span>ç»ƒä¹ äºŒï¼šChebyshev I å‹æ•°å­—ä½é€šæ»¤æ³¢å™¨è®¾è®¡</h2>
                <div class="exercise-box">
                    <h3>ä»»åŠ¡</h3>
                    <div class="question-item">
                        <h4>ä»»åŠ¡æè¿°</h4>
                        <p>ä½¿ç”¨ä¸ç»ƒä¹ 1<strong>ç›¸åŒçš„è®¾è®¡æŒ‡æ ‡</strong>ï¼Œè®¾è®¡ä¸€ä¸ªChebyshev Iå‹æ•°å­—ä½é€šæ»¤æ³¢å™¨ï¼š</p>
                        <ul>
                            <li>é‡‡æ ·é¢‘ç‡ï¼š$F_s = 80$ kHz</li>
                            <li>é€šå¸¦è¾¹ç•Œï¼š$F_p = 4$ kHzï¼Œæœ€å¤§è¡°å‡ $R_p = 0.5$ dB</li>
                            <li>é˜»å¸¦è¾¹ç•Œï¼š$F_{st} = 20$ kHzï¼Œæœ€å°è¡°å‡ $R_s = 45$ dB</li>
                        </ul>
                    </div>
                    
                    <div class="analysis-box">
                        <h4>ä»»åŠ¡è¦æ±‚</h4>
                        <ol>
                            <li>ä½¿ç”¨ <code>cheb1ord</code> å’Œ <code>cheby1</code> å‡½æ•°</li>
                            <li>æ³¨æ„ï¼š<code>cheby1</code> éœ€è¦é¢å¤–çš„ $R_p$ å‚æ•°</li>
                            <li>ç»˜åˆ¶å¹…åº¦å“åº”å¹¶ä¸ç»ƒä¹ 1å¯¹æ¯”</li>
                            <li><strong>å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š</strong>
                                <ul>
                                    <li>Q1: é˜¶æ•°æ˜¯å¦æ¯”Butterworthæ›´ä½ï¼Ÿä½å¤šå°‘ï¼Ÿ</li>
                                    <li>Q2: é€šå¸¦æ˜¯å¦æœ‰æ³¢çº¹ï¼Ÿæ³¢çº¹å¹…åº¦å¤§çº¦æ˜¯å¤šå°‘dBï¼Ÿ</li>
                                    <li>Q3: è¿‡æ¸¡å¸¦æ˜¯å¦æ›´é™¡å³­ï¼Ÿ</li>
                                </ul>
                            </li>
                        </ol>
                    </div>
                </div>
            </section>

            <!-- ç»ƒä¹ ä¸‰ -->
            <section id="exercise3">
                <h2><span class="badge badge-practice">å®è·µ</span>ç»ƒä¹ ä¸‰ï¼šElliptic æ•°å­—ä½é€šæ»¤æ³¢å™¨è®¾è®¡</h2>
                <div class="exercise-box">
                    <h3>ä»»åŠ¡</h3>
                    <div class="question-item">
                        <h4>ä»»åŠ¡æè¿°</h4>
                        <p>ç»§ç»­ä½¿ç”¨ç›¸åŒçš„è®¾è®¡æŒ‡æ ‡ï¼Œè®¾è®¡ä¸€ä¸ªEllipticï¼ˆæ¤­åœ†ï¼‰æ•°å­—ä½é€šæ»¤æ³¢å™¨ã€‚</p>
                    </div>
                    
                    <div class="analysis-box">
                        <h4>ä»»åŠ¡è¦æ±‚</h4>
                        <ol>
                            <li>ä½¿ç”¨ <code>ellipord</code> å’Œ <code>ellip</code> å‡½æ•°</li>
                            <li>æ³¨æ„ï¼š<code>ellip</code> éœ€è¦åŒæ—¶æŒ‡å®š $R_p$ å’Œ $R_s$ å‚æ•°</li>
                            <li>
    <strong>åˆ¶ä½œç»¼åˆå¯¹æ¯”è¡¨æ ¼ï¼š</strong>
    <p style="font-size: 0.9em; color: #666; margin: 5px 0 10px 0;">
        ğŸ“Œ æ ¹æ®ç»ƒä¹ 1-3çš„<strong>å®éªŒç»“æœ</strong>å¡«å†™ä¸‹è¡¨ï¼ˆä½¿ç”¨ç›¸åŒçš„è®¾è®¡æŒ‡æ ‡ï¼‰
    </p>
                                <table style="width: 100%; margin-top: 10px;">
                                    <thead>
                                        <tr>
                                            <th>ç‰¹æ€§</th>
                                            <th>Butterworth</th>
                                            <th>Chebyshev I</th>
                                            <th>Elliptic</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>æ»¤æ³¢å™¨é˜¶æ•° N</td>
                                            <td>?</td>
                                            <td>?</td>
                                            <td>?</td>
                                        </tr>
                                        <tr>
                                            <td>é€šå¸¦ç‰¹æ€§</td>
                                            <td>?</td>
                                            <td>?</td>
                                            <td>?</td>
                                        </tr>
                                        <tr>
                                            <td>é˜»å¸¦ç‰¹æ€§</td>
                                            <td>?</td>
                                            <td>?</td>
                                            <td>?</td>
                                        </tr>
                                        <tr>
                                            <td>è¿‡æ¸¡å¸¦å®½åº¦</td>
                                            <td>?</td>
                                            <td>?</td>
                                            <td>?</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </li>
                        </ol>
                    </div>
                </div>
            </section>

            <!-- ç»ƒä¹ å›› -->
            <section id="exercise4">
                <h2><span class="badge badge-practice">å®è·µ</span>ç»ƒä¹ å››ï¼šå®é™…åº”ç”¨ä¸­çš„æ»¤æ³¢å™¨é€‰æ‹©</h2>
                <div class="exercise-box">
                    <h3>ä»»åŠ¡ (æ€è€ƒé¢˜)</h3>
                    <div class="question-item">
                        <h4>åœºæ™¯1ï¼šéŸ³é¢‘å‡è¡¡å™¨è®¾è®¡</h4>
                        <p>ä½ æ­£åœ¨ä¸ºä¸€æ¬¾éŸ³ä¹æ’­æ”¾Appè®¾è®¡å‡è¡¡å™¨ã€‚é‡‡æ ·ç‡44.1 kHzï¼Œéœ€è¦ä¸€ä¸ªä½é€šæ»¤æ³¢å™¨æ¶ˆé™¤20 kHzä»¥ä¸Šå™ªå£°ã€‚</p>
                        <ul>
                            <li>Q1: ä½ ä¼šé€‰æ‹©å“ªç§æ»¤æ³¢å™¨ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</li>
                            <li>Q2: é€šå¸¦æ³¢çº¹å¯¹éŸ³è´¨æœ‰ä»€ä¹ˆå½±å“ï¼Ÿ</li>
                            <li>Q3: ç›¸ä½å¤±çœŸå¯¹éŸ³è´¨æœ‰ä»€ä¹ˆå½±å“ï¼Ÿå¦‚ä½•å‡è½»ï¼Ÿ</li>
                        </ul>
                    </div>
                    
                    <div class="question-item">
                        <h4>åœºæ™¯2ï¼šé€šä¿¡ä¿¡é“é€‰æ‹©</h4>
                        <p>éœ€è¦ä»å¤šä¸ªç›¸é‚»ä¿¡é“ä¸­é€‰å‡º900-910 kHzçš„ç›®æ ‡ä¿¡é“ï¼ŒæŠ‘åˆ¶ç›¸é‚»ä¿¡é“å¹²æ‰°ã€‚</p>
                        <ul>
                            <li>Q1: è¿™ç§åœºæ™¯æ›´é€‚åˆå“ªç§æ»¤æ³¢å™¨ï¼Ÿ</li>
                            <li>Q2: å¦‚æœButterworthéœ€è¦12é˜¶ï¼ŒEllipticåªéœ€6é˜¶ï¼Œä½ å¦‚ä½•é€‰æ‹©ï¼Ÿ</li>
                            <li>Q3: è®¾è®¡å¸¦é€šæ»¤æ³¢å™¨éœ€è¦å“ªäº›MATLABå‡½æ•°ï¼Ÿ</li>
                        </ul>
                    </div>
                    
                    <div class="question-item">
                        <h4>åœºæ™¯3ï¼šåµŒå…¥å¼å®æ—¶å¤„ç†</h4>
                        <p>åœ¨æ‰‹æœºèŠ¯ç‰‡ä¸Šå®ç°å®æ—¶è¯­éŸ³æ»¤æ³¢ï¼Œè®¡ç®—èµ„æºæœ‰é™ã€‚</p>
                        <ul>
                            <li>Q1: æ»¤æ³¢å™¨é˜¶æ•°ä¸è®¡ç®—å¤æ‚åº¦çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ</li>
                            <li>Q2: é˜¶æ•°ä»12é™åˆ°6æ„å‘³ç€ä»€ä¹ˆï¼Ÿï¼ˆè®¡ç®—é‡ã€åŠŸè€—ã€å»¶è¿Ÿï¼‰</li>
                            <li>Q3: å¦‚ä½•åœ¨å®æ—¶æ€§å’Œæ»¤æ³¢æ•ˆæœä¹‹é—´æƒè¡¡ï¼Ÿ</li>
                        </ul>
                    </div>
                </div>

                <h3>å®éªŒæŠ¥å‘Šè¦æ±‚</h3>
                <div class="warning-box">
                    <h4>ğŸ“ æŠ¥å‘Šå†…å®¹</h4>
                    <ol>
                        <li><strong>å®éªŒç›®çš„å’ŒåŸç†</strong>ï¼šè¯´æ˜æœ¬å®éªŒå¦‚ä½•è¡¥å……è¯¾å ‚çŸ¥è¯†</li>
                        <li><strong>è®¾è®¡è¿‡ç¨‹</strong>ï¼šè¯¦ç»†è®°å½•æ¯ä¸ªç»ƒä¹ çš„è®¾è®¡æ­¥éª¤å’ŒMATLABä»£ç </li>
                        <li><strong>ç»“æœä¸åˆ†æ</strong>ï¼šä¸‰ç§æ»¤æ³¢å™¨çš„å¯¹æ¯”è¡¨æ ¼ã€é¢‘ç‡å“åº”å›¾</li>
                        <li><strong>æ€è€ƒé¢˜å›ç­”</strong>ï¼šå¯¹ç»ƒä¹ 4çš„é—®é¢˜ç»™å‡ºåˆ†æ</li>
                        <li><strong>ç»“è®º</strong>ï¼šæ€»ç»“ä¸åŒåº”ç”¨åœºæ™¯ä¸‹å¦‚ä½•é€‰æ‹©æ»¤æ³¢å™¨</li>
                    </ol>
                </div>
            </section>

            <!-- é™„å½•ï¼šè„‰å†²å“åº”ä¸å˜æ³• -->
            <section id="appendix">
                <h2><span class="badge badge-review">é™„å½•</span>è„‰å†²å“åº”ä¸å˜æ³•ï¼ˆIIMï¼‰è¡¥å……è¯´æ˜</h2>
                
                <div class="appendix-section">
                    <h3>A.1 ä¸ºä»€ä¹ˆæœ¬å®éªŒä¸»è¦ä½¿ç”¨BLTè€ŒéIIMï¼Ÿ</h3>
                    
                    <p>åœ¨è¯¾å ‚ä¸Šï¼Œä½ å­¦ä¹ äº†ä¸¤ç§å°†æ¨¡æ‹Ÿæ»¤æ³¢å™¨è½¬æ¢ä¸ºæ•°å­—æ»¤æ³¢å™¨çš„æ–¹æ³•ã€‚æœ¬å®éªŒé€‰æ‹©<strong>åŒçº¿æ€§å˜æ¢æ³•(BLT)</strong>ä½œä¸ºä¸»è¦æ–¹æ³•ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>æ¯”è¾ƒé¡¹</th>
                                <th>è„‰å†²å“åº”ä¸å˜æ³• (IIM)</th>
                                <th>åŒçº¿æ€§å˜æ¢æ³• (BLT)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>é¢‘ç‡æ··å </strong></td>
                                <td style="color:#D46A6A;">âŒ æœ‰æ··å é—®é¢˜ï¼ˆé«˜é¢‘åˆ†é‡ä¼šæŠ˜å åˆ°ä½é¢‘ï¼‰</td>
                                <td style="color:#5ca353;">âœ… æ— æ··å ï¼ˆæ•´ä¸ªæ¨¡æ‹Ÿé¢‘ç‡è½´æ˜ å°„åˆ° $-\pi$ ~ $\pi$ï¼‰</td>
                            </tr>
                            <tr>
                                <td><strong>é¢‘ç‡æ˜ å°„</strong></td>
                                <td style="color:#5ca353;">âœ… çº¿æ€§æ˜ å°„ $\omega = \Omega T$</td>
                                <td style="color:#f57c00;">âš ï¸ éçº¿æ€§æ˜ å°„ï¼ˆéœ€è¦é¢„ç¿˜æ›²è¡¥å¿ï¼‰</td>
                            </tr>
                            <tr>
                                <td><strong>é€‚ç”¨æ»¤æ³¢å™¨ç±»å‹</strong></td>
                                <td style="color:#D46A6A;">âŒ ä»…ä½é€šã€å¸¦é€šï¼ˆé«˜é€šå’Œå¸¦é˜»æœ‰é—®é¢˜ï¼‰</td>
                                <td style="color:#5ca353;">âœ… æ‰€æœ‰ç±»å‹ï¼ˆä½é€šã€é«˜é€šã€å¸¦é€šã€å¸¦é˜»ï¼‰</td>
                            </tr>
                            <tr>
                                <td><strong>æ—¶åŸŸç‰¹æ€§ä¿æŒ</strong></td>
                                <td style="color:#5ca353;">âœ… è„‰å†²å“åº”å®Œå…¨å¯¹åº”</td>
                                <td style="color:#f57c00;">âš ï¸ è„‰å†²å“åº”æœ‰å·®å¼‚</td>
                            </tr>
                            <tr>
                                <td><strong>å·¥ç¨‹åº”ç”¨</strong></td>
                                <td>è¾ƒå°‘ä½¿ç”¨</td>
                                <td><strong>ä¸»æµæ–¹æ³•</strong></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h3>A.2 IIMçš„æ ¸å¿ƒåŸç†å›é¡¾</h3>
                    
                    <div class="formula-box">
                        <p><strong>åŸºæœ¬æ€æƒ³ï¼š</strong>è®©æ•°å­—æ»¤æ³¢å™¨çš„è„‰å†²å“åº”ç­‰äºæ¨¡æ‹Ÿæ»¤æ³¢å™¨è„‰å†²å“åº”çš„é‡‡æ ·å€¼</p>
                        $$h[n] = T \cdot h_a(nT)$$
                        <p>å…¶ä¸­ $T = 1/F_s$ æ˜¯é‡‡æ ·å‘¨æœŸ</p>
                    </div>
                    
                    <div class="formula-box">
                        <p><strong>é¢‘åŸŸæ˜ å°„ï¼š</strong></p>
                        $$H(e^{j\omega}) = \sum_{k=-\infty}^{\infty} H_a\left(j\frac{\omega - 2\pi k}{T}\right)$$
                        <p>è¿™ä¸ªæ±‚å’Œè¡¨æ˜ï¼šæ¨¡æ‹Ÿæ»¤æ³¢å™¨çš„é¢‘ç‡å“åº”ä¼šä»¥ $2\pi/T$ ä¸ºå‘¨æœŸäº§ç”Ÿ<strong>æ··å </strong></p>
                    </div>
                    
                    <h3>A.3 IIMçš„é¢‘ç‡æ··å é—®é¢˜å›¾ç¤º</h3>
                    
                    <div class="figure-container">
                        <svg width="800" height="300" viewBox="0 0 800 300">
                            <rect width="800" height="300" fill="#fafafa"/>
                            
                            <text x="400" y="25" text-anchor="middle" font-size="16" font-weight="bold" fill="#2d57a4">
                                è„‰å†²å“åº”ä¸å˜æ³•çš„é¢‘ç‡æ··å é—®é¢˜
                            </text>
                            
                            <!-- å·¦å›¾ï¼šæ¨¡æ‹Ÿæ»¤æ³¢å™¨ -->
                            <g transform="translate(50, 60)">
                                <text x="150" y="0" text-anchor="middle" font-size="13" fill="#333" font-weight="bold">åŸå§‹æ¨¡æ‹Ÿæ»¤æ³¢å™¨ Ha(jÎ©)</text>
                                <rect x="0" y="10" width="300" height="100" fill="white" stroke="#ddd" stroke-width="1"/>
                                <line x1="20" y1="100" x2="280" y2="100" stroke="#333" stroke-width="1.5"/>
                                <line x1="150" y1="100" x2="150" y2="20" stroke="#333" stroke-width="1.5"/>
                                
                                <!-- ä½é€šå“åº” -->
                                <path d="M 20,100 L 20,30 L 100,30 Q 120,30 130,60 Q 140,90 150,100" fill="none" stroke="#2d57a4" stroke-width="2.5"/>
                                <path d="M 150,100 Q 160,90 170,60 Q 180,30 200,30 L 280,30" fill="none" stroke="#2d57a4" stroke-width="2.5" opacity="0.3"/>
                                
                                <text x="150" y="120" text-anchor="middle" font-size="11" fill="#666">Î©</text>
                            </g>
                            
                            <!-- å³å›¾ï¼šé‡‡æ ·åï¼ˆæœ‰æ··å ï¼‰ -->
                            <g transform="translate(420, 60)">
                                <text x="150" y="0" text-anchor="middle" font-size="13" fill="#333" font-weight="bold">IIMè½¬æ¢å H(ejÏ‰) - æœ‰æ··å !</text>
                                <rect x="0" y="10" width="300" height="100" fill="white" stroke="#ddd" stroke-width="1"/>
                                <line x1="20" y1="100" x2="280" y2="100" stroke="#333" stroke-width="1.5"/>
                                <line x1="150" y1="100" x2="150" y2="20" stroke="#333" stroke-width="1.5"/>
                                
                                <!-- ä¸»ç“£ -->
                                <path d="M 100,100 L 100,35 Q 110,30 130,30 Q 145,30 150,50" fill="none" stroke="#2d57a4" stroke-width="2.5"/>
                                <path d="M 150,50 Q 155,30 170,30 Q 190,30 200,35 L 200,100" fill="none" stroke="#2d57a4" stroke-width="2.5"/>
                                
                                <!-- æ··å éƒ¨åˆ†ï¼ˆç”¨çº¢è‰²æ ‡è®°ï¼‰ -->
                                <path d="M 20,100 L 20,70 Q 40,50 60,50 Q 80,50 100,70" fill="none" stroke="#D46A6A" stroke-width="2.5" stroke-dasharray="5,3"/>
                                <path d="M 200,70 Q 220,50 240,50 Q 260,50 280,70 L 280,100" fill="none" stroke="#D46A6A" stroke-width="2.5" stroke-dasharray="5,3"/>
                                
                                <text x="150" y="120" text-anchor="middle" font-size="11" fill="#666">Ï‰</text>
                                <text x="50" y="55" text-anchor="middle" font-size="10" fill="#D46A6A" font-weight="bold">æ··å !</text>
                                <text x="250" y="55" text-anchor="middle" font-size="10" fill="#D46A6A" font-weight="bold">æ··å !</text>
                            </g>
                            
                            <!-- ç®­å¤´ -->
                            <path d="M 360 110 L 400 110" stroke="#608de0" stroke-width="2" marker-end="url(#arrowblue2)"/>
                            <text x="380" y="100" text-anchor="middle" font-size="11" fill="#608de0">IIM</text>
                            
                            <defs>
                                <marker id="arrowblue2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                    <polygon points="0 0, 10 3, 0 6" fill="#608de0"/>
                                </marker>
                            </defs>
                            
                            <!-- è¯´æ˜ -->
                            <g transform="translate(50, 200)">
                                <rect x="0" y="0" width="700" height="80" rx="8" fill="#ffebee" stroke="#D46A6A"/>
                                <text x="350" y="25" text-anchor="middle" font-size="13" fill="#c62828" font-weight="bold">
                                    âš ï¸ IIMçš„è‡´å‘½ç¼ºé™·ï¼šé¢‘ç‡æ··å 
                                </text>
                                <text x="350" y="50" text-anchor="middle" font-size="12" fill="#333">
                                    å½“æ¨¡æ‹Ÿæ»¤æ³¢å™¨çš„å¸¦å®½è¶…è¿‡ Fs/2 æ—¶ï¼Œé«˜é¢‘åˆ†é‡ä¼š"æŠ˜å "åˆ°ä½é¢‘åŒºåŸŸï¼Œé€ æˆå¤±çœŸ
                                </text>
                                <text x="350" y="70" text-anchor="middle" font-size="12" fill="#333">
                                    å› æ­¤ IIM åªé€‚ç”¨äºå¸¦é™çš„ä½é€š/å¸¦é€šæ»¤æ³¢å™¨ï¼Œä¸”éœ€è¦è¶³å¤Ÿé«˜çš„é‡‡æ ·ç‡
                                </text>
                            </g>
                        </svg>
                        <p class="figure-caption">å›¾A1: IIMçš„é¢‘ç‡æ··å é—®é¢˜ç¤ºæ„å›¾</p>
                    </div>
                    
                    <h3>A.4 MATLABä¸­çš„IIMå®ç°</h3>
                    
                    <div class="tip-box">
                        <h4>ğŸ“ MATLABå‡½æ•°ï¼šimpinvar</h4>
                        <p>è™½ç„¶æœ¬å®éªŒä¸è¦æ±‚ä½¿ç”¨IIMï¼Œä½†å¦‚æœä½ æƒ³å°è¯•ï¼ŒMATLABæä¾›äº† <code>impinvar</code> å‡½æ•°ï¼š</p>
                        <div class="code-block"><code><span class="code-line"><span class="code-comment">% ä½¿ç”¨è„‰å†²å“åº”ä¸å˜æ³•ï¼ˆä»…ä¾›å‚è€ƒï¼Œæœ¬å®éªŒä¸è¦æ±‚ï¼‰</span></span>
<span class="code-line">[num_d_iim, den_d_iim] = impinvar(num_a, den_a, Fs);</span>
<span class="code-line"></span>
<span class="code-line"><span class="code-comment">% å¯¹æ¯” BLT æ–¹æ³•</span></span>
<span class="code-line">[num_d_blt, den_d_blt] = bilinear(num_a, den_a, Fs);</span></code></div>
                    </div>
                    
                    <h3>A.5 ä½•æ—¶è€ƒè™‘ä½¿ç”¨IIMï¼Ÿ</h3>
                    
                    <div class="analysis-box">
                        <h4>ğŸ¤” IIMçš„é€‚ç”¨åœºæ™¯</h4>
                        <p>è™½ç„¶BLTæ˜¯ä¸»æµæ–¹æ³•ï¼Œä½†åœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹IIMå¯èƒ½æœ‰ä¼˜åŠ¿ï¼š</p>
                        <ul>
                            <li><strong>éœ€è¦ç²¾ç¡®çš„æ—¶åŸŸå“åº”</strong>ï¼šä¾‹å¦‚æ¨¡æ‹ŸæŸä¸ªç‰¹å®šçš„æ¨¡æ‹Ÿç³»ç»Ÿ</li>
                            <li><strong>ä½é€šæ»¤æ³¢å™¨ + é«˜é‡‡æ ·ç‡</strong>ï¼šæ··å å¯å¿½ç•¥ä¸è®¡</li>
                            <li><strong>çº¿æ€§é¢‘ç‡æ˜ å°„æ›´é‡è¦</strong>ï¼šä¸å¸Œæœ›é¢‘ç‡ç¿˜æ›²å½±å“è®¾è®¡</li>
                        </ul>
                        <p>ä½†åœ¨å¤§å¤šæ•°å·¥ç¨‹åº”ç”¨ä¸­ï¼ŒBLTå› å…¶æ— æ··å å’Œé€šç”¨æ€§è€Œæ›´å—æ¬¢è¿ã€‚</p>
                    </div>
                </div>
            </section>
        </div>

        <footer>
            <p>&copy; 2025 å—äº¬å·¥ä¸šå¤§å­¦æµ¦æ±Ÿå­¦é™¢ è®¡ç®—æœºä¸é€šä¿¡å·¥ç¨‹å­¦é™¢</p>
            <p>é€šä¿¡å·¥ç¨‹ä¸“ä¸š | æ•°å­—ä¿¡å·å¤„ç†è¯¾ç¨‹å®éªŒ</p>
        </footer>
    </div>

    <script>
        // äº¤äº’æ¼”ç¤ºè„šæœ¬
        const magnitudeCanvas = document.getElementById('magnitudeCanvas');
        const phaseCanvas = document.getElementById('phaseCanvas');
        const magCtx = magnitudeCanvas.getContext('2d');
        const phaseCtx = phaseCanvas.getContext('2d');

        const filterTypeSelect = document.getElementById('filterType');
        const filterOrderSlider = document.getElementById('filterOrder');
        const cutoffFreqSlider = document.getElementById('cutoffFreq');
        const passRippleSlider = document.getElementById('passRipple');
        
        const orderValueDisplay = document.getElementById('orderValue');
        const cutoffValueDisplay = document.getElementById('cutoffValue');
        const rippleValueDisplay = document.getElementById('rippleValue');
        const infoText = document.getElementById('infoText');

        function updateDisplayValues() {
            orderValueDisplay.textContent = filterOrderSlider.value;
            cutoffValueDisplay.textContent = parseFloat(cutoffFreqSlider.value).toFixed(2);
            rippleValueDisplay.textContent = parseFloat(passRippleSlider.value).toFixed(1);
        }

        function drawMagnitudeResponse(type, order, cutoff, ripple) {
            const width = magnitudeCanvas.width;
            const height = magnitudeCanvas.height;
            const padding = 50;
            
            magCtx.clearRect(0, 0, width, height);
            
            magCtx.fillStyle = '#FFFFFF';
            magCtx.fillRect(0, 0, width, height);
            
            // ç»˜åˆ¶ç½‘æ ¼
            magCtx.strokeStyle = '#e0e0e0';
            magCtx.lineWidth = 0.5;
            for(let i = 1; i <= 4; i++) {
                const y = padding + (height - 2*padding) * i / 4;
                magCtx.beginPath();
                magCtx.moveTo(padding, y);
                magCtx.lineTo(width - padding, y);
                magCtx.stroke();
            }
            for(let i = 1; i <= 4; i++) {
                const x = padding + (width - 2*padding) * i / 4;
                magCtx.beginPath();
                magCtx.moveTo(x, padding);
                magCtx.lineTo(x, height - padding);
                magCtx.stroke();
            }
            
            // ç»˜åˆ¶åæ ‡è½´
            magCtx.strokeStyle = '#333';
            magCtx.lineWidth = 2;
            magCtx.beginPath();
            magCtx.moveTo(padding, height - padding);
            magCtx.lineTo(width - padding, height - padding);
            magCtx.moveTo(padding, height - padding);
            magCtx.lineTo(padding, padding);
            magCtx.stroke();
            
            // æ ‡ç­¾
            magCtx.fillStyle = '#333';
            magCtx.font = 'bold 13px Arial';
            magCtx.textAlign = 'center';
            magCtx.fillText('Ï‰/Ï€', width / 2, height - padding + 35);
            magCtx.save();
            magCtx.translate(15, height/2);
            magCtx.rotate(-Math.PI/2);
            magCtx.fillText('å¹…åº¦ (dB)', 0, 0);
            magCtx.restore();
            
            // åˆ»åº¦
            magCtx.font = '11px Arial';
            for(let i = 0; i <= 4; i++) {
                const x = padding + (width - 2*padding) * i / 4;
                magCtx.fillText((i/4 * 2).toFixed(1), x, height - padding + 20);
            }
            
            for(let i = 0; i <= 4; i++) {
                const y = height - padding - (height - 2*padding) * i / 4;
                magCtx.textAlign = 'right';
                magCtx.fillText((-20*i).toString(), padding - 10, y + 5);
            }
            
            // æ ‡è®°æˆªæ­¢é¢‘ç‡
            const cutoffX = padding + (width - 2*padding) * cutoff / 2;
            magCtx.strokeStyle = '#D46A6A';
            magCtx.lineWidth = 2;
            magCtx.setLineDash([5, 5]);
            magCtx.beginPath();
            magCtx.moveTo(cutoffX, padding);
            magCtx.lineTo(cutoffX, height - padding);
            magCtx.stroke();
            magCtx.setLineDash([]);
            
            magCtx.fillStyle = '#D46A6A';
            magCtx.font = 'bold 11px Arial';
            magCtx.textAlign = 'center';
            magCtx.fillText('Ï‰c', cutoffX, padding - 10);
            
            // ç»˜åˆ¶é¢‘ç‡å“åº”
            const numPoints = 500;
            const gradient = magCtx.createLinearGradient(padding, 0, width - padding, 0);
            
            if(type === 'butterworth') {
                gradient.addColorStop(0, '#2d57a4');
                gradient.addColorStop(cutoff, '#608de0');
                gradient.addColorStop(1, '#7dadff');
            } else if(type === 'chebyshev1') {
                gradient.addColorStop(0, '#2e7d32');
                gradient.addColorStop(cutoff, '#5ca353');
                gradient.addColorStop(1, '#81c784');
            } else {
                gradient.addColorStop(0, '#912d32');
                gradient.addColorStop(cutoff, '#D46A6A');
                gradient.addColorStop(1, '#ef9a9a');
            }
            
            magCtx.strokeStyle = gradient;
            magCtx.lineWidth = 3;
            magCtx.beginPath();
            
            for(let i = 0; i < numPoints; i++) {
                const w = Math.PI * i / numPoints;
                let H;
                
                if(type === 'butterworth') {
                    H = 1 / Math.sqrt(1 + Math.pow(Math.tan(w/2) / Math.tan(cutoff * Math.PI/2), 2*order));
                } else if(type === 'chebyshev1') {
                    const epsilon = Math.sqrt(Math.pow(10, ripple/10) - 1);
                    const x = Math.tan(w/2) / Math.tan(cutoff * Math.PI/2);
                    let Tn;
                    if(Math.abs(x) <= 1) {
                        Tn = Math.cos(order * Math.acos(x));
                    } else {
                        Tn = Math.cosh(order * Math.acosh(x));
                    }
                    H = 1 / Math.sqrt(1 + epsilon*epsilon * Tn*Tn);
                } else {
                    const epsilon = Math.sqrt(Math.pow(10, ripple/10) - 1);
                    const x = Math.tan(w/2) / Math.tan(cutoff * Math.PI/2);
                    let approx;
                    if(Math.abs(x) <= 1) {
                        approx = Math.cos(order * Math.acos(x)) * (1 + 0.2*Math.sin(order*x*3));
                    } else {
                        approx = Math.cosh(order * Math.acosh(x));
                    }
                    H = 1 / Math.sqrt(1 + epsilon*epsilon * approx*approx);
                }
                
                const H_dB = 20 * Math.log10(H);
                const H_clamped = Math.max(H_dB, -80);
                
                const x = padding + (width - 2*padding) * w / Math.PI;
                const y = height - padding - (height - 2*padding) * (H_clamped + 80) / 80;
                
                if(i === 0) {
                    magCtx.moveTo(x, y);
                } else {
                    magCtx.lineTo(x, y);
                }
            }
            magCtx.stroke();
        }

        function drawPhaseResponse(type, order, cutoff, ripple) {
            const width = phaseCanvas.width;
            const height = phaseCanvas.height;
            const padding = 50;
            
            phaseCtx.clearRect(0, 0, width, height);
            
            phaseCtx.fillStyle = '#FFFFFF';
            phaseCtx.fillRect(0, 0, width, height);
            
            // ç»˜åˆ¶ç½‘æ ¼
            phaseCtx.strokeStyle = '#e0e0e0';
            phaseCtx.lineWidth = 0.5;
            for(let i = 1; i <= 4; i++) {
                const y = padding + (height - 2*padding) * i / 4;
                phaseCtx.beginPath();
                phaseCtx.moveTo(padding, y);
                phaseCtx.lineTo(width - padding, y);
                phaseCtx.stroke();
            }
            for(let i = 1; i <= 4; i++) {
                const x = padding + (width - 2*padding) * i / 4;
                phaseCtx.beginPath();
                phaseCtx.moveTo(x, padding);
                phaseCtx.lineTo(x, height - padding);
                phaseCtx.stroke();
            }
            
            // ç»˜åˆ¶åæ ‡è½´
            phaseCtx.strokeStyle = '#333';
            phaseCtx.lineWidth = 2;
            phaseCtx.beginPath();
            phaseCtx.moveTo(padding, height - padding);
            phaseCtx.lineTo(width - padding, height - padding);
            phaseCtx.moveTo(padding, padding);
            phaseCtx.lineTo(padding, height - padding);
            phaseCtx.stroke();
            
            const centerY = padding + (height - 2*padding) / 2;
            
            // æ ‡ç­¾
            phaseCtx.fillStyle = '#333';
            phaseCtx.font = 'bold 13px Arial';
            phaseCtx.textAlign = 'center';
            phaseCtx.fillText('Ï‰/Ï€', width / 2, height - padding + 35);
            phaseCtx.save();
            phaseCtx.translate(15, height/2);
            phaseCtx.rotate(-Math.PI/2);
            phaseCtx.fillText('ç›¸ä½ (åº¦)', 0, 0);
            phaseCtx.restore();
            
            // åˆ»åº¦
            phaseCtx.font = '11px Arial';
            for(let i = 0; i <= 4; i++) {
                const x = padding + (width - 2*padding) * i / 4;
                phaseCtx.fillText((i/4 * 2).toFixed(1), x, height - padding + 20);
            }
            
            for(let i = 0; i <= 4; i++) {
                const y = height - padding - (height - 2*padding) * i / 4;
                phaseCtx.textAlign = 'right';
                phaseCtx.fillText((-90*i).toString() + 'Â°', padding - 10, y + 5);
            }
            
            // ç»˜åˆ¶ç›¸ä½å“åº”
            const numPoints = 500;
            const gradient = phaseCtx.createLinearGradient(padding, 0, width - padding, 0);
            gradient.addColorStop(0, '#608de0');
            gradient.addColorStop(0.5, '#7dadff');
            gradient.addColorStop(1, '#9ec5ff');
            
            phaseCtx.strokeStyle = gradient;
            phaseCtx.lineWidth = 3;
            phaseCtx.beginPath();
            
            for(let i = 0; i < numPoints; i++) {
                const w = Math.PI * i / numPoints;
                const phase = -order * w * 180 / Math.PI * 0.8; 
                const phase_clamped = Math.max(phase, -360);
                
                const x = padding + (width - 2*padding) * w / Math.PI;
                const y = padding + (height - 2*padding) * (1 - (phase_clamped + 360) / 360);
                
                if(i === 0) {
                    phaseCtx.moveTo(x, padding);
                } else {
                    phaseCtx.lineTo(x, y);
                }
            }
            phaseCtx.stroke();
        }

        function updateInfo(type, order) {
            const typeNames = {
                'butterworth': 'Butterworth (å·´ç‰¹æ²ƒæ–¯)',
                'chebyshev1': 'Chebyshev I (åˆ‡æ¯”é›ªå¤«Iå‹)',
                'elliptic': 'Elliptic (æ¤­åœ†)'
            };
            
            const characteristics = {
                'butterworth': 'é€šå¸¦æœ€å¹³å¦ï¼Œæ— æ³¢çº¹ï¼›é˜»å¸¦å•è°ƒä¸‹é™ï¼›è¿‡æ¸¡å¸¦è¾ƒå®½ï¼›ç›¸ä½å“åº”æœ€æ¥è¿‘çº¿æ€§ã€‚<strong>é€‚åˆéŸ³é¢‘å¤„ç†</strong>ã€‚',
                'chebyshev1': 'é€šå¸¦æœ‰ç­‰æ³¢çº¹ï¼Œé˜»å¸¦å•è°ƒä¸‹é™ï¼›è¿‡æ¸¡å¸¦è¾ƒçª„ï¼›é˜¶æ•°æ¯”Butterworthä½30-40%ã€‚<strong>é€‚åˆé€šä¿¡ç³»ç»Ÿ</strong>ã€‚',
                'elliptic': 'é€šå¸¦å’Œé˜»å¸¦éƒ½æœ‰ç­‰æ³¢çº¹ï¼›è¿‡æ¸¡å¸¦æœ€çª„ï¼Œé˜¶æ•°æœ€ä½ï¼›ç›¸ä½éçº¿æ€§æœ€å¤§ã€‚<strong>é€‚åˆåµŒå…¥å¼/å®æ—¶ç³»ç»Ÿ</strong>ã€‚'
            };
            
            const colors = {
                'butterworth': '#2d57a4',
                'chebyshev1': '#5ca353',
                'elliptic': '#D46A6A'
            };
            
            infoText.innerHTML = `
                <span style="color: ${colors[type]}; font-weight: bold; font-size: 1.1em;">${typeNames[type]}</span><br>
                <strong>é˜¶æ•°ï¼š</strong>N = ${order}<br>
                <strong>ç‰¹æ€§ï¼š</strong>${characteristics[type]}
            `;
        }

        function updateDemo() {
            const type = filterTypeSelect.value;
            const order = parseInt(filterOrderSlider.value);
            const cutoff = parseFloat(cutoffFreqSlider.value);
            const ripple = parseFloat(passRippleSlider.value);
            
            updateDisplayValues();
            drawMagnitudeResponse(type, order, cutoff, ripple);
            drawPhaseResponse(type, order, cutoff, ripple);
            updateInfo(type, order);
        }

        filterTypeSelect.addEventListener('change', updateDemo);
        filterOrderSlider.addEventListener('input', updateDemo);
        cutoffFreqSlider.addEventListener('input', updateDemo);
        passRippleSlider.addEventListener('input', updateDemo);
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', updateDemo);
    </script>
</body>
</html>
