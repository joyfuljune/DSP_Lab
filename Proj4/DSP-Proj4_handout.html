<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DTWå­¤ç«‹è¯è¯­éŸ³è¯†åˆ« - å®éªŒæ‰‹å†Œ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: { inlineMath: [['$','$']], displayMath: [['$$','$$']], processEscapes: true },
            CommonHTML: { scale: 110 }
        });
    </script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            line-height: 1.8;
            color: #2c3e50;
            background: linear-gradient(135deg, #1a5276 0%, #2e86ab 100%);
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.25);
            overflow: hidden;
        }
        header {
            background: linear-gradient(135deg, #1a5276 0%, #2e86ab 100%);
            color: white;
            padding: 40px;
            text-align: center;
            border-bottom: 5px solid #48c9b0;
        }
        header h1 { font-size: 2.5em; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        header .subtitle { font-size: 1.1em; opacity: 0.95; margin-top: 8px; }
        header .institution { font-size: 0.95em; margin-top: 12px; opacity: 0.9; border-top: 2px solid rgba(255,255,255,0.3); padding-top: 12px; }
        nav {
            background: #f5f7fa;
            padding: 15px 40px;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            justify-content: center;
            border-bottom: 3px solid #48c9b0;
        }
        nav a {
            color: #1a5276;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s;
            font-size: 0.9em;
            font-weight: 500;
            background: white;
            border: 2px solid #48c9b0;
        }
        nav a:hover { background: #48c9b0; color: white; transform: translateY(-2px); }
        section { margin-bottom: 0; padding: 40px; }
        #overview { background: #fff; }
        #preemphasis { background: #f8f9ff; }
        #framing { background: #fff5f5; }
        #mfcc { background: #f0fff4; }
        #dtw { background: #fffaf0; }
        #experiments { background: #f5f7ff; }
        h2 { color: #1a5276; font-size: 1.9em; margin-bottom: 20px; padding-bottom: 12px; border-bottom: 4px solid #48c9b0; }
        h3 { color: #2e86ab; font-size: 1.4em; margin: 25px 0 15px 0; }
        h4 { color: #1a5276; font-size: 1.15em; margin: 20px 0 12px 0; }
        p { margin-bottom: 12px; text-align: justify; }
        code { background-color: #edf2f7; color: #1a5276; padding: 2px 6px; border-radius: 4px; font-family: Consolas, monospace; font-size: 0.9em; }
        .info-box { background: linear-gradient(135deg, #e8f4f8 0%, #d1ecf1 100%); border-left: 5px solid #2e86ab; padding: 18px; margin: 20px 0; border-radius: 8px; }
        .info-box strong { color: #1a5276; }
        .warning-box { background: linear-gradient(135deg, #fff5f5 0%, #fed7d7 100%); border-left: 5px solid #e74c3c; padding: 18px; margin: 20px 0; border-radius: 8px; }
        .warning-box strong { color: #c0392b; }
        .success-box { background: linear-gradient(135deg, #f0fff4 0%, #c6f6d5 100%); border-left: 5px solid #48bb78; padding: 18px; margin: 20px 0; border-radius: 8px; }
        .success-box strong { color: #2f855a; }
        .formula-box { background: linear-gradient(135deg, #f7fafc 0%, #fff 100%); border-left: 5px solid #2e86ab; padding: 20px; margin: 20px 0; border-radius: 8px; border: 2px solid #48c9b0; overflow-x: auto; }
        .figure { margin: 25px 0; text-align: center; }
        .figure-caption { margin-top: 10px; font-style: italic; color: #666; font-size: 0.95em; }
        canvas { display: block; margin: 0 auto; border: 1px solid #ddd; border-radius: 8px; background: white; }
        .two-column { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
        .three-column { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 20px 0; }
        @media (max-width: 768px) { .two-column, .three-column { grid-template-columns: 1fr; } section { padding: 25px 15px; } }
        .step-box { background: white; padding: 18px; border-radius: 8px; border: 2px solid #e2e8f0; transition: all 0.3s; }
        .step-box:hover { border-color: #48c9b0; box-shadow: 0 4px 16px rgba(72,201,176,0.2); transform: translateY(-2px); }
        .comparison-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin: 20px 0; }
        .comparison-card { background: white; padding: 20px; border-radius: 10px; border: 2px solid #e2e8f0; text-align: center; transition: all 0.3s; }
        .comparison-card:hover { border-color: #48c9b0; transform: translateY(-3px); }
        .comparison-card h4 { margin: 0 0 10px 0; color: #1a5276; }
        .comparison-card p { margin: 0; font-size: 0.95em; color: #666; text-align: center; }
        .comparison-card.completed { border-color: #48bb78; background: linear-gradient(135deg, #f0fff4 0%, #fff 100%); }
        .comparison-card.required { border-color: #ed8936; background: linear-gradient(135deg, #fffaf0 0%, #fff 100%); }
        ul, ol { margin: 15px 0 15px 30px; }
        li { margin: 8px 0; line-height: 1.7; }
        table { width: 100%; border-collapse: collapse; margin: 18px 0; border-radius: 8px; overflow: hidden; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0; }
        th { background: linear-gradient(135deg, #1a5276, #2e86ab); color: white; }
        tr:hover { background: #f7fafc; }
        .tag { display: inline-block; padding: 3px 10px; border-radius: 12px; font-size: 0.75em; font-weight: 600; margin-left: 8px; }
        .tag-required { background: #fed7d7; color: #c53030; }
        .tag-completed { background: #c6f6d5; color: #276749; }
        .legend { display: flex; justify-content: center; gap: 20px; margin: 10px 0; flex-wrap: wrap; }
        .legend-item { display: flex; align-items: center; gap: 6px; font-size: 0.85em; }
        .legend-color { width: 20px; height: 4px; border-radius: 2px; }
        .dtw-controls { display: flex; gap: 10px; margin: 15px 0; flex-wrap: wrap; justify-content: center; }
        .dtw-btn { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-family: inherit; font-size: 0.9em; font-weight: 500; transition: all 0.2s; }
        .dtw-btn-primary { background: #1a5276; color: white; }
        .dtw-btn-primary:hover { background: #2e86ab; }
        .dtw-btn-secondary { background: #e2e8f0; color: #1a5276; }
        .dtw-btn-secondary:hover { background: #cbd5e0; }
        .dtw-status { background: #f7fafc; border: 1px solid #e2e8f0; border-radius: 6px; padding: 12px 16px; font-family: Consolas, monospace; font-size: 0.9em; color: #4a5568; min-height: 60px; }
        .back-to-top { position: fixed; bottom: 30px; right: 30px; width: 50px; height: 50px; background: linear-gradient(135deg, #1a5276, #2e86ab); color: white; border: none; border-radius: 50%; cursor: pointer; opacity: 0; transition: all 0.3s; font-size: 1.5em; z-index: 999; }
        .back-to-top.visible { opacity: 1; }
        .back-to-top:hover { transform: translateY(-5px); }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ¤ DTW å­¤ç«‹è¯è¯­éŸ³è¯†åˆ«</h1>
            <p class="subtitle">Dynamic Time Warping for Isolated Word Recognition</p>
            <p class="institution">æ•°å­—ä¿¡å·å¤„ç† Â· é¡¹ç›®4</p>
        </header>

        <nav>
            <a href="#overview">å®éªŒæ¦‚è¿°</a>
            <a href="#preemphasis">é¢„åŠ é‡</a>
            <a href="#framing">åˆ†å¸§åŠ çª—</a>
            <a href="#mfcc">MFCCç‰¹å¾</a>
            <a href="#dtw">DTWç®—æ³•</a>
            <a href="#experiments">å®éªŒä»»åŠ¡</a>
        </nav>

        <div class="content">
            <!-- å®éªŒæ¦‚è¿° -->
            <section id="overview">
                <h2>ğŸ“‹ å®éªŒæ¦‚è¿°</h2>
                <p>æœ¬å®éªŒå®ç°åŸºäº<strong>åŠ¨æ€æ—¶é—´è§„æ•´ï¼ˆDTWï¼‰</strong>çš„å­¤ç«‹è¯è¯­éŸ³è¯†åˆ«ç³»ç»Ÿï¼Œç›®æ ‡æ˜¯è¯†åˆ«ä¸­æ–‡æ•°å­— 0-9 çš„è¯­éŸ³ã€‚</p>
                <div class="info-box">
                    <strong>ğŸ¯ å®éªŒç›®æ ‡ï¼š</strong>
                    <p>ç†è§£è¯­éŸ³è¯†åˆ«çš„åŸºæœ¬æµç¨‹ï¼ŒæŒæ¡ MFCC ç‰¹å¾æå–å’Œ DTW æ¨¡æ¿åŒ¹é…ç®—æ³•ã€‚</p>
                </div>
                <h3>ç³»ç»Ÿå¤„ç†æµç¨‹</h3>
                <div class="figure">
                    <canvas id="flowCanvas" width="900" height="160"></canvas>
                    <p class="figure-caption">å›¾1ï¼šDTWè¯­éŸ³è¯†åˆ«ç³»ç»Ÿçš„å®Œæ•´å¤„ç†æµç¨‹</p>
                </div>
                <h3>ä¸ºä»€ä¹ˆéœ€è¦è¿™äº›å¤„ç†æ­¥éª¤ï¼Ÿ</h3>
                <div class="two-column">
                    <div class="step-box">
                        <h4>ğŸ”Š è¯­éŸ³ä¿¡å·çš„ç‰¹ç‚¹</h4>
                        <ul style="margin-left: 15px;">
                            <li>é«˜é¢‘èƒ½é‡è¡°å‡ â†’ éœ€è¦<strong>é¢„åŠ é‡</strong></li>
                            <li>éå¹³ç¨³ä¿¡å· â†’ éœ€è¦<strong>åˆ†å¸§</strong>å¤„ç†</li>
                            <li>äººè€³æ„ŸçŸ¥éçº¿æ€§ â†’ éœ€è¦<strong>Melå°ºåº¦</strong></li>
                        </ul>
                    </div>
                    <div class="step-box">
                        <h4>â±ï¸ è¯†åˆ«çš„éš¾ç‚¹</h4>
                        <ul style="margin-left: 15px;">
                            <li>ä¸åŒäººè¯´è¯è¯­é€Ÿä¸åŒ</li>
                            <li>åŒä¸€ä¸ªè¯é•¿åº¦å¯èƒ½ä¸åŒ</li>
                            <li>éœ€è¦<strong>DTW</strong>è¿›è¡Œæ—¶é—´å¯¹é½</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- é¢„åŠ é‡ -->
            <section id="preemphasis">
                <h2>ğŸ”§ ç¬¬ä¸€æ­¥ï¼šé¢„åŠ é‡ (Pre-emphasis)</h2>
                <p>è¯­éŸ³ä¿¡å·åœ¨å‘å£°è¿‡ç¨‹ä¸­ï¼Œé«˜é¢‘åˆ†é‡çš„èƒ½é‡ä¼šæœ‰æ˜æ˜¾è¡°å‡ã€‚<strong>é¢„åŠ é‡</strong>é€šè¿‡ä¸€é˜¶é«˜é€šæ»¤æ³¢å™¨æå‡é«˜é¢‘èƒ½é‡ï¼Œä½¿é¢‘è°±æ›´åŠ å¹³å¦ã€‚</p>
                <div class="formula-box">
                    <p><strong>é¢„åŠ é‡æ»¤æ³¢å™¨ï¼š</strong></p>
                    <p>$$y[n] = x[n] - \alpha \cdot x[n-1]$$</p>
                    <p>å…¶ä¸­ $\alpha = 0.97$ æ˜¯é¢„åŠ é‡ç³»æ•°ï¼Œæ»¤æ³¢å™¨ä¼ é€’å‡½æ•°ä¸º $H(z) = 1 - \alpha z^{-1}$</p>
                </div>
                <h3>é¢„åŠ é‡æ•ˆæœå¯è§†åŒ–</h3>
                <div class="figure">
                    <canvas id="preemphCanvas" width="900" height="350"></canvas>
                    <div class="legend">
                        <div class="legend-item"><div class="legend-color" style="background: #2b5797;"></div>åŸå§‹ä¿¡å·</div>
                        <div class="legend-item"><div class="legend-color" style="background: #e74c3c;"></div>é¢„åŠ é‡å</div>
                    </div>
                    <p class="figure-caption">å›¾2ï¼šé¢„åŠ é‡å‰åå¯¹æ¯” - æ—¶åŸŸæ³¢å½¢ï¼ˆä¸Šï¼‰ä¸é¢‘ç‡å“åº”ï¼ˆä¸‹ï¼‰</p>
                </div>
                <div class="info-box">
                    <strong>ğŸ’¡ ç†è§£è¦ç‚¹ï¼š</strong>
                    <p>é¢„åŠ é‡æœ¬è´¨æ˜¯ä¸€ä¸ª<strong>ä¸€é˜¶å·®åˆ†æ»¤æ³¢å™¨</strong>ï¼Œé«˜é¢‘å˜åŒ–å¿«çš„éƒ¨åˆ†è¢«å¢å¼ºï¼Œä½é¢‘å¹³ç¼“çš„éƒ¨åˆ†è¢«å‰Šå¼±ã€‚</p>
                </div>
            </section>

            <!-- åˆ†å¸§åŠ çª— -->
            <section id="framing">
                <h2>ğŸ“¦ ç¬¬äºŒæ­¥ï¼šåˆ†å¸§ä¸åŠ çª—</h2>
                <h3>2.1 ä¸ºä»€ä¹ˆè¦åˆ†å¸§ï¼Ÿ</h3>
                <p>è¯­éŸ³ä¿¡å·æ˜¯<strong>éå¹³ç¨³</strong>çš„ï¼Œä½†åœ¨çŸ­æ—¶é—´å†…ï¼ˆ10-30msï¼‰å¯ä»¥è¿‘ä¼¼ä¸º<strong>çŸ­æ—¶å¹³ç¨³</strong>ã€‚åˆ†å¸§å°†é•¿ä¿¡å·åˆ‡åˆ†æˆçŸ­å¸§è¿›è¡Œåˆ†æã€‚</p>
                <div class="formula-box">
                    <p><strong>åˆ†å¸§å‚æ•°ï¼š</strong></p>
                    <p>$$å¸§æ•° = \left\lfloor \frac{ä¿¡å·é•¿åº¦ - å¸§é•¿}{å¸§ç§»} \right\rfloor + 1$$</p>
                    <p>$$ç¬¬ i å¸§èµ·å§‹ä½ç½® = (i-1) \times å¸§ç§» + 1$$</p>
                </div>
                <div class="three-column">
                    <div class="step-box" style="text-align: center;">
                        <h4>å¸§é•¿</h4>
                        <p style="font-size: 1.5em; color: #1a5276; font-weight: bold;">25 ms</p>
                        <p>16kHz â†’ 400é‡‡æ ·ç‚¹</p>
                    </div>
                    <div class="step-box" style="text-align: center;">
                        <h4>å¸§ç§»</h4>
                        <p style="font-size: 1.5em; color: #1a5276; font-weight: bold;">10 ms</p>
                        <p>16kHz â†’ 160é‡‡æ ·ç‚¹</p>
                    </div>
                    <div class="step-box" style="text-align: center;">
                        <h4>é‡å ç‡</h4>
                        <p style="font-size: 1.5em; color: #1a5276; font-weight: bold;">60%</p>
                        <p>(400-160)/400</p>
                    </div>
                </div>
                <h3>åˆ†å¸§è¿‡ç¨‹å¯è§†åŒ–</h3>
                <div class="figure">
                    <canvas id="framingCanvas" width="900" height="250"></canvas>
                    <p class="figure-caption">å›¾3ï¼šä¿¡å·åˆ†å¸§ç¤ºæ„ - ç›¸é‚»å¸§æœ‰60%çš„é‡å åŒºåŸŸ</p>
                </div>
                <h3>2.2 ä¸ºä»€ä¹ˆè¦åŠ çª—ï¼Ÿ</h3>
                <p>ç›´æ¥æˆªå–ä¼šäº§ç”Ÿ<strong>é¢‘è°±æ³„æ¼</strong>ã€‚çª—å‡½æ•°ä½¿å¸§è¾¹ç¼˜å¹³æ»‘è¿‡æ¸¡åˆ°é›¶ã€‚</p>
                <div class="formula-box">
                    <p><strong>æ±‰å®çª—ï¼ˆHanning Windowï¼‰ï¼š</strong></p>
                    <p>$$w[n] = 0.5 - 0.5 \cos\left(\frac{2\pi n}{N-1}\right)$$</p>
                </div>
                <div class="figure">
                    <canvas id="windowCanvas" width="900" height="220"></canvas>
                    <div class="legend">
                        <div class="legend-item"><div class="legend-color" style="background: #2b5797;"></div>åŸå§‹å¸§</div>
                        <div class="legend-item"><div class="legend-color" style="background: #e74c3c;"></div>çª—å‡½æ•°</div>
                        <div class="legend-item"><div class="legend-color" style="background: #27ae60;"></div>åŠ çª—å</div>
                    </div>
                    <p class="figure-caption">å›¾4ï¼šæ±‰å®çª—åŠå…¶å¯¹ä¿¡å·å¸§çš„å½±å“</p>
                </div>
            </section>

            <!-- MFCCç‰¹å¾ -->
            <section id="mfcc">
                <h2>ğŸµ ç¬¬ä¸‰æ­¥ï¼šMFCC ç‰¹å¾æå–</h2>
                <p><strong>MFCC</strong>ï¼ˆMel-Frequency Cepstral Coefficientsï¼‰æ¨¡æ‹Ÿäººè€³å¯¹ä¸åŒé¢‘ç‡çš„æ„ŸçŸ¥ç‰¹æ€§ã€‚</p>
                <h3>MFCC æå–æµç¨‹</h3>
                <div class="figure">
                    <canvas id="mfccFlowCanvas" width="900" height="100"></canvas>
                    <p class="figure-caption">å›¾5ï¼šMFCCç‰¹å¾æå–æµç¨‹</p>
                </div>
                <h3>3.1 FFT ä¸åŠŸç‡è°±</h3>
                <div class="formula-box">
                    <p>$$P[k] = \frac{1}{N_{FFT}} |X[k]|^2$$</p>
                </div>
                <h3>3.2 Mel æ»¤æ³¢å™¨ç»„</h3>
                <p>äººè€³å¯¹é¢‘ç‡æ„ŸçŸ¥æ˜¯<strong>éçº¿æ€§</strong>çš„ï¼šä½é¢‘åˆ†è¾¨ç‡é«˜ï¼Œé«˜é¢‘åˆ†è¾¨ç‡ä½ã€‚</p>
                <div class="formula-box">
                    <p><strong>Hz â†’ Mel è½¬æ¢ï¼š</strong></p>
                    <p>$$m = 2595 \cdot \log_{10}\left(1 + \frac{f}{700}\right)$$</p>
                </div>
                <div class="figure">
                    <canvas id="melFilterCanvas" width="900" height="280"></canvas>
                    <p class="figure-caption">å›¾6ï¼šMelä¸‰è§’æ»¤æ³¢å™¨ç»„ - ä½é¢‘åŒºå¯†é›†ï¼Œé«˜é¢‘åŒºç¨€ç–</p>
                </div>
                <h3>3.3 DCT ä¸å€’è°±ç³»æ•°</h3>
                <p>å¯¹Melæ»¤æ³¢å™¨è¾“å‡ºå–å¯¹æ•°åè¿›è¡ŒDCTï¼Œé€šå¸¸å–ç¬¬2-13é˜¶ç³»æ•°ã€‚</p>
                <div class="info-box">
                    <strong>ğŸ“Š æœ€ç»ˆç‰¹å¾ç»´åº¦ï¼š</strong>
                    <p>12ç»´ MFCC + 12ç»´ Î” + 12ç»´ Î”Î” = <strong>36ç»´</strong></p>
                </div>
            </section>

            <!-- DTWç®—æ³• -->
            <section id="dtw">
                <h2>ğŸ”€ ç¬¬å››æ­¥ï¼šDTW åŠ¨æ€æ—¶é—´è§„æ•´</h2>
                <h3>4.1 ä¸ºä»€ä¹ˆéœ€è¦ DTWï¼Ÿ</h3>
                <p>ä¸åŒäººè¯´åŒä¸€ä¸ªè¯ï¼Œ<strong>æ—¶é•¿å¾€å¾€ä¸åŒ</strong>ã€‚DTWé€šè¿‡éçº¿æ€§æ—¶é—´æ‰­æ›²æ‰¾åˆ°æœ€ä½³å¯¹é½ã€‚</p>
                <div class="figure">
                    <canvas id="dtwProblemCanvas" width="900" height="180"></canvas>
                    <p class="figure-caption">å›¾7ï¼šDTWé—®é¢˜ - å¦‚ä½•å¯¹é½é•¿åº¦ä¸åŒçš„åºåˆ—ï¼Ÿ</p>
                </div>
                <h3>4.2 DTW ç®—æ³•æ ¸å¿ƒ</h3>
                <div class="formula-box">
                    <p><strong>å±€éƒ¨è·ç¦»ï¼ˆæ¬§æ°è·ç¦»ï¼‰ï¼š</strong></p>
                    <p>$$d(i,j) = \|template(:,i) - test(:,j)\|_2$$</p>
                    <p style="margin-top: 15px;"><strong>ç´¯ç§¯è·ç¦»é€’æ¨å…¬å¼ï¼š</strong></p>
                    <p>$$D(i,j) = d(i,j) + \min\begin{cases} D(i-1, j) \\ D(i, j-1) \\ D(i-1, j-1) \end{cases}$$</p>
                    <p style="margin-top: 15px;"><strong>è¾¹ç•Œæ¡ä»¶ï¼š</strong>$D(0,0) = 0, \quad D(i,0) = D(0,j) = \infty$</p>
                </div>
                <h3>4.3 DTW åŠ¨æ€è§„åˆ’æ¼”ç¤º</h3>
                <div class="dtw-controls">
                    <button class="dtw-btn dtw-btn-primary" id="dtwStartBtn">â–¶ å¼€å§‹æ¼”ç¤º</button>
                    <button class="dtw-btn dtw-btn-secondary" id="dtwStepBtn">å•æ­¥æ‰§è¡Œ</button>
                    <button class="dtw-btn dtw-btn-secondary" id="dtwResetBtn">é‡ç½®</button>
                    <button class="dtw-btn dtw-btn-secondary" id="dtwPathBtn">æ˜¾ç¤ºè·¯å¾„</button>
                </div>
                <div class="two-column">
                    <div>
                        <div class="figure">
                            <canvas id="dtwMatrixCanvas" width="400" height="360"></canvas>
                        </div>
                    </div>
                    <div>
                        <div class="dtw-status" id="dtwStatus">ç‚¹å‡»"å¼€å§‹æ¼”ç¤º"è§‚çœ‹DTWåŠ¨æ€è§„åˆ’å¡«è¡¨è¿‡ç¨‹ã€‚</div>
                        <div style="margin-top: 12px;">
                            <div class="dtw-status" id="dtwFormula">ç­‰å¾…å¼€å§‹...</div>
                        </div>
                    </div>
                </div>
                <p class="figure-caption">å›¾8ï¼šDTWç´¯ç§¯è·ç¦»çŸ©é˜µçš„åŠ¨æ€è§„åˆ’å¡«å……è¿‡ç¨‹</p>
                <h3>4.4 è¯†åˆ«å†³ç­–</h3>
                <p>å°†æµ‹è¯•è¯­éŸ³ä¸æ‰€æœ‰æ¨¡æ¿è¿›è¡ŒDTWåŒ¹é…ï¼Œé€‰æ‹©<strong>è·ç¦»æœ€å°</strong>çš„æ¨¡æ¿ä½œä¸ºè¯†åˆ«ç»“æœã€‚</p>
                <div class="figure">
                    <canvas id="recognitionCanvas" width="900" height="200"></canvas>
                    <p class="figure-caption">å›¾9ï¼šè¯†åˆ«å†³ç­– - é€‰æ‹©DTWè·ç¦»æœ€å°çš„æ¨¡æ¿</p>
                </div>
            </section>

            <!-- å®éªŒä»»åŠ¡ -->
            <section id="experiments">
                <h2>ğŸ§ª å®éªŒä»»åŠ¡</h2>
                <p>æ ¹æ®ä»£ç æ¨¡æ¿ä¸­çš„æç¤ºï¼Œå¡«å†™æ ‡è®°ä¸º<code>?</code>çš„éƒ¨åˆ†ã€‚</p>
                <h3>ğŸ“ æ–‡ä»¶æ¸…å•</h3>
                <div class="comparison-grid">
                    <div class="comparison-card completed">
                        <h4>ğŸ“„ ex0_all.m</h4>
                        <p>ä¸»ç¨‹åº<span class="tag tag-completed">å·²å®Œæˆ</span></p>
                    </div>
                    <div class="comparison-card required">
                        <h4>ğŸ“„ ex1_preemphasis.m</h4>
                        <p>é¢„åŠ é‡<span class="tag tag-required">éœ€ä¿®æ”¹</span></p>
                    </div>
                    <div class="comparison-card required">
                        <h4>ğŸ“„ ex2_enframe.m</h4>
                        <p>åˆ†å¸§<span class="tag tag-required">éœ€ä¿®æ”¹</span></p>
                    </div>
                    <div class="comparison-card required">
                        <h4>ğŸ“„ ex3_mfcc.m</h4>
                        <p>MFCCæå–<span class="tag tag-required">éœ€ä¿®æ”¹</span></p>
                    </div>
                    <div class="comparison-card required">
                        <h4>ğŸ“„ ex4_dtw.m</h4>
                        <p>DTWè®¡ç®—<span class="tag tag-required">éœ€ä¿®æ”¹</span></p>
                    </div>
                    <div class="comparison-card completed">
                        <h4>ğŸ“„ ex5_recognize.m</h4>
                        <p>è¯†åˆ«å†³ç­–<span class="tag tag-completed">å·²å®Œæˆ</span></p>
                    </div>
                    <div class="comparison-card completed">
                        <h4>ğŸ“„ ex6_vad.m</h4>
                        <p>ç«¯ç‚¹æ£€æµ‹<span class="tag tag-completed">å·²å®Œæˆ</span></p>
                    </div>
                    <div class="comparison-card">
                        <h4>âœ… test_Project4.p</h4>
                        <p>è‡ªåŠ¨æ‰¹æ”¹ç¨‹åº</p>
                    </div>
                </div>
                <h3>ğŸ“ éœ€è¦å¡«å†™çš„æ ¸å¿ƒå…¬å¼</h3>
                <table>
                    <tr><th>æ–‡ä»¶</th><th>åŠŸèƒ½</th><th>éœ€è¦å®ç°çš„å…¬å¼</th></tr>
                    <tr><td><code>ex1</code></td><td>é¢„åŠ é‡</td><td>$y[n] = x[n] - \alpha \cdot x[n-1]$ï¼Œä½¿ç”¨<code>filter([1, -Î±], 1, x)</code></td></tr>
                    <tr><td><code>ex2</code></td><td>å¸§æ•°</td><td>$N = \lfloor(L-L_f)/L_s\rfloor + 1$</td></tr>
                    <tr><td><code>ex2</code></td><td>èµ·å§‹ç´¢å¼•</td><td>$start = (i-1) \times L_s + 1$</td></tr>
                    <tr><td><code>ex3</code></td><td>æ±‰å®çª—</td><td><code>hann(N, 'periodic')</code></td></tr>
                    <tr><td><code>ex3</code></td><td>FFT</td><td><code>fft(frames_win, nfft)</code></td></tr>
                    <tr><td><code>ex3</code></td><td>åŠŸç‡è°±</td><td>$P = |X|^2 / N_{fft}$</td></tr>
                    <tr><td><code>ex3</code></td><td>DCT</td><td><code>dct(log_mel)</code>ï¼Œå–ç¬¬2åˆ°13é˜¶</td></tr>
                    <tr><td><code>ex4</code></td><td>æ¬§æ°è·ç¦»</td><td><code>norm(a - b)</code></td></tr>
                    <tr><td><code>ex4</code></td><td>DTWé€’æ¨</td><td>$D(i,j) = d(i,j) + \min\{...\}$</td></tr>
                </table>
                <h3>ğŸš€ å®éªŒæ­¥éª¤</h3>
                <ol style="padding-left: 20px; line-height: 2;">
                    <li>é˜…è¯»æœ¬æ‰‹å†Œï¼Œç†è§£è¯­éŸ³è¯†åˆ«æµç¨‹</li>
                    <li>æŒ‰é¡ºåºå®Œæˆ <code>ex1</code> â†’ <code>ex2</code> â†’ <code>ex3</code> â†’ <code>ex4</code></li>
                    <li>è¿è¡Œ <code>test_Project4.p</code> æ£€æŸ¥æ­£ç¡®æ€§</li>
                    <li>è¿è¡Œ <code>ex0_all.m</code> æµ‹è¯•å®Œæ•´æµç¨‹</li>
                    <li>è¾“å…¥ <code>9</code> è·å¾—åŠ å¯†æˆç»©ï¼Œå‹ç¼©æäº¤</li>
                </ol>
                <div class="success-box">
                    <strong>ğŸ’¡ è°ƒè¯•å»ºè®®ï¼š</strong>æ¯å®Œæˆä¸€ä¸ªæ¨¡å—å°±è¿è¡Œæµ‹è¯•ï¼Œç¡®ä¿æ­£ç¡®åå†ç»§ç»­ã€‚
                </div>
                <div class="warning-box">
                    <strong>âš ï¸ å­¦æœ¯è¯šä¿¡ï¼š</strong>è¯·ç¡®ä¿ç†è§£æ¯ä¸€è¡Œä»£ç çš„å«ä¹‰ï¼Œç‹¬ç«‹å®Œæˆå®éªŒã€‚
                </div>
            </section>

            <!-- æ€»ç»“ -->
            <section style="background: #f8f9ff;">
                <h2>ğŸ“ æ€»ç»“</h2>
                <div class="success-box">
                    <strong>ğŸŠ å­¦ä¹ æ”¶è·ï¼š</strong>
                    <ul style="margin: 8px 0 0 18px;">
                        <li><strong>é¢„åŠ é‡</strong>ï¼šä¸€é˜¶é«˜é€šæ»¤æ³¢å™¨å¹³å¦åŒ–è¯­éŸ³é¢‘è°±</li>
                        <li><strong>åˆ†å¸§åŠ çª—</strong>ï¼šçŸ­æ—¶åˆ†ææ–¹æ³•å’Œçª—å‡½æ•°ä½œç”¨</li>
                        <li><strong>MFCC</strong>ï¼šæ¨¡æ‹Ÿäººè€³æ„ŸçŸ¥çš„ç‰¹å¾æå–</li>
                        <li><strong>DTW</strong>ï¼šåŠ¨æ€è§„åˆ’è§£å†³æ—¶é—´å¯¹é½é—®é¢˜</li>
                    </ul>
                </div>
            </section>
        </div>

        <!-- Footer -->
        <section style="text-align: center; padding: 30px; background: #f7fafc; border-top: 2px solid #48c9b0;">
            <p style="color: #1a5276; font-weight: 600;">å—äº¬å·¥ä¸šå¤§å­¦æµ¦æ±Ÿå­¦é™¢ | DSPè¯¾ç¨‹å®è·µ</p>
            <p style="color: #999; font-size: 0.85em; margin-top: 10px;">æ•°å­—ä¿¡å·å¤„ç† - DTWå­¤ç«‹è¯è¯­éŸ³è¯†åˆ«</p>
        </section>
    </div>

    <button class="back-to-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">â†‘</button>

    <script>
        const colors = { primary: '#1a5276', secondary: '#2e86ab', accent: '#48c9b0', signal1: '#2b5797', signal2: '#e74c3c', success: '#27ae60', warning: '#f39c12' };

        // å›¾1ï¼šç³»ç»Ÿæµç¨‹
        function drawFlow() {
            const canvas = document.getElementById('flowCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            const steps = [{text:'è¯­éŸ³è¾“å…¥',icon:'ğŸ¤',color:'#3498db'},{text:'VAD',icon:'âœ‚ï¸',color:'#9b59b6'},{text:'é¢„åŠ é‡',icon:'ğŸ“ˆ',color:'#e67e22'},{text:'åˆ†å¸§åŠ çª—',icon:'ğŸ“¦',color:'#27ae60'},{text:'MFCC',icon:'ğŸµ',color:'#e74c3c'},{text:'DTW',icon:'ğŸ”€',color:'#1abc9c'},{text:'è¯†åˆ«ç»“æœ',icon:'âœ…',color:'#2c3e50'}];
            const boxW=95, boxH=55, gap=20, startX=(canvas.width-steps.length*boxW-(steps.length-1)*gap)/2, centerY=canvas.height/2;
            steps.forEach((step,i) => {
                const x = startX + i*(boxW+gap);
                if (i > 0) { ctx.strokeStyle='#bdc3c7'; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(x-gap+5,centerY); ctx.lineTo(x-5,centerY); ctx.stroke(); ctx.fillStyle='#bdc3c7'; ctx.beginPath(); ctx.moveTo(x-5,centerY); ctx.lineTo(x-12,centerY-5); ctx.lineTo(x-12,centerY+5); ctx.fill(); }
                ctx.fillStyle = step.color; ctx.beginPath(); ctx.roundRect(x,centerY-boxH/2,boxW,boxH,8); ctx.fill();
                ctx.fillStyle = 'white'; ctx.font = '18px Arial'; ctx.textAlign = 'center'; ctx.fillText(step.icon, x+boxW/2, centerY-5);
                ctx.font = 'bold 11px Microsoft YaHei'; ctx.fillText(step.text, x+boxW/2, centerY+18);
            });
        }

        // å›¾2ï¼šé¢„åŠ é‡
        function drawPreemphasis() {
            const canvas = document.getElementById('preemphCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            const marginL=60, marginR=50, marginT=40, marginB=50, plotW=canvas.width-marginL-marginR, plotH=(canvas.height-marginT-marginB-30)/2;
            const y1 = marginT + plotH;
            // ç»˜åˆ¶åæ ‡è½´
            ctx.strokeStyle='#666'; ctx.lineWidth=1.5; ctx.beginPath(); ctx.moveTo(marginL,y1); ctx.lineTo(marginL,marginT+10); ctx.moveTo(marginL,y1); ctx.lineTo(marginL+plotW,y1); ctx.stroke();
            ctx.fillStyle='#666'; ctx.font='12px Arial'; ctx.textAlign='center'; ctx.fillText('æ—¶é—´', marginL+plotW/2, y1+20);
            // ç”Ÿæˆä¿¡å·
            const N=200, alpha=0.97, original=[], preemph=[];
            for (let i=0; i<N; i++) { const t=i/N; const val=Math.sin(2*Math.PI*3*t)*0.6+Math.sin(2*Math.PI*10*t)*0.3+Math.sin(2*Math.PI*20*t)*0.1; original.push(val); preemph.push(i===0?val:val-alpha*original[i-1]); }
            // åŸå§‹ä¿¡å·
            ctx.strokeStyle=colors.signal1; ctx.lineWidth=2; ctx.beginPath();
            for (let i=0; i<N; i++) { const x=marginL+(i/N)*plotW, y=y1-(original[i]+1)/2*(plotH-20); if(i===0)ctx.moveTo(x,y); else ctx.lineTo(x,y); }
            ctx.stroke();
            // é¢„åŠ é‡ä¿¡å·
            ctx.strokeStyle=colors.signal2; ctx.beginPath();
            for (let i=0; i<N; i++) { const x=marginL+(i/N)*plotW, y=y1-(preemph[i]/1.5+1)/2*(plotH-20); if(i===0)ctx.moveTo(x,y); else ctx.lineTo(x,y); }
            ctx.stroke();
            // å›¾ä¾‹
            ctx.font='12px Microsoft YaHei'; ctx.fillStyle=colors.signal1; ctx.fillRect(marginL+plotW-150,marginT+5,15,3); ctx.fillText('åŸå§‹',marginL+plotW-130,marginT+12);
            ctx.fillStyle=colors.signal2; ctx.fillRect(marginL+plotW-60,marginT+5,15,3); ctx.fillText('é¢„åŠ é‡',marginL+plotW-40,marginT+12);
            // ä¸‹åŠéƒ¨åˆ†ï¼šé¢‘ç‡å“åº”
            const y2 = canvas.height - marginB;
            ctx.strokeStyle='#666'; ctx.beginPath(); ctx.moveTo(marginL,y2); ctx.lineTo(marginL,y2-plotH+20); ctx.moveTo(marginL,y2); ctx.lineTo(marginL+plotW,y2); ctx.stroke();
            ctx.fillText('é¢‘ç‡', marginL+plotW/2, y2+20);
            ctx.strokeStyle=colors.warning; ctx.lineWidth=2.5; ctx.beginPath();
            for (let i=0; i<=100; i++) { const omega=(i/100)*Math.PI, mag=Math.sqrt(1+alpha*alpha-2*alpha*Math.cos(omega)), db=20*Math.log10(mag); const x=marginL+(i/100)*plotW, y=y2-((db+20)/26)*(plotH-20); if(i===0)ctx.moveTo(x,y); else ctx.lineTo(x,y); }
            ctx.stroke();
            ctx.fillStyle=colors.warning; ctx.font='bold 12px Microsoft YaHei'; ctx.textAlign='right'; ctx.fillText('é«˜é¢‘å¢å¼ºâ†‘', marginL+plotW-10, y2-plotH+40);
        }

        // å›¾3ï¼šåˆ†å¸§
        function drawFraming() {
            const canvas = document.getElementById('framingCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            const marginL=50, plotW=canvas.width-100;
            // ç”Ÿæˆä¿¡å·
            const N=400, signal=[];
            for (let i=0; i<N; i++) { const t=i/N; signal.push(Math.sin(2*Math.PI*8*t)*Math.exp(-3*Math.abs(t-0.5))); }
            // ç»˜åˆ¶ä¿¡å·
            ctx.fillStyle='#333'; ctx.font='bold 13px Microsoft YaHei'; ctx.textAlign='left'; ctx.fillText('åŸå§‹ä¿¡å·', marginL, 25);
            const sigY=55, sigH=60;
            ctx.strokeStyle=colors.signal1; ctx.lineWidth=1.5; ctx.beginPath();
            for (let i=0; i<N; i++) { const x=marginL+(i/N)*plotW, y=sigY+sigH/2-signal[i]*sigH/2*0.8; if(i===0)ctx.moveTo(x,y); else ctx.lineTo(x,y); }
            ctx.stroke();
            // å¸§æ ‡è®°
            const frameLen=100, frameShift=40, frameColors=['#3498db','#2ecc71','#e74c3c','#9b59b6','#f39c12'];
            for (let f=0; f<5; f++) {
                const start=f*frameShift, end=Math.min(start+frameLen,N);
                const x1=marginL+(start/N)*plotW, x2=marginL+(end/N)*plotW;
                ctx.fillStyle=frameColors[f]+'25'; ctx.fillRect(x1,sigY-5,x2-x1,sigH+10);
                ctx.strokeStyle=frameColors[f]; ctx.lineWidth=2; ctx.strokeRect(x1,sigY-5,x2-x1,sigH+10);
                ctx.fillStyle=frameColors[f]; ctx.font='bold 11px Arial'; ctx.textAlign='center'; ctx.fillText('å¸§'+(f+1), (x1+x2)/2, sigY-12);
            }
            // æ ‡æ³¨
            const annotY = sigY + sigH + 40;
            ctx.strokeStyle='#333'; ctx.lineWidth=1.5;
            ctx.beginPath(); ctx.moveTo(marginL,annotY); ctx.lineTo(marginL+(frameShift/N)*plotW,annotY); ctx.stroke();
            ctx.beginPath(); ctx.moveTo(marginL,annotY-5); ctx.lineTo(marginL,annotY+5); ctx.stroke();
            ctx.beginPath(); ctx.moveTo(marginL+(frameShift/N)*plotW,annotY-5); ctx.lineTo(marginL+(frameShift/N)*plotW,annotY+5); ctx.stroke();
            ctx.fillStyle='#333'; ctx.font='12px Microsoft YaHei'; ctx.textAlign='center'; ctx.fillText('å¸§ç§»', marginL+(frameShift/N)*plotW/2, annotY+18);
            ctx.fillStyle=colors.primary; ctx.font='12px Microsoft YaHei'; ctx.textAlign='right';
            ctx.fillText('å¸§é•¿=25ms, å¸§ç§»=10ms, é‡å =60%', canvas.width-50, annotY+5);
        }

        // å›¾4ï¼šçª—å‡½æ•°
        function drawWindow() {
            const canvas = document.getElementById('windowCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            const marginL=60, plotW=(canvas.width-180)/2, plotH=150, marginT=35;
            // å·¦å›¾ï¼šçª—å‡½æ•°
            ctx.fillStyle='#333'; ctx.font='bold 13px Microsoft YaHei'; ctx.textAlign='center'; ctx.fillText('æ±‰å®çª—', marginL+plotW/2, 20);
            ctx.strokeStyle='#666'; ctx.lineWidth=1.5; ctx.beginPath(); ctx.moveTo(marginL,marginT+plotH); ctx.lineTo(marginL,marginT+10); ctx.moveTo(marginL,marginT+plotH); ctx.lineTo(marginL+plotW,marginT+plotH); ctx.stroke();
            const N=100;
            ctx.strokeStyle=colors.signal2; ctx.lineWidth=2.5; ctx.beginPath();
            for (let i=0; i<N; i++) { const win=0.5-0.5*Math.cos(2*Math.PI*i/(N-1)); const x=marginL+(i/N)*plotW, y=marginT+plotH-win*(plotH-10); if(i===0)ctx.moveTo(x,y); else ctx.lineTo(x,y); }
            ctx.stroke();
            // å³å›¾ï¼šåŠ çª—æ•ˆæœ
            const x2 = marginL + plotW + 80;
            ctx.fillStyle='#333'; ctx.fillText('åŠ çª—æ•ˆæœ', x2+plotW/2, 20);
            ctx.strokeStyle='#666'; ctx.beginPath(); ctx.moveTo(x2,marginT+plotH); ctx.lineTo(x2,marginT+10); ctx.moveTo(x2,marginT+plotH); ctx.lineTo(x2+plotW,marginT+plotH); ctx.stroke();
            // åŸå§‹å¸§
            ctx.strokeStyle=colors.signal1; ctx.lineWidth=1.5; ctx.setLineDash([5,5]); ctx.beginPath();
            for (let i=0; i<N; i++) { const t=i/N, val=Math.sin(2*Math.PI*4*t)*0.8; const x=x2+t*plotW, y=marginT+plotH-(val+1)/2*(plotH-10); if(i===0)ctx.moveTo(x,y); else ctx.lineTo(x,y); }
            ctx.stroke(); ctx.setLineDash([]);
            // åŠ çª—å
            ctx.strokeStyle=colors.success; ctx.lineWidth=2.5; ctx.beginPath();
            for (let i=0; i<N; i++) { const t=i/N, win=0.5-0.5*Math.cos(2*Math.PI*i/(N-1)), val=Math.sin(2*Math.PI*4*t)*0.8*win; const x=x2+t*plotW, y=marginT+plotH-(val+1)/2*(plotH-10); if(i===0)ctx.moveTo(x,y); else ctx.lineTo(x,y); }
            ctx.stroke();
        }

        // å›¾5ï¼šMFCCæµç¨‹
        function drawMFCCFlow() {
            const canvas = document.getElementById('mfccFlowCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            const steps = ['FFT', 'åŠŸç‡è°±', 'Melæ»¤æ³¢', 'log', 'DCT', 'MFCC'];
            const boxW=100, boxH=40, gap=30, startX=(canvas.width-steps.length*boxW-(steps.length-1)*gap)/2, centerY=canvas.height/2;
            steps.forEach((step,i) => {
                const x = startX + i*(boxW+gap);
                if (i > 0) { ctx.strokeStyle='#bdc3c7'; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(x-gap+5,centerY); ctx.lineTo(x-5,centerY); ctx.stroke(); ctx.fillStyle='#bdc3c7'; ctx.beginPath(); ctx.moveTo(x-5,centerY); ctx.lineTo(x-11,centerY-4); ctx.lineTo(x-11,centerY+4); ctx.fill(); }
                ctx.strokeStyle=colors.secondary; ctx.lineWidth=2; ctx.beginPath(); ctx.roundRect(x,centerY-boxH/2,boxW,boxH,6); ctx.stroke();
                ctx.fillStyle=colors.primary; ctx.font='bold 13px Microsoft YaHei'; ctx.textAlign='center'; ctx.fillText(step, x+boxW/2, centerY+5);
            });
        }

        // å›¾6ï¼šMelæ»¤æ³¢å™¨ç»„
        function drawMelFilter() {
            const canvas = document.getElementById('melFilterCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            const marginL=70, marginR=50, marginT=40, marginB=60, plotW=canvas.width-marginL-marginR, plotH=canvas.height-marginT-marginB;
            ctx.strokeStyle='#666'; ctx.lineWidth=1.5; ctx.beginPath(); ctx.moveTo(marginL,canvas.height-marginB); ctx.lineTo(marginL,marginT); ctx.moveTo(marginL,canvas.height-marginB); ctx.lineTo(marginL+plotW,canvas.height-marginB); ctx.stroke();
            ctx.fillStyle='#666'; ctx.font='12px Arial'; ctx.textAlign='center'; ctx.fillText('é¢‘ç‡ (Hz)', marginL+plotW/2, canvas.height-marginB+25);
            // åˆ»åº¦
            [0,1000,2000,3000,4000,5000,6000,7000,8000].forEach(f => { const x=marginL+(f/8000)*plotW; ctx.fillText(f>=1000?(f/1000)+'k':f, x, canvas.height-marginB+18); });
            // Melæ»¤æ³¢å™¨
            const numFilters=24, maxFreq=8000;
            const hz2mel = f => 2595*Math.log10(1+f/700), mel2hz = m => 700*(Math.pow(10,m/2595)-1);
            const lowMel=hz2mel(0), highMel=hz2mel(maxFreq), melPoints=[];
            for (let i=0; i<=numFilters+1; i++) melPoints.push(mel2hz(lowMel+i*(highMel-lowMel)/(numFilters+1)));
            for (let m=0; m<numFilters; m++) {
                const hue=200-(m/numFilters)*150, color=`hsl(${hue},65%,50%)`;
                const fLow=melPoints[m], fCenter=melPoints[m+1], fHigh=melPoints[m+2];
                const xLow=marginL+(fLow/maxFreq)*plotW, xCenter=marginL+(fCenter/maxFreq)*plotW, xHigh=marginL+(fHigh/maxFreq)*plotW;
                const yTop=marginT+10, yBottom=canvas.height-marginB;
                ctx.fillStyle=color+'40'; ctx.beginPath(); ctx.moveTo(xLow,yBottom); ctx.lineTo(xCenter,yTop); ctx.lineTo(xHigh,yBottom); ctx.closePath(); ctx.fill();
                ctx.strokeStyle=color; ctx.lineWidth=1.5; ctx.beginPath(); ctx.moveTo(xLow,yBottom); ctx.lineTo(xCenter,yTop); ctx.lineTo(xHigh,yBottom); ctx.stroke();
            }
            ctx.fillStyle=colors.primary; ctx.font='bold 12px Microsoft YaHei'; ctx.textAlign='left'; ctx.fillText('ä½é¢‘åŒºï¼šåˆ†è¾¨ç‡é«˜', marginL+10, marginT+15);
            ctx.textAlign='right'; ctx.fillText('é«˜é¢‘åŒºï¼šåˆ†è¾¨ç‡ä½', marginL+plotW-10, marginT+15);
        }

        // å›¾7ï¼šDTWé—®é¢˜
        function drawDTWProblem() {
            const canvas = document.getElementById('dtwProblemCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            const marginL=60, seqW=280, y1=90;
            const n=8, m=12, template=[], test=[];
            for (let i=0; i<n; i++) template.push(Math.sin(i*0.8)*20);
            for (let j=0; j<m; j++) test.push(Math.sin(j*0.55)*20);
            // æ¨¡æ¿
            ctx.fillStyle=colors.signal1; ctx.font='bold 13px Microsoft YaHei'; ctx.textAlign='left'; ctx.fillText('æ¨¡æ¿ (n='+n+'å¸§)', marginL, 30);
            ctx.strokeStyle=colors.signal1; ctx.lineWidth=2; ctx.beginPath();
            for (let i=0; i<n; i++) { const x=marginL+(i/(n-1))*seqW, y=y1+template[i]; if(i===0)ctx.moveTo(x,y); else ctx.lineTo(x,y); }
            ctx.stroke();
            for (let i=0; i<n; i++) { const x=marginL+(i/(n-1))*seqW, y=y1+template[i]; ctx.beginPath(); ctx.arc(x,y,5,0,Math.PI*2); ctx.fill(); }
            // é—®å·
            const midX = marginL + seqW + 80;
            ctx.fillStyle=colors.warning; ctx.font='bold 40px Arial'; ctx.textAlign='center'; ctx.fillText('?', midX, y1+10);
            ctx.font='12px Microsoft YaHei'; ctx.fillText('å¦‚ä½•å¯¹é½?', midX, y1+35);
            // æµ‹è¯•
            const x2Start = midX + 80;
            ctx.fillStyle=colors.signal2; ctx.font='bold 13px Microsoft YaHei'; ctx.textAlign='left'; ctx.fillText('æµ‹è¯• (m='+m+'å¸§)', x2Start, 30);
            ctx.strokeStyle=colors.signal2; ctx.lineWidth=2; ctx.beginPath();
            for (let j=0; j<m; j++) { const x=x2Start+(j/(m-1))*seqW, y=y1+test[j]; if(j===0)ctx.moveTo(x,y); else ctx.lineTo(x,y); }
            ctx.stroke();
            for (let j=0; j<m; j++) { const x=x2Start+(j/(m-1))*seqW, y=y1+test[j]; ctx.beginPath(); ctx.arc(x,y,5,0,Math.PI*2); ctx.fill(); }
            // è¯´æ˜
            ctx.fillStyle='#f7fafc'; ctx.fillRect(marginL,canvas.height-45,canvas.width-marginL-60,35);
            ctx.strokeStyle=colors.accent; ctx.lineWidth=2; ctx.strokeRect(marginL,canvas.height-45,canvas.width-marginL-60,35);
            ctx.fillStyle='#333'; ctx.font='13px Microsoft YaHei'; ctx.textAlign='center'; ctx.fillText('åŒä¸€ä¸ªè¯ï¼Œä¸åŒäººæˆ–ä¸åŒæ¬¡è¯´ï¼Œæ—¶é•¿å¯èƒ½ä¸åŒã€‚DTWé€šè¿‡éçº¿æ€§æ—¶é—´æ‰­æ›²æ‰¾åˆ°æœ€ä½³å¯¹é½ã€‚', canvas.width/2, canvas.height-22);
        }

        // DTWåŠ¨ç”»
        const dtw = { n:6, m:8, template:[], test:[], localDist:[], D:[], currentI:1, currentJ:1, running:false, timer:null, completed:false };
        function initDTW() {
            dtw.template=[]; dtw.test=[];
            for (let i=0; i<dtw.n; i++) dtw.template.push(Math.sin(i*0.7)*2+i*0.3);
            for (let j=0; j<dtw.m; j++) dtw.test.push(Math.sin(j*0.5)*2+j*0.25);
            dtw.localDist=[];
            for (let i=0; i<dtw.n; i++) { dtw.localDist[i]=[]; for (let j=0; j<dtw.m; j++) dtw.localDist[i][j]=Math.abs(dtw.template[i]-dtw.test[j]); }
            dtw.D=[];
            for (let i=0; i<=dtw.n; i++) { dtw.D[i]=[]; for (let j=0; j<=dtw.m; j++) dtw.D[i][j]=Infinity; }
            dtw.D[0][0]=0; dtw.currentI=1; dtw.currentJ=1; dtw.completed=false;
        }
        function drawDTWMatrix() {
            const canvas = document.getElementById('dtwMatrixCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            const margin=50, cellW=(canvas.width-2*margin)/dtw.m, cellH=(canvas.height-2*margin-30)/dtw.n;
            ctx.fillStyle=colors.primary; ctx.font='bold 14px Microsoft YaHei'; ctx.textAlign='center'; ctx.fillText('ç´¯ç§¯è·ç¦»çŸ©é˜µ D(i,j)', canvas.width/2, 20);
            ctx.fillStyle='#666'; ctx.font='11px Consolas';
            for (let j=0; j<dtw.m; j++) ctx.fillText(j+1, margin+j*cellW+cellW/2, margin-8);
            ctx.textAlign='right';
            for (let i=0; i<dtw.n; i++) ctx.fillText(i+1, margin-8, margin+(dtw.n-1-i)*cellH+cellH/2+4);
            for (let i=0; i<dtw.n; i++) {
                for (let j=0; j<dtw.m; j++) {
                    const x=margin+j*cellW, y=margin+(dtw.n-1-i)*cellH, dVal=dtw.D[i+1][j+1];
                    if (dVal<Infinity) { const ratio=Math.min(dVal/12,1), hue=200-ratio*80, light=85-ratio*30; ctx.fillStyle=`hsl(${hue},50%,${light}%)`; }
                    else if (i+1===dtw.currentI && j+1===dtw.currentJ && !dtw.completed) ctx.fillStyle='#fff3cd';
                    else ctx.fillStyle='#f8f9fa';
                    ctx.fillRect(x+1,y+1,cellW-2,cellH-2);
                    ctx.strokeStyle='#dee2e6'; ctx.lineWidth=1; ctx.strokeRect(x+1,y+1,cellW-2,cellH-2);
                    if (dVal<Infinity) { ctx.fillStyle=dVal>8?'#fff':'#333'; ctx.font='10px Consolas'; ctx.textAlign='center'; ctx.fillText(dVal.toFixed(1), x+cellW/2, y+cellH/2+4); }
                }
            }
            if (!dtw.completed && dtw.currentI<=dtw.n && dtw.currentJ<=dtw.m) {
                const x=margin+(dtw.currentJ-1)*cellW, y=margin+(dtw.n-dtw.currentI)*cellH;
                ctx.strokeStyle=colors.warning; ctx.lineWidth=3; ctx.strokeRect(x,y,cellW,cellH);
            }
        }
        function stepDTW() {
            if (dtw.currentI>dtw.n) { dtw.completed=true; return false; }
            const i=dtw.currentI, j=dtw.currentJ, cost=dtw.localDist[i-1][j-1];
            const d1=dtw.D[i-1][j], d2=dtw.D[i][j-1], d3=dtw.D[i-1][j-1], minD=Math.min(d1,d2,d3);
            dtw.D[i][j]=cost+minD;
            document.getElementById('dtwStatus').innerHTML='<strong>ä½ç½®:</strong> D('+i+','+j+') <strong>å±€éƒ¨è·ç¦»:</strong> '+cost.toFixed(2);
            let fromDir=''; if(minD===d3)fromDir='å¯¹è§’'; else if(minD===d1)fromDir='ä¸Šæ–¹'; else fromDir='å·¦æ–¹';
            document.getElementById('dtwFormula').innerHTML='D('+i+','+j+') = '+cost.toFixed(2)+' + '+minD.toFixed(2)+' = <strong style="color:'+colors.primary+'">'+dtw.D[i][j].toFixed(2)+'</strong> (æ¥è‡ª'+fromDir+')';
            dtw.currentJ++; if (dtw.currentJ>dtw.m) { dtw.currentJ=1; dtw.currentI++; }
            drawDTWMatrix(); return dtw.currentI<=dtw.n;
        }
        function startDTW() {
            if (dtw.running) { clearInterval(dtw.timer); dtw.running=false; document.getElementById('dtwStartBtn').textContent='â–¶ ç»§ç»­'; return; }
            dtw.running=true; document.getElementById('dtwStartBtn').textContent='â¸ æš‚åœ';
            dtw.timer = setInterval(() => { if (!stepDTW()) { clearInterval(dtw.timer); dtw.running=false; dtw.completed=true; document.getElementById('dtwStartBtn').textContent='âœ“ å®Œæˆ'; document.getElementById('dtwStatus').innerHTML='<strong style="color:'+colors.success+'">âœ“ è®¡ç®—å®Œæˆï¼</strong> DTWè·ç¦» = '+dtw.D[dtw.n][dtw.m].toFixed(2); } }, 200);
        }
        function resetDTW() { if(dtw.timer)clearInterval(dtw.timer); dtw.running=false; document.getElementById('dtwStartBtn').textContent='â–¶ å¼€å§‹æ¼”ç¤º'; initDTW(); drawDTWMatrix(); document.getElementById('dtwStatus').innerHTML='ç‚¹å‡»"å¼€å§‹æ¼”ç¤º"è§‚çœ‹DTWåŠ¨æ€è§„åˆ’å¡«è¡¨è¿‡ç¨‹ã€‚'; document.getElementById('dtwFormula').innerHTML='ç­‰å¾…å¼€å§‹...'; }
        function showPath() {
            while(dtw.currentI<=dtw.n) { const i=dtw.currentI,j=dtw.currentJ,cost=dtw.localDist[i-1][j-1]; dtw.D[i][j]=cost+Math.min(dtw.D[i-1][j],dtw.D[i][j-1],dtw.D[i-1][j-1]); dtw.currentJ++; if(dtw.currentJ>dtw.m){dtw.currentJ=1;dtw.currentI++;} }
            dtw.completed=true; drawDTWMatrix();
            const canvas=document.getElementById('dtwMatrixCanvas'), ctx=canvas.getContext('2d'), margin=50, cellW=(canvas.width-2*margin)/dtw.m, cellH=(canvas.height-2*margin-30)/dtw.n;
            const path=[]; let i=dtw.n, j=dtw.m;
            while(i>0&&j>0) { path.push([i,j]); if(i===1&&j===1)break; const d1=i>1?dtw.D[i-1][j]:Infinity, d2=j>1?dtw.D[i][j-1]:Infinity, d3=(i>1&&j>1)?dtw.D[i-1][j-1]:Infinity, minD=Math.min(d1,d2,d3); if(minD===d3){i--;j--;} else if(minD===d1){i--;} else{j--;} }
            path.reverse();
            ctx.strokeStyle='#e74c3c'; ctx.lineWidth=3; ctx.lineCap='round'; ctx.beginPath();
            path.forEach((p,idx) => { const x=margin+(p[1]-0.5)*cellW, y=margin+(dtw.n-p[0]+0.5)*cellH; if(idx===0)ctx.moveTo(x,y); else ctx.lineTo(x,y); });
            ctx.stroke();
            ctx.fillStyle='#e74c3c'; path.forEach(p => { const x=margin+(p[1]-0.5)*cellW, y=margin+(dtw.n-p[0]+0.5)*cellH; ctx.beginPath(); ctx.arc(x,y,4,0,Math.PI*2); ctx.fill(); });
            document.getElementById('dtwStatus').innerHTML='<strong style="color:'+colors.success+'">âœ“ æœ€ä¼˜è·¯å¾„</strong> DTWè·ç¦»='+dtw.D[dtw.n][dtw.m].toFixed(2)+' è·¯å¾„é•¿åº¦='+path.length;
        }

        // å›¾9ï¼šè¯†åˆ«å†³ç­–
        function drawRecognition() {
            const canvas = document.getElementById('recognitionCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            const marginL=60, barW=55, gap=18, startX=marginL+50, barMaxH=100, baseY=canvas.height-45;
            const distances=[45,38,52,41,35,48,55,12,43,50], minIdx=7, maxDist=Math.max(...distances);
            ctx.fillStyle=colors.primary; ctx.font='bold 14px Microsoft YaHei'; ctx.textAlign='left'; ctx.fillText('æµ‹è¯•è¯­éŸ³ï¼š"ä¸ƒ" ä¸å„æ¨¡æ¿çš„DTWè·ç¦»', marginL, 25);
            for (let i=0; i<10; i++) {
                const x=startX+i*(barW+gap), barH=(distances[i]/maxDist)*barMaxH;
                ctx.fillStyle=i===minIdx?colors.success:'#a0aec0'; ctx.fillRect(x,baseY-barH,barW,barH);
                ctx.fillStyle='#333'; ctx.font='11px Consolas'; ctx.textAlign='center'; ctx.fillText(distances[i].toFixed(1), x+barW/2, baseY-barH-8);
                ctx.font='bold 14px Arial'; ctx.fillText(i, x+barW/2, baseY+18);
            }
            ctx.strokeStyle='#666'; ctx.lineWidth=1.5; ctx.beginPath(); ctx.moveTo(marginL+30,baseY); ctx.lineTo(marginL+30,baseY-barMaxH-20); ctx.stroke();
            ctx.fillStyle='#f0fff4'; ctx.fillRect(canvas.width-180,15,160,45);
            ctx.strokeStyle=colors.success; ctx.lineWidth=2; ctx.strokeRect(canvas.width-180,15,160,45);
            ctx.fillStyle=colors.success; ctx.font='bold 13px Microsoft YaHei'; ctx.textAlign='center'; ctx.fillText('è¯†åˆ«ç»“æœï¼š7', canvas.width-100, 33);
            ctx.font='11px Microsoft YaHei'; ctx.fillText('æœ€å°è·ç¦» = 12.0', canvas.width-100, 50);
        }

        // åˆå§‹åŒ–
        window.addEventListener('load', function() {
            drawFlow(); drawPreemphasis(); drawFraming(); drawWindow(); drawMFCCFlow(); drawMelFilter(); drawDTWProblem(); drawRecognition();
            initDTW(); drawDTWMatrix();
            document.getElementById('dtwStartBtn').addEventListener('click', startDTW);
            document.getElementById('dtwStepBtn').addEventListener('click', function() { if(!dtw.completed)stepDTW(); });
            document.getElementById('dtwResetBtn').addEventListener('click', resetDTW);
            document.getElementById('dtwPathBtn').addEventListener('click', showPath);
        });

        // è¿”å›é¡¶éƒ¨
        window.addEventListener('scroll', function() {
            const btn = document.querySelector('.back-to-top');
            btn.classList.toggle('visible', window.scrollY > 300);
        });
    </script>
</body>
</html>
