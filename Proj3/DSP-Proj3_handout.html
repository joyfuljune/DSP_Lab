<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äººå£°å˜è°ƒå®éªŒ - åŸºäºç›¸ä½å£°ç å™¨çš„éŸ³é¢‘å˜è°ƒ</title>
    
    <!-- MathJax for mathematical formulas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$','$'], ['\\(','\\)']],
                displayMath: [['$$','$$'], ['\\[','\\]']],
                processEscapes: true
            },
            CommonHTML: { scale: 110 },
            "HTML-CSS": { scale: 110 }
        });
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'SimSun', Arial, sans-serif;
            line-height: 1.8;
            color: #2c3e50;
            background: linear-gradient(135deg, #e74c3c 0%, #8e44ad 100%);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.25);
            overflow: hidden;
            position: relative;
        }

        /* ç«–ç›´è¿›åº¦æ¡ */
        .vertical-progress {
            position: fixed;
            right: 40px;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 400px;
            background: #e0e0e0;
            border-radius: 2px;
            z-index: 1000;
        }

        .vertical-progress::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: var(--progress, 0%);
            background: linear-gradient(180deg, #e74c3c, #8e44ad);
            border-radius: 2px;
            transition: height 0.3s ease;
        }

        .progress-markers {
            position: absolute;
            left: -30px;
            top: 0;
            width: 80px;
            height: 100%;
        }

        .progress-marker {
            position: absolute;
            left: 0;
            width: 100%;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .progress-marker::before {
            content: '';
            width: 12px;
            height: 12px;
            background: #e0e0e0;
            border: 2px solid #fff;
            border-radius: 50%;
            position: absolute;
            left: 34px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: all 0.3s;
            z-index: 2;
        }

        .progress-marker.active::before {
            background: #e74c3c;
            width: 16px;
            height: 16px;
            left: 32px;
        }

        .progress-marker-label {
            position: absolute;
            right: 55px;
            background: white;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            white-space: nowrap;
            opacity: 0;
            transform: translateX(10px);
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 1px solid #e0e0e0;
            pointer-events: none;
        }

        .progress-marker:hover .progress-marker-label,
        .progress-marker.active .progress-marker-label {
            opacity: 1;
            transform: translateX(0);
        }

        .progress-marker.active .progress-marker-label {
            background: #e74c3c;
            color: white;
            border-color: #e74c3c;
        }

        header {
            background: linear-gradient(135deg, #e74c3c 0%, #8e44ad 100%);
            color: white;
            padding: 40px 40px;
            text-align: center;
            border-bottom: 5px solid #c0392b;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            font-weight: bold;
        }

        header .subtitle {
            font-size: 1.1em;
            opacity: 0.95;
            margin-top: 8px;
        }

        header .institution {
            font-size: 0.95em;
            margin-top: 12px;
            opacity: 0.9;
            border-top: 2px solid rgba(255,255,255,0.3);
            padding-top: 12px;
        }

        nav {
            background: #f5f7fa;
            padding: 15px 40px;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            justify-content: center;
            border-bottom: 3px solid #c0392b;
        }

        nav a {
            color: #c0392b;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s;
            font-size: 0.9em;
            font-weight: 500;
            background: white;
            border: 2px solid #e74c3c;
        }

        nav a:hover {
            background: #e74c3c;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(231, 76, 60, 0.4);
        }

        .content {
            padding: 0;
            max-width: 1200px;
            margin: 0 auto;
        }

        section {
            margin-bottom: 0;
            padding: 40px;
            animation: fadeIn 0.6s ease-in;
        }

        #review { background: #f8f9ff; }
        #intro { background: #fff; }
        #voice { background: #fff5f5; }
        #formant { background: #f0fff4; }
        #method1 { background: #fffaf0; }
        #method2 { background: #f5f7ff; }
        #correction { background: #fafafa; }
        #summary { background: #f8f9ff; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h2 {
            color: #c0392b;
            font-size: 1.9em;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 4px solid #e74c3c;
            font-weight: bold;
        }

        h3 {
            color: #e74c3c;
            font-size: 1.5em;
            margin: 25px 0 15px 0;
            font-weight: bold;
        }

        h4 {
            color: #c0392b;
            font-size: 1.2em;
            margin: 20px 0 12px 0;
            font-weight: 600;
        }

        p {
            margin-bottom: 12px;
            text-align: justify;
            line-height: 1.8;
        }

        code {
            background-color: #fce4ec;
            color: #c0392b;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
        }

        .info-box {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-left: 5px solid #e74c3c;
            padding: 18px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 3px 12px rgba(0,0,0,0.08);
        }

        .info-box strong {
            color: #c0392b;
            font-size: 1.05em;
        }

        .warning-box {
            background: linear-gradient(135deg, #fff5f5 0%, #fed7d7 100%);
            border-left: 5px solid #f56565;
            padding: 18px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 3px 12px rgba(0,0,0,0.08);
        }

        .warning-box strong {
            color: #c53030;
            font-size: 1.05em;
        }

        .success-box {
            background: linear-gradient(135deg, #f0fff4 0%, #c6f6d5 100%);
            border-left: 5px solid #48bb78;
            padding: 18px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 3px 12px rgba(0,0,0,0.08);
        }

        .tip-box {
            background: linear-gradient(135deg, #fffaf0 0%, #feebc8 100%);
            border-left: 5px solid #ed8936;
            padding: 18px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 3px 12px rgba(0,0,0,0.08);
        }

        .formula-box {
            background: linear-gradient(135deg, #f7fafc 0%, #ffffff 100%);
            border-left: 5px solid #e74c3c;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border: 2px solid #e74c3c;
            overflow-x: auto;
            box-shadow: 0 3px 12px rgba(0,0,0,0.08);
        }

        .figure {
            margin: 25px 0;
            text-align: center;
        }

        .figure-caption {
            margin-top: 10px;
            font-style: italic;
            color: #666;
            font-size: 0.95em;
        }

        canvas {
            display: block;
            margin: 0 auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .three-column {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .two-column, .three-column {
                grid-template-columns: 1fr;
            }
            section {
                padding: 25px 15px;
            }
            .vertical-progress {
                display: none;
            }
        }

        .step-box {
            background: white;
            padding: 18px;
            border-radius: 8px;
            border: 2px solid #e2e8f0;
            transition: all 0.3s;
        }

        .step-box:hover {
            border-color: #e74c3c;
            box-shadow: 0 4px 16px rgba(231, 76, 60, 0.2);
            transform: translateY(-2px);
        }

        .step-box h4 {
            margin-top: 0;
            margin-bottom: 8px;
        }

        ul, ol {
            margin: 15px 0 15px 30px;
        }

        li {
            margin: 8px 0;
            line-height: 1.7;
        }

        .highlight {
            background: linear-gradient(120deg, #fef5e7 0%, #ffeaa7 100%);
            padding: 2px 5px;
            border-radius: 3px;
            font-weight: 500;
        }

        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #e74c3c, #8e44ad);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            opacity: 0;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            font-size: 1.5em;
            z-index: 999;
        }

        .back-to-top.visible {
            opacity: 1;
        }

        .back-to-top:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.5);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 18px 0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 3px 12px rgba(0,0,0,0.08);
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        th {
            background: linear-gradient(135deg, #e74c3c, #8e44ad);
            color: white;
            font-weight: bold;
        }

        tr:hover {
            background: #f7fafc;
        }

        .comparison-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            text-align: center;
            transition: all 0.3s;
        }

        .comparison-card:hover {
            border-color: #e74c3c;
            box-shadow: 0 4px 16px rgba(231, 76, 60, 0.2);
            transform: translateY(-3px);
        }

        .comparison-card h4 {
            margin: 0 0 10px 0;
            color: #c0392b;
        }

        .flow-step {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px 15px;
            background: white;
            border-radius: 10px;
            transition: all 0.3s;
            margin: 8px 0;
            border: 2px solid #e2e8f0;
        }

        .flow-step:hover {
            transform: translateX(8px);
            box-shadow: 0 3px 12px rgba(231, 76, 60, 0.2);
            border-color: #e74c3c;
        }

        .flow-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #e74c3c, #8e44ad);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
            flex-shrink: 0;
            box-shadow: 0 3px 10px rgba(231, 76, 60, 0.3);
        }

        .flow-content {
            flex: 1;
        }

        .flow-content h4 {
            margin: 0 0 5px 0;
            color: #c0392b;
            font-size: 1em;
        }

        .flow-content p {
            margin: 0;
            font-size: 0.9em;
            color: #666;
        }

        .flow-arrow {
            text-align: center;
            color: #e74c3c;
            font-size: 1.5em;
            margin: 5px 0;
        }

        footer {
            background: linear-gradient(135deg, #e74c3c 0%, #8e44ad 100%);
            color: white;
            padding: 25px 40px;
            text-align: center;
        }

        footer p {
            margin: 5px 0;
            color: white;
        }
    </style>
</head>
<body>
    <!-- ç«–ç›´è¿›åº¦æ¡ -->
    <div class="vertical-progress">
        <div class="progress-markers">
            <div class="progress-marker active" style="top: 0%" onclick="scrollToSection('review')">
                <span class="progress-marker-label">ç†è®ºå›é¡¾</span>
            </div>
            <div class="progress-marker" style="top: 14%" onclick="scrollToSection('intro')">
                <span class="progress-marker-label">å®éªŒç®€ä»‹</span>
            </div>
            <div class="progress-marker" style="top: 28%" onclick="scrollToSection('voice')">
                <span class="progress-marker-label">å‘å£°åŸç†</span>
            </div>
            <div class="progress-marker" style="top: 42%" onclick="scrollToSection('formant')">
                <span class="progress-marker-label">å…±æŒ¯å³°</span>
            </div>
            <div class="progress-marker" style="top: 56%" onclick="scrollToSection('method1')">
                <span class="progress-marker-label">æ–¹æ³•ä¸€</span>
            </div>
            <div class="progress-marker" style="top: 70%" onclick="scrollToSection('method2')">
                <span class="progress-marker-label">æ–¹æ³•äºŒ</span>
            </div>
            <div class="progress-marker" style="top: 84%" onclick="scrollToSection('correction')">
                <span class="progress-marker-label">é¢‘è°±ä¿®æ­£</span>
            </div>
            <div class="progress-marker" style="top: 98%" onclick="scrollToSection('summary')">
                <span class="progress-marker-label">æ€»ç»“</span>
            </div>
        </div>
    </div>

    <button class="back-to-top" onclick="window.scrollTo({top:0,behavior:'smooth'})">â†‘</button>

    <div class="container">
        <header>
            <h1>ğŸµ äººå£°å˜è°ƒå®éªŒ</h1>
            <p class="subtitle">Pitch Shifting Based on Phase Vocoder</p>
            <p class="institution">å—äº¬å·¥ä¸šå¤§å­¦æµ¦æ±Ÿå­¦é™¢ | è®¡ç®—æœºä¸é€šä¿¡å·¥ç¨‹ä¸“ä¸š | é€šä¿¡å·¥ç¨‹ | DSPè¯¾ç¨‹å®è·µ</p>
        </header>

        <nav>
            <a href="#review">ğŸ“š ç†è®ºå›é¡¾</a>
            <a href="#intro">ğŸ¯ å®éªŒç®€ä»‹</a>
            <a href="#voice">ğŸ—£ï¸ å‘å£°åŸç†</a>
            <a href="#formant">ğŸ“Š å…±æŒ¯å³°</a>
            <a href="#method1">âš™ï¸ æ–¹æ³•ä¸€</a>
            <a href="#method2">ğŸ”§ æ–¹æ³•äºŒ</a>
            <a href="#correction">ğŸ”¬ é¢‘è°±ä¿®æ­£</a>
            <a href="#summary">ğŸ“ æ€»ç»“</a>
        </nav>

        <div class="content">
            <!-- Section 1: ç†è®ºå›é¡¾ -->
            <section id="review">
                <h2>ğŸ“š ä¸€ã€DSPç†è®ºå›é¡¾</h2>
                
                <p>åœ¨ä¸Šä¸€æ¬¡å®éªŒä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•å°†éŸ³é¢‘è¿›è¡Œ<strong>å˜é€Ÿæ’­æ”¾</strong>çš„ç®—æ³• Phase Vocoderã€‚æœ¬æ¬¡å®éªŒæ˜¯åœ¨å…¶åŸºç¡€ä¸Šï¼Œä»‹ç»å°†éŸ³é¢‘<strong>å˜è°ƒ</strong>çš„å®ç°æ–¹æ³•ã€‚æ­¤å¤–æˆ‘ä»¬ä¼šç®€è¦ä»‹ç»å…³äºå…±æŒ¯å³°çš„æ¦‚å¿µï¼Œè®©éŸ³é¢‘å˜è°ƒä½†ä¸å˜éŸ³è‰²ã€‚</p>

                <h3>1.1 å‚…é‡Œå¶å˜æ¢å›é¡¾</h3>
                
                <div class="formula-box">
                    <p><strong>è¿ç»­å‚…é‡Œå¶å˜æ¢ï¼š</strong></p>
                    $$ X(f) = \int_{-\infty}^{+\infty} x(t) \cdot e^{-j2\pi ft} dt $$
                    
                    <p><strong>ç¦»æ•£å‚…é‡Œå¶å˜æ¢ï¼ˆDFTï¼‰ï¼š</strong></p>
                    $$ X[k] = \sum_{n=0}^{N-1} x[n] \cdot e^{-j2\pi kn/N}, \quad k = 0, 1, ..., N-1 $$
                </div>

                <h3>1.2 çŸ­æ—¶å‚…é‡Œå¶å˜æ¢ï¼ˆSTFTï¼‰</h3>
                
                <p>è¯­éŸ³ä¿¡å·æ˜¯éå¹³ç¨³ä¿¡å·ï¼Œå…¶é¢‘ç‡ç‰¹æ€§éšæ—¶é—´å˜åŒ–ã€‚STFTé€šè¿‡åˆ†å¸§åŠ çª—å¤„ç†ï¼Œè·å¾—æ—¶é¢‘ç‰¹æ€§ï¼š</p>
                
                <div class="formula-box">
                    $$ X(m, k) = \sum_{n=0}^{L-1} x[n + mR] \cdot w[n] \cdot e^{-j2\pi kn/N} $$
                    <ul>
                        <li>$w[n]$ï¼šçª—å‡½æ•°ï¼ˆæ±‰å®çª—ã€æ±‰æ˜çª—ç­‰ï¼‰</li>
                        <li>$R$ï¼šå¸§ç§»ï¼ˆHop Sizeï¼‰</li>
                        <li>$m$ï¼šå¸§ç´¢å¼•</li>
                        <li>$N$ï¼šFFTç‚¹æ•°</li>
                    </ul>
                </div>

                <h3>1.3 Phase Vocoder ç›¸ä½å£°ç å™¨</h3>

                <p>Phase Vocoder æ˜¯ä¸€ç§åŸºäº STFT çš„æ—¶é¢‘å¤„ç†æŠ€æœ¯ã€‚åœ¨å˜é€Ÿå®éªŒä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ä¿®æ”¹å¸§ç§»å®ç°æ—¶é—´æ‹‰ä¼¸ï¼š</p>

                <div class="figure">
                    <canvas id="pvFlowCanvas" width="800" height="200"></canvas>
                    <p class="figure-caption">å›¾1.1 Phase Vocoder åŸºæœ¬æµç¨‹</p>
                </div>

                <div class="info-box">
                    <strong>ğŸ’¡ å›é¡¾ï¼š</strong>
                    <ul>
                        <li><strong>å˜é€ŸåŸç†ï¼š</strong>ä»¥åˆ†æå¸§ç§» $R_a$ åˆ†å¸§ï¼Œä»¥åˆæˆå¸§ç§» $R_s$ é‡å»º</li>
                        <li><strong>æ‹‰ä¼¸å› å­ï¼š</strong>$\alpha = R_s / R_a$ï¼ˆ$\alpha > 1$ å‡é€Ÿï¼Œ$\alpha < 1$ åŠ é€Ÿï¼‰</li>
                        <li><strong>ç›¸ä½ä¿®æ­£ï¼š</strong>ä¿è¯é¢‘ç‡è¿ç»­æ€§ï¼Œé¿å…ç›¸ä½ä¸è¿ç»­å¯¼è‡´çš„ä¼ªå½±</li>
                    </ul>
                </div>
            </section>

            <!-- Section 2: å®éªŒç®€ä»‹ -->
            <section id="intro">
                <h2>ğŸ¯ äºŒã€å®éªŒç®€ä»‹</h2>

                <h3>2.1 ä»€ä¹ˆæ˜¯å˜è°ƒï¼Ÿ</h3>

                <p>å˜è°ƒï¼ˆPitch Shiftingï¼‰æ˜¯æŒ‡æ”¹å˜éŸ³é¢‘ä¿¡å·çš„<span class="highlight">åŸºæœ¬é¢‘ç‡ï¼ˆåŸºé¢‘ï¼‰</span>ï¼Œä»è€Œæ”¹å˜æˆ‘ä»¬å¬åˆ°çš„éŸ³é«˜ã€‚</p>

                <div class="two-column">
                    <div class="comparison-card">
                        <h4>ğŸ¹ éŸ³ä¹ä¸­çš„éŸ³è°ƒ</h4>
                        <p>ä¸­éŸ³Cï¼ˆdoï¼‰çš„åŸºé¢‘ä¸º <strong>261 Hz</strong></p>
                        <p>ä¸­éŸ³Eï¼ˆmiï¼‰çš„åŸºé¢‘ä¸º <strong>330 Hz</strong></p>
                        <p>mi æ¯” do é«˜ï¼Œå› ä¸ºåŸºé¢‘æ›´å¤§</p>
                    </div>
                    <div class="comparison-card">
                        <h4>ğŸ‘¥ ç”·å¥³å£°å·®å¼‚</h4>
                        <p>ç”·æ€§åŸºé¢‘ï¼š<strong>85 - 180 Hz</strong></p>
                        <p>å¥³æ€§åŸºé¢‘ï¼š<strong>165 - 255 Hz</strong></p>
                        <p>é€šå¸¸ &gt;160Hz åˆ¤æ–­ä¸ºå¥³å£°</p>
                    </div>
                </div>

                <h3>2.2 é’¢ç´éŸ³é˜¶é¢‘è°±å¯¹æ¯”</h3>

                <div class="figure">
                    <canvas id="pianoCanvas" width="800" height="420"></canvas>
                    <p class="figure-caption">å›¾2.1 é’¢ç´ä¸­éŸ³Cï¼ˆdoï¼‰å’Œä¸­éŸ³Eï¼ˆmiï¼‰çš„é¢‘è°±å›¾å¯¹æ¯”</p>
                </div>

                <p>å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œdo çš„åŸºé¢‘åœ¨ 261.339 Hzï¼Œmi çš„åŸºé¢‘åœ¨ 329.607 Hzã€‚é™¤äº†åŸºé¢‘ï¼Œè¿˜èƒ½è§‚å¯Ÿåˆ°å‡ ä¸ªæ³¢å³°ï¼Œè¿™äº›è¢«ç§°ä¸º<strong>è°æ³¢</strong>ï¼Œæ˜¯åŸºé¢‘çš„æ•´æ•°å€ã€‚</p>

                <h3>2.3 ç”·å¥³å£°é¢‘è°±å¯¹æ¯”</h3>

                <div class="figure">
                    <canvas id="genderCanvas" width="800" height="280"></canvas>
                    <p class="figure-caption">å›¾2.2 ç”·å¥³å£°é¢‘è°±å¯¹æ¯”ï¼ˆç”·æ€§åŸºé¢‘çº¦113Hzï¼Œå¥³æ€§åŸºé¢‘çº¦197Hzï¼‰</p>
                </div>

                <div class="tip-box">
                    <strong>ğŸ”§ MATLABæç¤ºï¼š</strong>
                    <p>å¯ä»¥é€šè¿‡è°ƒç”¨ <code>f0 = pitch(x, fs)</code> å‡½æ•°ç›´æ¥å¾—åˆ°è¯­éŸ³ä¿¡å·åŸºé¢‘ã€‚ï¼ˆè¦æ±‚MATLABç‰ˆæœ¬åœ¨2018ä»¥åï¼‰</p>
                </div>
            </section>

            <!-- Section 3: äººä½“å‘å£°åŸç† -->
            <section id="voice">
                <h2>ğŸ—£ï¸ ä¸‰ã€äººä½“å‘å£°åŸç†</h2>

                <p>å½“æˆ‘ä»¬è¯´è¯æ—¶ï¼Œç©ºæ°”é€šè¿‡è‚ºéƒ¨ä¼ é€’åˆ°å£°å¸¦ï¼Œå£°é—¨çš„é—­åˆå¼•å‘ç©ºæ°”éœ‡åŠ¨ï¼Œå†ä¼ è¿‡è°ƒéŸ³åŒºå°±å½¢æˆäº†è¯­éŸ³ä¿¡å·ã€‚ç®€å•æ¥è¯´ï¼Œæœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼š<strong>å£°å¸¦ï¼ˆå£°æºåŒºï¼‰</strong>å’Œ<strong>è¿‡æ»¤å™¨ï¼ˆè°ƒéŸ³åŒºï¼‰</strong>ã€‚</p>

                <div class="figure">
                    <canvas id="vocalCanvas" width="500" height="450"></canvas>
                    <p class="figure-caption">å›¾3.1 äººä½“å‘å£°å™¨å®˜ç¤ºæ„å›¾</p>
                </div>

                <div class="three-column">
                    <div class="step-box">
                        <h4>ğŸ« åŠ¨åŠ›åŒº</h4>
                        <p>è‚ºéƒ¨å’Œæ¨ªè†ˆè†œæä¾›æ°”æµåŠ¨åŠ›</p>
                    </div>
                    <div class="step-box">
                        <h4>ğŸ”Š å£°æºåŒº</h4>
                        <p>å£°å¸¦æŒ¯åŠ¨äº§ç”ŸåŸºé¢‘ï¼Œå†³å®šéŸ³é«˜</p>
                    </div>
                    <div class="step-box">
                        <h4>ğŸ­ è°ƒéŸ³åŒº</h4>
                        <p>å£è…”ã€å’½è…”ã€é¼»è…”ä¿®é¥°éŸ³è‰²</p>
                    </div>
                </div>

                <div class="warning-box">
                    <strong>âš ï¸ é‡è¦ç†è§£ï¼š</strong>
                    <p>å‡è®¾å¤§å®¶å”±åŒä¸€é¦–æ­Œçš„ç¬¬ä¸€ä¸ªéŸ³ï¼ŒéŸ³è°ƒä¸€æ ·ï¼ˆåŸºé¢‘ç›¸åŒï¼‰ï¼Œä½†é€šè¿‡è¿‡æ»¤å™¨åï¼Œæ¯ä¸ªäººå£è…”çš„å½¢çŠ¶ã€èˆŒå¤´çš„ä½ç½®ç­‰éƒ½ä¼šå¯¹éŸ³è‰²è¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥åŒºåˆ«äº†æ¯ä¸ªäººä¸åŒçš„è¯´è¯å£°éŸ³ã€‚</p>
                    <p>å³ä½¿æˆ‘ä»¬æ”¹å˜äº†è¯­éŸ³ä¿¡å·çš„åŸºé¢‘ï¼Œå°†å¥³æ€§å£°éŸ³çš„éŸ³è°ƒå˜å¾—ä½æ²‰åï¼Œå…¶ç»“æœä¹Ÿå¹¶ä¸å¤ªåƒæ˜¯ç”·æ€§å£°éŸ³ï¼Œå…¶åŸå› å°±æ˜¯æˆ‘ä»¬æ²¡æœ‰å¯¹è¿‡æ»¤å™¨éƒ¨åˆ†è¿›è¡Œä¿®æ”¹ã€‚</p>
                </div>
            </section>

            <!-- Section 4: å…±æŒ¯å³° -->
            <section id="formant">
                <h2>ğŸ“Š å››ã€å…±æŒ¯å³° (Formant)</h2>

                <h3>4.1 å…±æŒ¯å³°çš„æ¦‚å¿µ</h3>

                <p>è¿‡æ»¤å™¨ï¼ˆè°ƒéŸ³åŒºï¼‰éƒ¨åˆ†åŒºåˆ†äº†æ¯ä¸ªäººä¸åŒçš„éŸ³è‰²ã€‚æè¿°è¿™ä¸€éƒ¨åˆ†çš„å‚æ•°è¢«ç§°ä½œ<span class="highlight">å…±æŒ¯å³°ï¼ˆFormantï¼‰</span>ã€‚</p>

                <div class="info-box">
                    <strong>ğŸ’¡ åŸºé¢‘ vs å…±æŒ¯å³°ï¼š</strong>
                    <ul>
                        <li><strong>åŸºé¢‘ï¼ˆF0ï¼‰</strong>ï¼šå£°æºéƒ¨åˆ†ï¼Œå†³å®šéŸ³é«˜</li>
                        <li><strong>å…±æŒ¯å³°ï¼ˆF1, F2, F3...ï¼‰</strong>ï¼šè¿‡æ»¤éƒ¨åˆ†ï¼Œå†³å®šéŸ³è‰²</li>
                    </ul>
                    <p>äºŒè€…å¹¶æ— ç›´æ¥å…³ç³»ï¼Œä½†ç”±äºå£è…”å†…ç©ºæ°”çš„ä¼ æ’­é€ æˆçš„å…±æŒ¯ä¼šå’Œå£°æºéƒ¨åˆ†ç›¸äº’å½±å“ï¼Œæ‰€ä»¥å…±æŒ¯å³°å¾€å¾€å‡ºç°åœ¨è°æ³¢é™„è¿‘ï¼Œè¿™ä¹Ÿé€ æˆäº†åŒºåˆ†å…±æŒ¯å³°å’Œè°æ³¢çš„å›°éš¾ã€‚</p>
                </div>

                <h3>4.2 ä¸åŒå…ƒéŸ³çš„å…±æŒ¯å³°</h3>

                <p>ä»¥ä¸‹æ˜¾ç¤ºäº†åˆ†åˆ«å‘å‡ºå…ƒéŸ³ã€ahã€‘ã€ã€eeã€‘ã€ã€ooã€‘çš„é¢‘è°±å›¾ï¼Œå¯ä»¥æ˜æ˜¾çœ‹å‡ºä¸‰ä¸ªä¸åŒå…ƒéŸ³çš„å…±æŒ¯å³°çš„ä¸åŒã€‚</p>

                <div class="figure">
                    <canvas id="vowelCanvas" width="750" height="480"></canvas>
                    <p class="figure-caption">å›¾4.1 å…ƒéŸ³ [AH]ã€[EE]ã€[OO] çš„å£å‹ä¸é¢‘è°±å¯¹æ¯”</p>
                </div>

                <h3>4.3 å…±æŒ¯å³°çš„é™åˆ¶</h3>

                <p>äººç±»çš„å‘å£°å™¨å®˜é™å®šäº†æˆ‘ä»¬çš„å…±æŒ¯å³°æ˜¯æœ‰å›ºå®šèŒƒå›´çš„ï¼š</p>

                <table>
                    <tr>
                        <th>æ€§åˆ«</th>
                        <th>å…ƒéŸ³ i/u çš„å…±æŒ¯å³°èŒƒå›´</th>
                    </tr>
                    <tr>
                        <td>å¥³æ€§</td>
                        <td>600 ~ 2900 Hz</td>
                    </tr>
                    <tr>
                        <td>ç”·æ€§</td>
                        <td>500 ~ 2600 Hz</td>
                    </tr>
                </table>

                <div class="warning-box">
                    <strong>âš ï¸ "å°é»„äºº"æ•ˆåº”ï¼š</strong>
                    <p>å½“æˆ‘ä»¬å‡é«˜äº†éŸ³è°ƒï¼Œæˆ‘ä»¬ä¹Ÿä¼šå‡é«˜å…±æŒ¯å³°ã€‚<strong>å¦‚æœè¶…è¿‡äº†æ­£å¸¸äººç±»çš„å…±æŒ¯å³°èŒƒå›´ï¼Œé‚£ä¹ˆéŸ³é¢‘å¬èµ·æ¥å°±ä¼šåƒæ˜¯"å°é»„äºº"æˆ–è€…"èŠ±æ —é¼ "è¿™æ ·çš„éŸ³è‰²ã€‚</strong></p>
                </div>

                <h3>4.4 å…±æŒ¯å³°ä¿®æ­£çš„æ€æƒ³</h3>

                <p>æ€æ ·æ‰èƒ½åœ¨å‡é«˜éŸ³è°ƒï¼ˆå‡é«˜åŸºé¢‘ï¼‰çš„åŒæ—¶ä¿ç•™å…±æŒ¯å³°ï¼Ÿæˆ‘ä»¬éœ€è¦<strong>å…±æŒ¯å³°ä¿®æ­£</strong>ã€‚ä»¥ä¿ç•™é¢‘è°±å¹…åº¦ä¸ºæ€æƒ³å®ç°ä¿ç•™å…±æŒ¯å³°çš„ç›®çš„ã€‚</p>

                <div class="figure">
                    <canvas id="envelopeCanvas" width="350" height="480"></canvas>
                    <p class="figure-caption">å›¾4.2 é¢‘è°±å¹…åº¦ä¿®æ­£åŸç†ï¼š(a)åŸå§‹ â†’ (b)å‡è°ƒæ‹‰ä¼¸åŒ…ç»œ â†’ (c)ä¿®æ­£ä¿æŒåŸåŒ…ç»œ</p>
                </div>
            </section>

            <!-- Section 5: æ–¹æ³•ä¸€ -->
            <section id="method1">
                <h2>âš™ï¸ äº”ã€PVå˜è°ƒ - æ–¹æ³•ä¸€</h2>

                <h3>5.1 åŸºäºæ—¶é—´ä¼¸ç¼© + é‡é‡‡æ ·</h3>

                <p>åœ¨ä¸Šä¸€æ¬¡å®éªŒä¸­ï¼Œæˆ‘ä»¬åŸºäº PV åŸç†å¯¹éŸ³é¢‘å®ç°äº†å˜é€Ÿå¤„ç†ã€‚å›å¿†å…¶æµç¨‹ï¼šç›¸ä½ç¼–ç å™¨é€šè¿‡ä¿®æ­£æ¯å¸§ç›¸ä½åï¼Œä»¥æ–°çš„å¸§ç§»è¿›è¡Œé‡å»ºå®ç°å¯¹äºéŸ³é¢‘é•¿åº¦çš„æ”¹å˜ã€‚</p>

                <div class="info-box">
                    <strong>ğŸ’¡ æ–¹æ³•ä¸€åŸç†ï¼š</strong>
                    <p>å¦‚æœä»¥ $R_a$ ä½œä¸ºå¸§ç§»åˆ†å¸§åæœ‰ W å¸§ä¿¡å·ï¼Œæ¯å¸§ä¿¡å·å¤§å°ä¸º [U, V]ï¼Œè®¡ç®—é¢‘è°±å¹¶ä¿®æ­£ç›¸ä½å†è¿˜åŸå›æ—¶é—´ä¿¡å·åï¼Œæ¯å¸§çš„å¤§å°ä»ç„¶æ˜¯ [U, V]ï¼Œä»¥ $R_s$ ä½œä¸ºæ–°çš„å¸§ç§»å¯¹ W å¸§ä¿¡å·è¿›è¡Œåˆå¹¶ã€‚</p>
                </div>

                <h3>5.2 æ–¹æ³•ä¸€æµç¨‹</h3>

                <div class="flow-step">
                    <div class="flow-icon">1</div>
                    <div class="flow-content">
                        <h4>Phase Vocoder æ—¶é—´ä¼¸ç¼©</h4>
                        <p>ä½¿ç”¨å˜é€Ÿå®éªŒçš„PVç®—æ³•ï¼Œæ”¹å˜å¸§ç§»å®ç°æ—¶é—´æ‹‰ä¼¸/å‹ç¼©</p>
                    </div>
                </div>
                <div class="flow-arrow">â†“</div>
                <div class="flow-step">
                    <div class="flow-icon">2</div>
                    <div class="flow-content">
                        <h4>é‡é‡‡æ ·æ¢å¤åŸé•¿</h4>
                        <p>é€šè¿‡æ’å€¼å°†ä¿¡å·æ¢å¤åˆ°åŸå§‹é•¿åº¦ï¼Œå®ç°é¢‘ç‡å˜åŒ–</p>
                    </div>
                </div>

                <div class="two-column">
                    <div class="step-box">
                        <h4>ğŸ”¼ å‡é«˜éŸ³è°ƒ</h4>
                        <ol>
                            <li>PV æ‹‰ä¼¸ä¿¡å·ï¼ˆ$\alpha > 1$ï¼‰</li>
                            <li>ä¸‹é‡‡æ ·åˆ°åŸé•¿åº¦</li>
                            <li>é¢‘ç‡å‡é«˜ï¼ŒéŸ³è°ƒä¸Šå‡</li>
                        </ol>
                    </div>
                    <div class="step-box">
                        <h4>ğŸ”½ é™ä½éŸ³è°ƒ</h4>
                        <ol>
                            <li>PV å‹ç¼©ä¿¡å·ï¼ˆ$\alpha < 1$ï¼‰</li>
                            <li>ä¸Šé‡‡æ ·åˆ°åŸé•¿åº¦</li>
                            <li>é¢‘ç‡é™ä½ï¼ŒéŸ³è°ƒä¸‹é™</li>
                        </ol>
                    </div>
                </div>
            </section>

            <!-- Section 6: æ–¹æ³•äºŒ -->
            <section id="method2">
                <h2>ğŸ”§ å…­ã€PVå˜è°ƒ - æ–¹æ³•äºŒ</h2>

                <h3>6.1 åŸºäºé¢‘è°±å¸§æ“ä½œ</h3>

                <p>æ–¹æ³•äºŒä»æ—¶é—´è§’åº¦å¯¹å˜è°ƒè¿›è¡Œå®ç°ã€‚ä»ç„¶ä»¥ $R_a$ ä½œä¸ºå¸§ç§»è¿›è¡Œåˆ†å¸§ï¼Œå¯¹ W å¸§ä¿¡å·è®¡ç®—é¢‘è°±åï¼Œé€šè¿‡å¯¹é¢‘è°±çš„<strong>æŠ½å–ï¼ˆå‡å°‘å¸§ï¼‰</strong>æˆ–<strong>å¤åˆ¶ï¼ˆå¢åŠ å¸§ï¼‰</strong>ï¼Œå†åå˜æ¢å›æ—¶é—´ä¿¡å·åï¼Œä»ç„¶ä»¥ $R_a$ ä½œä¸ºå¸§ç§»è¿›è¡Œé‡å»ºã€‚ç”±äºå¸§æ•°çš„å˜åŒ–ï¼Œé‡å»ºåçš„ä¿¡å·é•¿åº¦å’ŒåŸå§‹ä¿¡å·çš„é•¿åº¦ä¸åŒï¼Œæ­¤æ—¶é€šè¿‡æ’å€¼è¿˜åŸåˆ°åŸå§‹éŸ³é¢‘é•¿åº¦ï¼Œå®ç°å˜è°ƒã€‚</p>

                <div class="figure">
                    <canvas id="method2Canvas" width="800" height="650"></canvas>
                    <p class="figure-caption">å›¾6.1 æ–¹æ³•äºŒï¼šä»¥ Î±=0.5 ä¸ºä¾‹çš„é¢‘è°±å¸§æŠ½å–å˜è°ƒæµç¨‹</p>
                </div>

                <h3>6.2 æ–¹æ³•äºŒè¯¦ç»†æ­¥éª¤</h3>

                <div class="flow-step">
                    <div class="flow-icon">1</div>
                    <div class="flow-content">
                        <h4>è¯»å…¥éŸ³é¢‘ä¿¡å· x(n)</h4>
                        <p>è¯»å–åŸå§‹éŸ³é¢‘æ–‡ä»¶</p>
                    </div>
                </div>
                <div class="flow-arrow">â†“</div>
                <div class="flow-step">
                    <div class="flow-icon">2</div>
                    <div class="flow-content">
                        <h4>åˆ†å¸§åŠ çª—</h4>
                        <p>ä»¥å¸§é•¿ Mã€å¸§ç§» R = M - L å¯¹ä¿¡å·åˆ†å¸§ï¼Œä¹˜ä»¥çª—å‡½æ•° g(n)</p>
                    </div>
                </div>
                <div class="flow-arrow">â†“</div>
                <div class="flow-step">
                    <div class="flow-icon">3</div>
                    <div class="flow-content">
                        <h4>FFTè®¡ç®—æ¯å¸§é¢‘è°±</h4>
                        <p>å¾—åˆ°é¢‘è°±çŸ©é˜µ $|X_1(f)|^2, |X_2(f)|^2, ..., |X_W(f)|^2$</p>
                    </div>
                </div>
                <div class="flow-arrow">â†“</div>
                <div class="flow-step">
                    <div class="flow-icon">4</div>
                    <div class="flow-content">
                        <h4>é¢‘è°±å¸§æ“ä½œï¼ˆä»¥ Î±=0.5 ä¸ºä¾‹ï¼‰</h4>
                        <p>æ¯2å¸§ä¿ç•™1å¸§è¿›è¡Œé™è°ƒï¼›å‡è°ƒåˆ™å¤åˆ¶å¸§</p>
                    </div>
                </div>
                <div class="flow-arrow">â†“</div>
                <div class="flow-step">
                    <div class="flow-icon">5</div>
                    <div class="flow-content">
                        <h4>IFFT + OLAé‡å»ºæ—¶åŸŸä¿¡å·</h4>
                        <p>é€†å˜æ¢åä½¿ç”¨åŸå§‹å¸§ç§» R è¿›è¡Œé‡å ç›¸åŠ </p>
                    </div>
                </div>
                <div class="flow-arrow">â†“</div>
                <div class="flow-step">
                    <div class="flow-icon">6</div>
                    <div class="flow-content">
                        <h4>æ’å€¼æ‹‰ä¼¸å›åŸå§‹é•¿åº¦</h4>
                        <p>ä¿¡å·é•¿åº¦å˜åŒ–åï¼Œé€šè¿‡æ’å€¼æ¢å¤åŸé•¿ï¼Œé¢‘ç‡éšä¹‹å˜åŒ–</p>
                    </div>
                </div>

                <h3>6.3 ä¸¤ç§æ–¹æ³•å¯¹æ¯”</h3>

                <table>
                    <tr>
                        <th>ç‰¹æ€§</th>
                        <th>æ–¹æ³•ä¸€ï¼ˆæ—¶é—´ä¼¸ç¼©+é‡é‡‡æ ·ï¼‰</th>
                        <th>æ–¹æ³•äºŒï¼ˆé¢‘è°±å¸§æ“ä½œï¼‰</th>
                    </tr>
                    <tr>
                        <td>æ ¸å¿ƒæ€æƒ³</td>
                        <td>å…ˆå˜é€Ÿåé‡é‡‡æ ·</td>
                        <td>ç›´æ¥æ“ä½œé¢‘è°±å¸§æ•°</td>
                    </tr>
                    <tr>
                        <td>å®ç°éš¾åº¦</td>
                        <td>è¾ƒç®€å•ï¼Œå¤ç”¨PVå˜é€Ÿä»£ç </td>
                        <td>éœ€è¦ç†è§£å¸§æ“ä½œ</td>
                    </tr>
                    <tr>
                        <td>é‡å»ºå¸§ç§»</td>
                        <td>ä½¿ç”¨æ–°å¸§ç§» $R_s$</td>
                        <td>ä½¿ç”¨åŸå¸§ç§» $R_a$</td>
                    </tr>
                </table>
            </section>

            <!-- Section 7: é¢‘è°±å¹…åº¦ä¿®æ­£ -->
            <section id="correction">
                <h2>ğŸ”¬ ä¸ƒã€é¢‘è°±å¹…åº¦ä¿®æ­£åŸç†</h2>

                <h3>7.1 ä¸ºä»€ä¹ˆéœ€è¦é¢‘è°±ä¿®æ­£ï¼Ÿ</h3>

                <p>å¦‚å‰æ–‡æ‰€è¯´ï¼Œä¿®æ­£é¢‘è°±å¹…åº¦å¯ä»¥ç®€å•å®ç°ä¿®æ­£å…±æŒ¯å³°çš„ç›®çš„ï¼Œè¾¾åˆ°ç»´æŒåŸå£°éŸ³è´¨çš„æ•ˆæœã€‚</p>

                <h3>7.2 é¢‘è°±å¯¹æ¯”</h3>

                <p>å‡è®¾æˆ‘ä»¬æœ‰åŸå§‹éŸ³é¢‘ orig2.wavï¼Œå¯ä»¥çœ‹åˆ°å®ƒçš„å…±æŒ¯å³°è°±å›¾å¦‚ä¸‹ï¼š</p>

                <div class="figure">
                    <canvas id="specOriginal" width="700" height="230"></canvas>
                    <p class="figure-caption">å›¾7.1 åŸå§‹éŸ³é¢‘é¢‘è°±ï¼ˆFundamentalæ ‡è®°åŸºé¢‘ï¼ŒFæ ‡è®°å…±æŒ¯å³°ä½ç½®ï¼‰</p>
                </div>

                <p>å‡è‹¥æˆ‘ä»¬å‡é«˜äº†éŸ³è°ƒï¼ŒåŸºé¢‘å’Œå…±æŒ¯å³°çš„ä½ç½®åŒæ—¶å‘å³åç§»ï¼Œå¯ä»¥çœ‹åˆ°å…±æŒ¯å³°çš„æ³¢å½¢ç›¸æ¯”åŸå§‹è¦å®½ï¼š</p>

                <div class="figure">
                    <canvas id="specShifted" width="700" height="230"></canvas>
                    <p class="figure-caption">å›¾7.2 å‡é«˜éŸ³è°ƒåçš„é¢‘è°±ï¼ˆåŸºé¢‘å³ç§»ï¼Œå…±æŒ¯å³°åŒ…ç»œè¢«æ‹‰ä¼¸ï¼‰</p>
                </div>

                <p>ä¿®æ­£å…±æŒ¯å³°ä½¿å¾—æ³¢å½¢å’ŒåŸå§‹ä¸€è‡´ï¼Œæœ€ç»ˆç›®çš„æ˜¯<strong>åŸºé¢‘å‘å³å‡é«˜ï¼Œå…±æŒ¯å³°åŒ…ç»œä¸å˜</strong>ï¼š</p>

                <div class="figure">
                    <canvas id="specCorrected" width="700" height="230"></canvas>
                    <p class="figure-caption">å›¾7.3 ä¿®æ­£åé¢‘è°±ï¼ˆåŸºé¢‘å‡é«˜ï¼Œä½†å…±æŒ¯å³°åŒ…ç»œä¿æŒåŸå§‹ä½ç½®ï¼‰</p>
                </div>

                <h3>7.3 é¢‘è°±ä¿®æ­£ç®—æ³•æµç¨‹</h3>

                <div class="success-box">
                    <strong>âœ… ç®—æ³•æ­¥éª¤ï¼š</strong>
                    <ol>
                        <li><strong>åˆ†æé˜¶æ®µï¼š</strong>å¯¹åŸå§‹éŸ³é¢‘ä¿¡å·åˆ†å¸§åŠ çª—åå¾—åˆ°æ¯å¸§ä¿¡å·çš„é¢‘è°±ï¼Œå¦‚å›¾Aæ‰€ç¤º</li>
                        <li><strong>æ±‚åŒ…ç»œï¼š</strong>æ±‚å¾—æ¯å¸§ä¿¡å·çš„åŒ…ç»œï¼Œå¦‚å›¾Aä¸­FæŠ˜çº¿æ‰€ç¤º</li>
                        <li><strong>è®¡ç®—æ®‹å·®ï¼š</strong>ç”¨æ¯å¸§ä¿¡å·çš„é¢‘è°±é™¤ä»¥åŒ…ç»œå¾—åˆ°æ¶ˆé™¤å…±æŒ¯å³°åçš„è¯­éŸ³é¢‘è°±æ®‹ç•™</li>
                        <li><strong>é‡æ„åŒ…ç»œï¼š</strong>æ ¹æ®å˜è°ƒå› å­å’Œç¬¬2æ­¥ä¸­çš„åŒ…ç»œé‡æ„FæŠ˜çº¿ï¼Œå¦‚å›¾Cä¸­FæŠ˜çº¿æ‰€ç¤º</li>
                        <li><strong>åˆæˆè¾“å‡ºï¼š</strong>å°†ç¬¬3æ­¥ä¸­çš„è¯­éŸ³é¢‘è°±æ®‹ç•™ä¹˜ä»¥ç¬¬4æ­¥ä¸­çš„é‡æ„åŒ…ç»œå¾—åˆ°å›¾Cè¯­éŸ³ä¿¡å·</li>
                    </ol>
                </div>

                <h3>7.4 åŒ…ç»œæå–æ–¹æ³•ï¼ˆæ‹“å±•çŸ¥è¯†ï¼‰</h3>

                <div class="two-column">
                    <div class="step-box">
                        <h4>LPCï¼ˆçº¿æ€§é¢„æµ‹ç¼–ç ï¼‰</h4>
                        <p>å‡è®¾å½“å‰é‡‡æ ·ç‚¹å¯ä»¥ç”±å‰è‹¥å¹²ä¸ªé‡‡æ ·ç‚¹çº¿æ€§é¢„æµ‹ï¼š</p>
                        <p>$\hat{x}[n] = \sum_{k=1}^{p} a_k \cdot x[n-k]$</p>
                        <pre><code>[a, g] = lpc(frame, p);
[H, w] = freqz(g, a, nfft);
envelope = abs(H);</code></pre>
                    </div>
                    <div class="step-box">
                        <h4>å€’è°±æ³•ï¼ˆCepstrumï¼‰</h4>
                        <p>é¢‘è°±å–å¯¹æ•°åå†åšå‚…é‡Œå¶é€†å˜æ¢ï¼š</p>
                        <p>$c[n] = IFFT\{log|FFT\{x[n]\}|\}$</p>
                        <pre><code>X = fft(frame);
ceps = ifft(log(abs(X)+eps));
% ä½é€šæ»¤æ³¢åå˜æ¢å›é¢‘åŸŸ</code></pre>
                    </div>
                </div>
            </section>

            <!-- Section 8: æ€»ç»“ -->
            <section id="summary">
                <h2>ğŸ“ å…«ã€å®éªŒæ€»ç»“</h2>

                <h3>8.1 æœ¬æ¬¡å®éªŒå†…å®¹</h3>

                <div class="three-column">
                    <div class="comparison-card">
                        <h4>ğŸµ åŸºé¢‘ä¸éŸ³è°ƒ</h4>
                        <p>ç†è§£åŸºé¢‘å†³å®šéŸ³é«˜</p>
                        <p>ç”·å¥³å£°é¢‘ç‡å·®å¼‚</p>
                    </div>
                    <div class="comparison-card">
                        <h4>ğŸ—£ï¸ å‘å£°åŸç†</h4>
                        <p>æº-æ»¤æ³¢å™¨æ¨¡å‹</p>
                        <p>å£°æºåŒº vs è°ƒéŸ³åŒº</p>
                    </div>
                    <div class="comparison-card">
                        <h4>ğŸ“Š å…±æŒ¯å³°</h4>
                        <p>éŸ³è‰²çš„å†³å®šå› ç´ </p>
                        <p>"å°é»„äºº"æ•ˆåº”</p>
                    </div>
                </div>

                <h3>8.2 ä¸¤ç§å˜è°ƒæ–¹æ³•</h3>

                <div class="two-column">
                    <div class="step-box">
                        <h4>æ–¹æ³•ä¸€</h4>
                        <p>PVæ—¶é—´ä¼¸ç¼© â†’ é‡é‡‡æ ·</p>
                        <p>ä½¿ç”¨æ–°å¸§ç§» $R_s$ é‡å»º</p>
                    </div>
                    <div class="step-box">
                        <h4>æ–¹æ³•äºŒ</h4>
                        <p>é¢‘è°±å¸§æŠ½å–/å¤åˆ¶ â†’ æ’å€¼</p>
                        <p>ä½¿ç”¨åŸå¸§ç§» $R_a$ é‡å»º</p>
                    </div>
                </div>

                <h3>8.3 å­¦ä¹ ç›®æ ‡</h3>

                <ul>
                    <li>ç†è§£éŸ³é¢‘åŸºé¢‘ä¸éŸ³è°ƒçš„å…³ç³»</li>
                    <li>æŒæ¡ Phase Vocoder å˜è°ƒç®—æ³•åŸç†</li>
                    <li>ç†è§£å…±æŒ¯å³°ï¼ˆFormantï¼‰çš„æ¦‚å¿µåŠå…¶ä½œç”¨</li>
                    <li>å®ç°é¢‘è°±å¹…åº¦ä¿®æ­£ä»¥ä¿æŒéŸ³è‰²</li>
                </ul>

                <div class="tip-box">
                    <strong>ğŸ¯ å®éªŒæç¤ºï¼š</strong>
                    <ul>
                        <li>æ¨èä½¿ç”¨æ±‰å®çª—ï¼ˆHanning Windowï¼‰ï¼Œçª—é•¿1024ï¼Œå¸§ç§»256</li>
                        <li>å˜è°ƒå› å­ $\alpha$ï¼š$\alpha > 1$ å‡è°ƒï¼Œ$\alpha < 1$ é™è°ƒ</li>
                        <li>æ³¨æ„å¤„ç†é¢‘ç‡è¶…å‡ºå¥ˆå¥æ–¯ç‰¹é¢‘ç‡çš„æƒ…å†µ</li>
                    </ul>
                </div>
            </section>
        </div>

        <footer>
            <p><strong>å—äº¬å·¥ä¸šå¤§å­¦æµ¦æ±Ÿå­¦é™¢ | è®¡ç®—æœºä¸é€šä¿¡å·¥ç¨‹ä¸“ä¸š | é€šä¿¡å·¥ç¨‹ | DSPè¯¾ç¨‹å®è·µ</strong></p>
            <p style="margin-top: 10px; opacity: 0.9;">äººå£°å˜è°ƒå®éªŒ - åŸºäºç›¸ä½å£°ç å™¨çš„éŸ³é¢‘å˜è°ƒ</p>
        </footer>
    </div>

    <script>
        // è¿›åº¦æ¡å’Œå¯¼èˆªåŠŸèƒ½
        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }

        window.addEventListener('scroll', function() {
            const sections = ['review', 'intro', 'voice', 'formant', 'method1', 'method2', 'correction', 'summary'];
            const scrollTop = window.scrollY;
            const docHeight = document.documentElement.scrollHeight - window.innerHeight;
            const progress = (scrollTop / docHeight) * 100;
            
            document.querySelector('.vertical-progress').style.setProperty('--progress', progress + '%');
            
            // æ›´æ–°æ´»åŠ¨æ ‡è®°
            const markers = document.querySelectorAll('.progress-marker');
            sections.forEach((section, index) => {
                const el = document.getElementById(section);
                if (el) {
                    const rect = el.getBoundingClientRect();
                    if (rect.top <= 200 && rect.bottom >= 200) {
                        markers.forEach(m => m.classList.remove('active'));
                        markers[index].classList.add('active');
                    }
                }
            });

            // è¿”å›é¡¶éƒ¨æŒ‰é’®
            const backBtn = document.querySelector('.back-to-top');
            if (scrollTop > 300) {
                backBtn.classList.add('visible');
            } else {
                backBtn.classList.remove('visible');
            }
        });

        // ========== Canvas ç»˜å›¾ ==========

        // ç»˜åˆ¶PVæµç¨‹å›¾
        function drawPVFlow() {
            const canvas = document.getElementById('pvFlowCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const w = canvas.width, h = canvas.height;
            
            ctx.fillStyle = '#f7fafc';
            ctx.fillRect(0, 0, w, h);
            
            const steps = ['è¾“å…¥ä¿¡å·', 'åˆ†å¸§åŠ çª—', 'FFT', 'ä¿®æ”¹å¸§ç§»/ç›¸ä½', 'IFFT', 'OLAé‡å»º', 'è¾“å‡ºä¿¡å·'];
            const colors = ['#e74c3c', '#f39c12', '#2ecc71', '#3498db', '#9b59b6', '#1abc9c', '#e74c3c'];
            
            const boxW = 90, boxH = 50;
            const startX = 30, gap = 10;
            
            steps.forEach((step, i) => {
                const x = startX + i * (boxW + gap + 15);
                const y = (h - boxH) / 2;
                
                // ç®­å¤´
                if (i > 0) {
                    ctx.beginPath();
                    ctx.moveTo(x - 20, h/2);
                    ctx.lineTo(x - 5, h/2);
                    ctx.strokeStyle = '#666';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                    ctx.beginPath();
                    ctx.moveTo(x - 10, h/2 - 5);
                    ctx.lineTo(x - 5, h/2);
                    ctx.lineTo(x - 10, h/2 + 5);
                    ctx.fillStyle = '#666';
                    ctx.fill();
                }
                
                // åœ†è§’çŸ©å½¢
                ctx.beginPath();
                ctx.roundRect(x, y, boxW, boxH, 8);
                ctx.fillStyle = colors[i];
                ctx.fill();
                
                // æ–‡å­—
                ctx.fillStyle = 'white';
                ctx.font = 'bold 11px Microsoft YaHei';
                ctx.textAlign = 'center';
                ctx.fillText(step, x + boxW/2, y + boxH/2 + 4);
            });
        }

        // ç»˜åˆ¶é’¢ç´é¢‘è°±
        function drawPianoSpectrum() {
            const canvas = document.getElementById('pianoCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const w = canvas.width, h = canvas.height;
            
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, w, h);
            
            // do é¢‘è°±
            drawSingleSpectrum(ctx, 50, 30, 700, 160, 'do', '#3498db', [
                {freq: 261.339, amp: 482, label: 'X: 261.339\nY: 502.896'},
                {freq: 523.745, amp: 248, label: 'X: 523.745\nY: 248.486'},
                {freq: 788.151, amp: 66, label: 'X: 788.151\nY: 66.4725'},
                {freq: 1048.62, amp: 76, label: 'X: 1048.62\nY: 75.819'}
            ]);
            
            // mi é¢‘è°±
            drawSingleSpectrum(ctx, 50, 240, 700, 160, 'mi', '#3498db', [
                {freq: 329.607, amp: 404, label: 'X: 329.607\nY: 404.397'},
                {freq: 660.281, amp: 130, label: 'X: 660.281\nY: 130.28'},
                {freq: 990.855, amp: 129, label: 'X: 990.855\nY: 129'},
                {freq: 1320.7, amp: 32, label: 'X: 1320.7\nY: 31.7763'}
            ]);
        }

        function drawSingleSpectrum(ctx, ox, oy, w, h, title, color, harmonics) {
            // æ ‡é¢˜
            ctx.fillStyle = '#333';
            ctx.font = 'bold 16px Microsoft YaHei';
            ctx.textAlign = 'center';
            ctx.fillText(title, ox + w/2, oy);
            
            // åæ ‡è½´
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(ox, oy + 20);
            ctx.lineTo(ox, oy + h);
            ctx.lineTo(ox + w, oy + h);
            ctx.stroke();
            
            // Yè½´åˆ»åº¦
            ctx.fillStyle = '#666';
            ctx.font = '10px Arial';
            ctx.textAlign = 'right';
            for (let i = 0; i <= 5; i++) {
                const val = 500 - i * 100;
                const y = oy + 25 + i * (h - 30) / 5;
                ctx.fillText(val, ox - 5, y + 3);
            }
            
            // Xè½´åˆ»åº¦
            ctx.textAlign = 'center';
            for (let i = 0; i <= 10; i++) {
                const val = i * 1000;
                const x = ox + i * w / 10;
                ctx.fillText(val, x, oy + h + 15);
            }
            ctx.fillText('Freq/Hz', ox + w/2, oy + h + 28);
            
            // è°æ³¢çº¿
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            harmonics.forEach((harm, idx) => {
                const x = ox + (harm.freq / 10000) * w;
                const barH = (harm.amp / 500) * (h - 35);
                ctx.beginPath();
                ctx.moveTo(x, oy + h);
                ctx.lineTo(x, oy + h - barH);
                ctx.stroke();
                
                // æ•°æ®æ ‡ç­¾
                ctx.fillStyle = '#06b6d4';
                ctx.font = '9px Consolas';
                ctx.textAlign = 'left';
                const lines = harm.label.split('\n');
                ctx.fillText(lines[0], x + 3, oy + h - barH - 8);
                ctx.fillText(lines[1], x + 3, oy + h - barH + 3);
            });
        }

        // ç»˜åˆ¶ç”·å¥³å£°é¢‘è°±
        function drawGenderSpectrum() {
            const canvas = document.getElementById('genderCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const w = canvas.width, h = canvas.height;
            
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, w, h);
            
            // å¥³æ€§
            drawVoiceSpectrum(ctx, 50, 20, 700, 100, 'å¥³æ€§', '#ec4899', 197, [197, 387, 597, 784]);
            
            // ç”·æ€§
            drawVoiceSpectrum(ctx, 50, 150, 700, 100, 'ç”·æ€§', '#3b82f6', 113, [113, 226, 339, 452]);
        }

        function drawVoiceSpectrum(ctx, ox, oy, w, h, title, color, f0, peaks) {
            ctx.fillStyle = '#333';
            ctx.font = 'bold 14px Microsoft YaHei';
            ctx.textAlign = 'center';
            ctx.fillText(title, ox + w/2, oy);
            
            // åæ ‡è½´
            ctx.strokeStyle = '#666';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(ox, oy + 15);
            ctx.lineTo(ox, oy + h);
            ctx.lineTo(ox + w, oy + h);
            ctx.stroke();
            
            // Xè½´åˆ»åº¦
            ctx.fillStyle = '#666';
            ctx.font = '10px Arial';
            ctx.textAlign = 'center';
            [0, 500, 1000, 1500, 2000, 2500, 3000].forEach(val => {
                const x = ox + (val / 3000) * w;
                ctx.fillText(val, x, oy + h + 12);
            });
            ctx.fillText('Freq/Hz', ox + w/2, oy + h + 25);
            
            // é¢‘è°±æ›²çº¿
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(ox, oy + h - 10);
            
            for (let i = 0; i < w; i++) {
                const freq = (i / w) * 3000;
                let amp = 5;
                peaks.forEach((p, idx) => {
                    amp += (70 / (idx + 1)) * Math.exp(-Math.pow(freq - p, 2) / 3000);
                });
                ctx.lineTo(ox + i, oy + h - amp);
            }
            ctx.stroke();
            
            // åŸºé¢‘æ ‡æ³¨
            const f0x = ox + (f0 / 3000) * w;
            ctx.fillStyle = '#06b6d4';
            ctx.font = '9px Consolas';
            ctx.textAlign = 'left';
            ctx.fillText('X:' + f0.toFixed(2), f0x + 5, oy + 35);
        }

        // ç»˜åˆ¶å‘å£°å™¨å®˜ç¤ºæ„å›¾
        function drawVocalSystem() {
            const canvas = document.getElementById('vocalCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const w = canvas.width, h = canvas.height;
            
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, w, h);
            
            // å¤´éƒ¨è½®å»“
            ctx.strokeStyle = '#666';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.ellipse(150, 100, 80, 90, 0, 0, Math.PI * 2);
            ctx.stroke();
            
            // è°ƒéŸ³åŒºæ¡†
            ctx.fillStyle = 'rgba(142, 68, 173, 0.1)';
            ctx.fillRect(300, 30, 150, 130);
            ctx.strokeStyle = '#8e44ad';
            ctx.lineWidth = 2;
            ctx.strokeRect(300, 30, 150, 130);
            ctx.fillStyle = '#8e44ad';
            ctx.font = 'bold 16px Microsoft YaHei';
            ctx.textAlign = 'center';
            ctx.fillText('è°ƒéŸ³åŒº', 375, 60);
            ctx.font = '12px Arial';
            ctx.fillStyle = '#666';
            ctx.fillText('(Filter)', 375, 80);
            
            // å£°æºåŒºæ¡†
            ctx.fillStyle = 'rgba(231, 76, 60, 0.1)';
            ctx.fillRect(300, 170, 150, 50);
            ctx.strokeStyle = '#e74c3c';
            ctx.strokeRect(300, 170, 150, 50);
            ctx.fillStyle = '#e74c3c';
            ctx.font = 'bold 16px Microsoft YaHei';
            ctx.fillText('å£°æºåŒº', 375, 200);
            
            // åŠ¨åŠ›åŒºæ¡†
            ctx.fillStyle = 'rgba(52, 152, 219, 0.1)';
            ctx.fillRect(300, 230, 150, 150);
            ctx.strokeStyle = '#3498db';
            ctx.strokeRect(300, 230, 150, 150);
            ctx.fillStyle = '#3498db';
            ctx.font = 'bold 16px Microsoft YaHei';
            ctx.fillText('åŠ¨åŠ›åŒº', 375, 270);
            ctx.font = '12px Arial';
            ctx.fillStyle = '#666';
            ctx.fillText('(Power)', 375, 290);
            
            // é¼»è…”
            ctx.strokeStyle = '#8e44ad';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(130, 50);
            ctx.lineTo(130, 90);
            ctx.quadraticCurveTo(130, 100, 145, 100);
            ctx.stroke();
            ctx.fillStyle = '#8e44ad';
            ctx.font = '12px Microsoft YaHei';
            ctx.textAlign = 'left';
            ctx.fillText('é¼»è…”', 85, 50);
            
            // å£è…”
            ctx.beginPath();
            ctx.moveTo(110, 100);
            ctx.quadraticCurveTo(150, 90, 200, 105);
            ctx.stroke();
            ctx.fillText('å£è…”', 70, 100);
            
            // å’½è…”
            ctx.beginPath();
            ctx.moveTo(145, 115);
            ctx.lineTo(145, 165);
            ctx.stroke();
            ctx.fillText('å’½è…”', 70, 145);
            
            // èˆŒå¤´
            ctx.fillStyle = 'rgba(142, 68, 173, 0.3)';
            ctx.beginPath();
            ctx.ellipse(150, 105, 25, 10, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#666';
            ctx.font = '11px Microsoft YaHei';
            ctx.fillText('èˆŒå¤´', 60, 118);
            
            // åŒå”‡
            ctx.strokeStyle = '#e74c3c';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(200, 100);
            ctx.quadraticCurveTo(210, 100, 212, 108);
            ctx.quadraticCurveTo(210, 116, 200, 116);
            ctx.stroke();
            ctx.fillStyle = '#666';
            ctx.fillText('åŒå”‡', 218, 110);
            
            // å–‰å¤´
            ctx.fillText('å–‰å¤´', 60, 165);
            
            // å£°å¸¦
            ctx.fillStyle = 'rgba(231, 76, 60, 0.5)';
            ctx.fillRect(130, 175, 35, 15);
            ctx.strokeStyle = '#e74c3c';
            ctx.strokeRect(130, 175, 35, 15);
            ctx.fillStyle = '#e74c3c';
            ctx.font = '12px Microsoft YaHei';
            ctx.fillText('å£°å¸¦', 70, 188);
            
            // æ°”ç®¡
            ctx.strokeStyle = '#3498db';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(140, 195);
            ctx.lineTo(140, 280);
            ctx.moveTo(155, 195);
            ctx.lineTo(155, 280);
            ctx.stroke();
            ctx.fillStyle = '#3498db';
            ctx.fillText('æ°”ç®¡', 175, 240);
            
            // è‚º
            ctx.fillStyle = 'rgba(52, 152, 219, 0.2)';
            ctx.beginPath();
            ctx.ellipse(100, 340, 50, 70, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.ellipse(195, 340, 50, 70, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.strokeStyle = '#3498db';
            ctx.stroke();
            ctx.beginPath();
            ctx.ellipse(100, 340, 50, 70, 0, 0, Math.PI * 2);
            ctx.stroke();
            ctx.fillStyle = '#3498db';
            ctx.font = '14px Microsoft YaHei';
            ctx.textAlign = 'center';
            ctx.fillText('è‚º', 147, 345);
            
            // æ¨ªè†ˆè†œ
            ctx.strokeStyle = '#3498db';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(40, 415);
            ctx.quadraticCurveTo(147, 385, 255, 415);
            ctx.stroke();
            ctx.fillStyle = '#3498db';
            ctx.font = '12px Microsoft YaHei';
            ctx.fillText('æ¨ªè†ˆè†œ', 147, 435);
            
            // æ°”æµç®­å¤´
            ctx.strokeStyle = '#27ae60';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(147, 380);
            ctx.lineTo(147, 200);
            ctx.stroke();
            ctx.setLineDash([]);
            // ç®­å¤´
            ctx.fillStyle = '#27ae60';
            ctx.beginPath();
            ctx.moveTo(147, 195);
            ctx.lineTo(142, 210);
            ctx.lineTo(152, 210);
            ctx.fill();
            
            // æ ‡é¢˜
            ctx.fillStyle = '#333';
            ctx.font = 'bold 14px Microsoft YaHei';
            ctx.textAlign = 'center';
            ctx.fillText('å‘éŸ³å™¨å®˜ç¤ºæ„å›¾', w/2, h - 5);
        }

        // ç»˜åˆ¶å…ƒéŸ³å…±æŒ¯å³°
        function drawVowelFormants() {
            const canvas = document.getElementById('vowelCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const w = canvas.width, h = canvas.height;
            
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, w, h);
            
            const vowels = [
                { letter: 'a', name: '[AH] as in "FATHER"', color: '#e74c3c', formants: [700, 1100, 2500] },
                { letter: 'i', name: '[EE] as in "HEED"', color: '#3498db', formants: [270, 2300, 3000] },
                { letter: 'u', name: '[OO] as in "POOL"', color: '#27ae60', formants: [300, 900, 2300] }
            ];
            
            vowels.forEach((v, idx) => {
                const oy = 20 + idx * 155;
                
                // å£å‹åŒºåŸŸ
                ctx.fillStyle = `rgba(${idx === 0 ? '231,76,60' : idx === 1 ? '52,152,219' : '39,174,96'}, 0.1)`;
                ctx.fillRect(20, oy, 110, 130);
                ctx.strokeStyle = v.color;
                ctx.lineWidth = 2;
                ctx.strokeRect(20, oy, 110, 130);
                
                // å…ƒéŸ³å­—æ¯
                ctx.fillStyle = v.color;
                ctx.font = 'bold 28px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(v.letter, 75, oy + 35);
                
                // å£å‹
                ctx.strokeStyle = '#666';
                ctx.lineWidth = 2;
                ctx.beginPath();
                if (v.letter === 'a') {
                    ctx.ellipse(75, 85 + idx * 155, 30, 20, 0, 0, Math.PI * 2);
                } else if (v.letter === 'i') {
                    ctx.ellipse(75, 85 + idx * 155, 12, 30, 0, 0, Math.PI * 2);
                } else {
                    ctx.arc(75, 85 + idx * 155, 18, 0, Math.PI * 2);
                }
                ctx.stroke();
                
                // é¢‘è°±åŒºåŸŸ
                const specX = 150, specW = 560, specH = 100;
                ctx.fillStyle = '#f8f9fa';
                ctx.fillRect(specX, oy + 15, specW, specH);
                ctx.strokeStyle = '#ddd';
                ctx.strokeRect(specX, oy + 15, specW, specH);
                
                // åæ ‡è½´
                ctx.strokeStyle = '#666';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(specX + 10, oy + 15);
                ctx.lineTo(specX + 10, oy + 15 + specH - 10);
                ctx.lineTo(specX + specW - 10, oy + 15 + specH - 10);
                ctx.stroke();
                
                // é¢‘è°±æ¡
                ctx.fillStyle = '#666';
                for (let i = 0; i < 35; i++) {
                    const freq = (i / 35) * 3500;
                    let amp = 10;
                    v.formants.forEach((f, fi) => {
                        amp += (60 / (fi + 1)) * Math.exp(-Math.pow(freq - f, 2) / 30000);
                    });
                    const bx = specX + 20 + i * 15;
                    const bh = amp;
                    ctx.fillRect(bx, oy + 15 + specH - 15 - bh, 8, bh);
                }
                
                // åŒ…ç»œæ›²çº¿
                ctx.strokeStyle = v.color;
                ctx.lineWidth = 2;
                ctx.setLineDash([5, 3]);
                ctx.beginPath();
                for (let i = 0; i < specW - 30; i++) {
                    const freq = (i / (specW - 30)) * 3500;
                    let env = 15;
                    v.formants.forEach((f, fi) => {
                        env += (55 / (fi + 1)) * Math.exp(-Math.pow(freq - f, 2) / 40000);
                    });
                    const ex = specX + 15 + i;
                    const ey = oy + 15 + specH - 15 - env;
                    if (i === 0) ctx.moveTo(ex, ey);
                    else ctx.lineTo(ex, ey);
                }
                ctx.stroke();
                ctx.setLineDash([]);
                
                // æ ‡ç­¾
                ctx.fillStyle = '#333';
                ctx.font = '12px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(v.name, specX + 20, oy + 15 + specH + 18);
                
                // Xè½´åˆ»åº¦
                ctx.textAlign = 'center';
                [1000, 2000, 3000].forEach(f => {
                    const x = specX + 15 + (f / 3500) * (specW - 30);
                    ctx.fillText(f + ' Hz', x, oy + 15 + specH + 5);
                });
                
                // Yè½´æ ‡ç­¾
                ctx.save();
                ctx.translate(specX - 5, oy + 15 + specH/2);
                ctx.rotate(-Math.PI/2);
                ctx.textAlign = 'center';
                ctx.fillText('Loudness', 0, 0);
                ctx.restore();
            });
        }

        // ç»˜åˆ¶åŒ…ç»œä¿®æ­£ç¤ºæ„å›¾
        function drawEnvelopeCorrection() {
            const canvas = document.getElementById('envelopeCanvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const w = canvas.width, h = canvas.height;
            
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, w, h);
            
            const sections = [
                { title: 'Original spectrum', label: '(a)' },
                { title: 'Transposed spectrum', label: '(b)' },
                { title: 'Transposed spectrum with\noriginal spectral envelope', label: '(c)' }
            ];
            
            sections.forEach((sec, idx) => {
                const oy = 15 + idx * 155;
                const boxH = 120;
                
                // æ ‡é¢˜
                ctx.fillStyle = '#333';
                ctx.font = 'bold 13px Arial';
                ctx.textAlign = 'center';
                const lines = sec.title.split('\n');
                lines.forEach((line, li) => {
                    ctx.fillText(line, w/2, oy + li * 14);
                });
                
                // æ ‡ç­¾
                ctx.fillStyle = '#e74c3c';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(sec.label, 15, oy + 30);
                
                // åæ ‡è½´
                const axisY = oy + 25 + boxH;
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(40, oy + 25);
                ctx.lineTo(40, axisY);
                ctx.lineTo(w - 20, axisY);
                ctx.stroke();
                
                // ç®­å¤´
                ctx.beginPath();
                ctx.moveTo(40, oy + 20);
                ctx.lineTo(35, oy + 30);
                ctx.lineTo(45, oy + 30);
                ctx.fill();
                ctx.beginPath();
                ctx.moveTo(w - 15, axisY);
                ctx.lineTo(w - 25, axisY - 5);
                ctx.lineTo(w - 25, axisY + 5);
                ctx.fill();
                
                // Frequencyæ ‡ç­¾
                ctx.fillStyle = '#333';
                ctx.font = '12px Arial';
                ctx.textAlign = 'left';
                ctx.fillText('Frequency', w - 80, axisY + 15);
                
                // é¢‘è°±çº¿
                const colors = ['#3498db', '#9b59b6', '#27ae60'];
                ctx.strokeStyle = colors[idx];
                ctx.lineWidth = 2;
                
                // æ ¹æ®ä¸åŒå›¾ç»˜åˆ¶ä¸åŒçš„è°æ³¢åˆ†å¸ƒ
                let harmonics = [];
                if (idx === 0) {
                    // åŸå§‹é¢‘è°±
                    harmonics = [50, 65, 75, 80, 72, 65, 70, 78, 75, 65, 55, 50, 45, 35, 30, 25];
                } else if (idx === 1) {
                    // æ‹‰ä¼¸åï¼ˆé—´è·å˜å¤§ï¼‰
                    harmonics = [50, 75, 80, 72, 70, 78, 65, 45, 35];
                } else {
                    // ä¿®æ­£åï¼ˆä¿æŒåŸåŒ…ç»œï¼‰
                    harmonics = [50, 65, 75, 80, 72, 65, 55, 45, 35];
                }
                
                const startX = idx === 0 ? 55 : 70;
                const gap = idx === 1 ? 28 : (idx === 2 ? 28 : 16);
                
                harmonics.forEach((amp, i) => {
                    const x = startX + i * gap;
                    if (x < w - 30) {
                        ctx.beginPath();
                        ctx.moveTo(x, axisY);
                        ctx.lineTo(x, axisY - amp);
                        ctx.stroke();
                    }
                });
                
                // åŒ…ç»œæ›²çº¿
                ctx.strokeStyle = '#f39c12';
                ctx.lineWidth = 2;
                ctx.beginPath();
                
                if (idx === 0 || idx === 2) {
                    // åŸå§‹åŒ…ç»œ
                    ctx.moveTo(45, axisY - 40);
                    ctx.quadraticCurveTo(120, axisY - 85, 200, axisY - 50);
                    ctx.quadraticCurveTo(280, axisY - 30, 320, axisY - 20);
                } else {
                    // æ‹‰ä¼¸çš„åŒ…ç»œ
                    ctx.moveTo(60, axisY - 35);
                    ctx.quadraticCurveTo(180, axisY - 85, 280, axisY - 45);
                    ctx.quadraticCurveTo(320, axisY - 30, 330, axisY - 25);
                    ctx.setLineDash([5, 3]);
                }
                ctx.stroke();
                ctx.setLineDash([]);
                
                // åŒ…ç»œæ ‡ç­¾
                if (idx === 0) {
                    ctx.fillStyle = '#f39c12';
                    ctx.font = '11px Arial';
                    ctx.fillText('åŒ…ç»œ (F)', 130, oy + 45);
                } else if (idx === 1) {
                    ctx.fillText('æ‹‰ä¼¸çš„åŒ…ç»œ', 220, oy + 45);
                } else {
                    ctx.fillText('ä¿æŒåŸå§‹åŒ…ç»œ', 130, oy + 55);
                }
            });
        }

        // ç»˜åˆ¶æ–¹æ³•äºŒæµç¨‹å›¾
        function drawMethod2Flow() {
            const canvas = document.getElementById('method2Canvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const w = canvas.width, h = canvas.height;
            
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, w, h);
            
            const steps = [
                { y: 20, title: 'â‘  è¯»å…¥éŸ³é¢‘ä¿¡å· x(n)', desc: 'è¯»å–åŸå§‹éŸ³é¢‘æ–‡ä»¶' },
                { y: 100, title: 'â‘¡ åˆ†å¸§åŠ çª—', desc: 'å¸§é•¿Mï¼Œå¸§ç§»R = M - Lï¼Œçª—å‡½æ•°g(n)' },
                { y: 200, title: 'â‘¢ FFTè®¡ç®—æ¯å¸§é¢‘è°±', desc: 'å¾—åˆ°|Xâ‚(f)|Â², |Xâ‚‚(f)|Â², ..., |Xâ‚†(f)|Â²' },
                { y: 300, title: 'â‘£ ä»¥Î±=0.5ä¸ºä¾‹é™ä½éŸ³è°ƒï¼šæ¯2å¸§ä¿ç•™1å¸§', desc: 'æŠ½å–å¸§å®ç°é™è°ƒ' },
                { y: 400, title: 'â‘¤ IFFT + OLAé‡å»ºæ—¶åŸŸä¿¡å·', desc: 'é€†å˜æ¢åå åŠ é‡å»º' },
                { y: 500, title: 'â‘¥ ä¿¡å·é•¿åº¦å‡åŠ', desc: 'xÌƒ = Î£xÌ‚â‚–' },
                { y: 580, title: 'â‘¦ æ’å€¼æ‹‰ä¼¸å›åŸå§‹é•¿åº¦ï¼Œé¢‘ç‡é™ä½', desc: 'y(n) - é™è°ƒè¾“å‡º' }
            ];
            
            steps.forEach((step, idx) => {
                // æ­¥éª¤æ ‡é¢˜
                ctx.fillStyle = '#e74c3c';
                ctx.font = 'bold 13px Microsoft YaHei';
                ctx.textAlign = 'left';
                ctx.fillText(step.title, 30, step.y);
                
                // æ­¥éª¤æè¿°/å›¾ç¤ºåŒºåŸŸ
                ctx.fillStyle = '#f8f9fa';
                ctx.fillRect(30, step.y + 8, 550, 55);
                ctx.strokeStyle = '#e2e8f0';
                ctx.lineWidth = 1;
                ctx.strokeRect(30, step.y + 8, 550, 55);
                
                // æ ¹æ®æ­¥éª¤ç»˜åˆ¶ä¸åŒå†…å®¹
                if (idx === 0) {
                    // æ³¢å½¢
                    ctx.strokeStyle = '#3498db';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    for (let i = 0; i < 500; i++) {
                        const x = 50 + i;
                        const y = step.y + 35 + Math.sin(i * 0.05) * 15 * Math.sin(i * 0.01);
                        if (i === 0) ctx.moveTo(x, y);
                        else ctx.lineTo(x, y);
                    }
                    ctx.stroke();
                } else if (idx === 1) {
                    // çª—å‡½æ•°
                    const colors = ['#e74c3c', '#f39c12', '#27ae60', '#3498db', '#9b59b6', '#1abc9c'];
                    colors.forEach((c, i) => {
                        ctx.fillStyle = c + '30';
                        ctx.strokeStyle = c;
                        ctx.lineWidth = 2;
                        ctx.beginPath();
                        const sx = 50 + i * 35;
                        ctx.moveTo(sx, step.y + 55);
                        ctx.quadraticCurveTo(sx + 35, step.y + 15, sx + 70, step.y + 55);
                        ctx.stroke();
                    });
                } else if (idx === 2) {
                    // é¢‘è°±
                    const colors = ['#e74c3c', '#f39c12', '#27ae60', '#3498db', '#9b59b6', '#1abc9c'];
                    colors.forEach((c, i) => {
                        ctx.strokeStyle = c;
                        ctx.lineWidth = 2;
                        ctx.beginPath();
                        const sx = 60 + i * 80;
                        ctx.moveTo(sx, step.y + 55);
                        ctx.lineTo(sx + 5, step.y + 55);
                        ctx.lineTo(sx + 15, step.y + 25);
                        ctx.lineTo(sx + 25, step.y + 55);
                        ctx.lineTo(sx + 35, step.y + 40);
                        ctx.lineTo(sx + 45, step.y + 55);
                        ctx.stroke();
                        
                        ctx.fillStyle = c;
                        ctx.font = '10px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText('|X' + (i+1) + '(f)|Â²', sx + 22, step.y + 18);
                    });
                } else if (idx === 3) {
                    // æŠ½å–åçš„é¢‘è°±
                    const colors = ['#e74c3c', '#27ae60', '#9b59b6'];
                    colors.forEach((c, i) => {
                        ctx.strokeStyle = c;
                        ctx.lineWidth = 2;
                        ctx.beginPath();
                        const sx = 70 + i * 100;
                        ctx.moveTo(sx, step.y + 55);
                        ctx.lineTo(sx + 5, step.y + 55);
                        ctx.lineTo(sx + 15, step.y + 25);
                        ctx.lineTo(sx + 25, step.y + 55);
                        ctx.lineTo(sx + 35, step.y + 40);
                        ctx.lineTo(sx + 45, step.y + 55);
                        ctx.stroke();
                    });
                    
                    // è™šçº¿è¡¨ç¤ºè¢«åˆ é™¤çš„å¸§
                    ctx.setLineDash([3, 3]);
                    ctx.strokeStyle = '#999';
                    ['#f39c12', '#3498db', '#1abc9c'].forEach((c, i) => {
                        const sx = 120 + i * 100;
                        ctx.beginPath();
                        ctx.moveTo(sx, step.y + 35);
                        ctx.lineTo(sx + 40, step.y + 35);
                        ctx.stroke();
                    });
                    ctx.setLineDash([]);
                    
                    ctx.fillStyle = '#f39c12';
                    ctx.font = '12px Microsoft YaHei';
                    ctx.textAlign = 'left';
                    ctx.fillText('å¸§æ•°å‡åŠï¼ˆæŠ½å–ï¼‰', 450, step.y + 40);
                } else if (idx === 4) {
                    // é‡å»ºæ³¢å½¢
                    const colors = ['#e74c3c', '#27ae60', '#9b59b6'];
                    colors.forEach((c, i) => {
                        ctx.strokeStyle = c;
                        ctx.lineWidth = 2;
                        ctx.beginPath();
                        const sx = 60 + i * 80;
                        for (let j = 0; j < 70; j++) {
                            const x = sx + j;
                            const y = step.y + 35 + Math.sin(j * 0.15) * 12;
                            if (j === 0) ctx.moveTo(x, y);
                            else ctx.lineTo(x, y);
                        }
                        ctx.stroke();
                        
                        ctx.fillStyle = c;
                        ctx.font = '10px Arial';
                        ctx.fillText('xÌ‚' + (i+1) + '(n)', sx + 30, step.y + 58);
                    });
                } else if (idx === 5) {
                    // ç¼©çŸ­çš„æ³¢å½¢
                    ctx.strokeStyle = '#8e44ad';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    for (let i = 0; i < 250; i++) {
                        const x = 50 + i;
                        const y = step.y + 35 + Math.sin(i * 0.08) * 15 * Math.cos(i * 0.02);
                        if (i === 0) ctx.moveTo(x, y);
                        else ctx.lineTo(x, y);
                    }
                    ctx.stroke();
                    
                    ctx.fillStyle = '#666';
                    ctx.font = '12px Arial';
                    ctx.fillText('xÌƒ = Î£xÌ‚â‚–', 350, step.y + 40);
                } else if (idx === 6) {
                    // æ‹‰ä¼¸å›åŸé•¿çš„æ³¢å½¢
                    ctx.strokeStyle = '#27ae60';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    for (let i = 0; i < 500; i++) {
                        const x = 50 + i;
                        const y = step.y + 35 + Math.sin(i * 0.04) * 15 * Math.cos(i * 0.01);
                        if (i === 0) ctx.moveTo(x, y);
                        else ctx.lineTo(x, y);
                    }
                    ctx.stroke();
                    
                    ctx.fillStyle = '#27ae60';
                    ctx.font = '12px Microsoft YaHei';
                    ctx.fillText('y(n) - é™è°ƒè¾“å‡º', 450, step.y + 40);
                }
                
                // ç®­å¤´
                if (idx < steps.length - 1) {
                    ctx.fillStyle = '#e74c3c';
                    ctx.beginPath();
                    const ay = step.y + 70;
                    ctx.moveTo(600, ay);
                    ctx.lineTo(595, ay + 10);
                    ctx.lineTo(605, ay + 10);
                    ctx.fill();
                }
            });
        }

        // ç»˜åˆ¶é¢‘è°±ä¿®æ­£å¯¹æ¯”å›¾
        function drawSpectrumComparison(canvasId, title, fundamentalShift, envelopeShift) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const w = canvas.width, h = canvas.height;
            
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, w, h);
            
            // åæ ‡è½´
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(50, 20);
            ctx.lineTo(50, h - 30);
            ctx.lineTo(w - 30, h - 30);
            ctx.stroke();
            
            // Yè½´æ ‡ç­¾
            ctx.fillStyle = '#666';
            ctx.font = '10px Arial';
            ctx.textAlign = 'right';
            ['0 dB', '-20', '-40', '-60', '-80'].forEach((label, i) => {
                ctx.fillText(label, 45, 30 + i * 40);
            });
            
            // Xè½´æ ‡ç­¾
            ctx.textAlign = 'center';
            ['0', '5512', '11025', '16537', 'Frequency [Hz] 22050'].forEach((label, i) => {
                const x = 50 + i * 155;
                if (i < 4) ctx.fillText(label, x, h - 12);
                else ctx.fillText(label, w - 100, h - 12);
            });
            
            // é¢‘è°±ï¼ˆå™ªå£°æ ·ï¼‰
            ctx.strokeStyle = '#666';
            ctx.lineWidth = 0.5;
            ctx.beginPath();
            for (let i = 0; i < w - 80; i++) {
                const x = 55 + i;
                const baseY = h - 35;
                const noise = Math.random() * 30;
                const y = baseY - 30 - noise;
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.stroke();
            
            // åŒ…ç»œæ›²çº¿ï¼ˆè™šçº¿ï¼‰
            ctx.strokeStyle = '#999';
            ctx.lineWidth = 1.5;
            ctx.setLineDash([4, 4]);
            ctx.beginPath();
            
            const envStart = 60 + envelopeShift * 100;
            const peakX = 350 + envelopeShift * 150;
            
            ctx.moveTo(55, h - 50);
            ctx.quadraticCurveTo(envStart, h - 60, envStart + 50, h - 100);
            ctx.quadraticCurveTo(peakX - 50, h - 120, peakX, h - 80);
            ctx.quadraticCurveTo(peakX + 100, h - 50, w - 50, h - 40);
            ctx.stroke();
            ctx.setLineDash([]);
            
            // åŒ…ç»œä¸»çº¿ï¼ˆç²—é»‘çº¿ï¼‰
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(60 + fundamentalShift * 50, h - 55);
            ctx.lineTo(100 + envelopeShift * 80, h - 70);
            ctx.lineTo(200 + envelopeShift * 100, h - 120);
            ctx.lineTo(350 + envelopeShift * 100, h - 75);
            ctx.lineTo(450 + envelopeShift * 80, h - 95);
            ctx.lineTo(550, h - 50);
            ctx.lineTo(w - 50, h - 40);
            ctx.stroke();
            
            // Fundamentalæ ‡è®°
            ctx.beginPath();
            ctx.arc(65 + fundamentalShift * 50, h - 55, 5, 0, Math.PI * 2);
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            ctx.fillStyle = '#333';
            ctx.font = '12px Arial';
            ctx.textAlign = 'left';
            ctx.fillText('Fundamental', 75 + fundamentalShift * 50, h - 180);
            
            // ç®­å¤´æŒ‡å‘
            ctx.beginPath();
            ctx.moveTo(73 + fundamentalShift * 50, h - 60);
            ctx.lineTo(68 + fundamentalShift * 50, h - 55);
            ctx.stroke();
            
            // Fæ ‡è®°
            ctx.font = 'bold 14px Arial';
            ctx.fillText('F', 220 + envelopeShift * 100, h - 125);
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–æ‰€æœ‰Canvas
        window.addEventListener('load', function() {
            drawPVFlow();
            drawPianoSpectrum();
            drawGenderSpectrum();
            drawVocalSystem();
            drawVowelFormants();
            drawEnvelopeCorrection();
            drawMethod2Flow();
            drawSpectrumComparison('specOriginal', 'åŸå§‹', 0, 0);
            drawSpectrumComparison('specShifted', 'å‡è°ƒ', 0.5, 0.5);
            drawSpectrumComparison('specCorrected', 'ä¿®æ­£', 0.5, 0);
        });
    </script>
</body>
</html>
